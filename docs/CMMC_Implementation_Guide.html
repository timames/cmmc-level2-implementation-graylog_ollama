<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMMC Level 2 Compliance Implementation Plan</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #1f2937;
            background-color: #f9fafb;
            padding: 1.5rem;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .header {
            background: linear-gradient(to right, #2563eb, #9333ea);
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            color: white;
            margin-bottom: 1.5rem;
            box-sizing: border-box;
        }
        
        .header h1 {
            font-size: 2.25rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        .header-subtitle {
            font-size: 1.125rem;
            opacity: 0.9;
            margin-bottom: 0.25rem;
        }
        
        .header-desc {
            font-size: 0.875rem;
            opacity: 0.8;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 0.5rem;
            padding: 1rem;
        }
        
        .stat-value {
            font-size: 1.875rem;
            font-weight: bold;
        }
        
        .stat-label {
            font-size: 0.875rem;
            opacity: 0.9;
        }
        
        .card {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-sizing: border-box;
        }
        
        .card h2 {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #1f2937;
        }
        
        .domain-row {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 0.75rem;
        }
        
        .domain-name {
            width: 200px;
            font-size: 0.875rem;
            font-weight: 600;
            color: #374151;
        }
        
        .progress-bar-container {
            flex: 1;
            background: #e5e7eb;
            border-radius: 9999px;
            height: 1.5rem;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
            color: white;
        }
        
        .progress-green { background-color: #059669; }
        .progress-blue { background-color: #2563eb; }
        .progress-yellow { background-color: #d97706; }
        .progress-orange { background-color: #ea580c; }
        
        .coverage-count {
            width: 100px;
            font-size: 0.875rem;
            color: #6b7280;
            text-align: right;
        }
        
        .info-box {
            border-left: 4px solid;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            overflow-wrap: break-word;
            word-wrap: break-word;
            width: 100%;
            box-sizing: border-box;
        }
        
        .info-blue {
            background-color: #eff6ff;
            border-color: #2563eb;
            color: #1e40af;
        }
        
        .info-green {
            background-color: #f0fdf4;
            border-color: #059669;
            color: #065f46;
        }
        
        .info-yellow {
            background-color: #fefce8;
            border-color: #d97706;
            color: #92400e;
        }
        
        .info-red {
            background-color: #fef2f2;
            border-color: #dc2626;
            color: #991b1b;
        }
        
        .info-purple {
            background-color: #faf5ff;
            border-color: #9333ea;
            color: #6b21a8;
        }
        
        .collapsible-header {
            cursor: pointer;
            padding: 0.75rem 1rem;
            background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);
            border-radius: 0.5rem;
            margin: 1.5rem 0 0.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.2s ease;
            border: 1px solid #e5e7eb;
            user-select: none;
        }
        
        .collapsible-header:hover {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            border-color: #d1d5db;
        }
        
        .collapsible-header.active {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border-color: #2563eb;
        }
        
        .collapsible-title {
            font-weight: 600;
            color: #374151;
            font-size: 1rem;
        }
        
        .collapsible-header.active .collapsible-title {
            color: #2563eb;
        }
        
        .collapsible-icon {
            font-size: 1.25rem;
            transition: transform 0.2s ease;
            color: #6b7280;
        }
        
        .collapsible-header.active .collapsible-icon {
            transform: rotate(180deg);
            color: #2563eb;
        }
        
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .collapsible-content.active {
            max-height: 5000px;
        }
        
        .first-collapsible {
            margin-top: 0.5rem !important;
        }
        
        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(min(300px, 100%), 1fr));
            gap: 1rem;
            width: 100%;
            box-sizing: border-box;
        }
        
        .benefit-item {
            display: flex;
            gap: 0.5rem;
        }
        
        .check-icon {
            color: #059669;
            flex-shrink: 0;
            margin-top: 0.125rem;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #e5e7eb;
            overflow-x: auto;
            margin-bottom: 0;
            background: white;
            border-radius: 0.5rem 0.5rem 0 0;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .tabs-wrapper {
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
            margin-bottom: 1.5rem;
            overflow: hidden;
        }
        
        .tab-contents-wrapper {
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }
        
        .tab {
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            color: #6b7280;
            cursor: pointer;
            border: none;
            background: none;
            white-space: nowrap;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .tab:hover {
            color: #1f2937;
        }
        
        .tab.active {
            color: #2563eb;
            border-bottom-color: #2563eb;
        }
        
        .tab-content {
            display: none;
            background: white;
            padding: 1.5rem;
            border-radius: 0 0 0.5rem 0.5rem;
            overflow-x: auto;
            box-sizing: border-box;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            border-top: none;
            width: 100%;
            max-width: 100%;
        }
        
        .tab-content > * {
            max-width: 100%;
            box-sizing: border-box;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .step-card {
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1.25rem;
            background: #f9fafb;
            margin-bottom: 1.5rem;
            overflow-wrap: break-word;
            word-wrap: break-word;
            width: 100%;
            box-sizing: border-box;
        }
        
        .step-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
        }
        
        .step-number {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            background: #2563eb;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.125rem;
        }
        
        .step-title {
            font-size: 1.25rem;
            font-weight: bold;
            color: #1f2937;
        }
        
        .step-list {
            list-style: none;
            margin-left: 3.25rem;
        }
        
        .step-list li {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
            color: #374151;
        }
        
        .step-list li::before {
            content: "•";
            color: #2563eb;
            font-weight: bold;
            margin-top: 0.25rem;
        }
        
        .code-block {
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            overflow: hidden;
            margin-bottom: 1.5rem;
            width: 100%;
            box-sizing: border-box;
        }
        
        .code-header {
            background: #1f2937;
            color: #10b981;
            padding: 0.5rem 1rem;
            font-weight: 600;
            font-size: 0.875rem;
        }
        
        .code-content {
            background: #111827;
            color: #10b981;
            padding: 1rem;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.75rem;
            white-space: pre;
        }
        
        .query-block {
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            overflow: hidden;
            margin-bottom: 0.75rem;
            width: 100%;
            box-sizing: border-box;
        }
        
        .query-header {
            background: #f3f4f6;
            padding: 0.5rem 1rem;
            border-bottom: 1px solid #e5e7eb;
            font-weight: 600;
            font-size: 0.875rem;
            color: #1f2937;
        }
        
        .query-content {
            background: #111827;
            color: #10b981;
            padding: 0.75rem;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.75rem;
        }
        
        .query-content.azure {
            color: #60a5fa;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
            margin-bottom: 1.5rem;
            table-layout: fixed;
        }
        
        th, td {
            border: 1px solid #d1d5db;
            padding: 0.75rem;
            text-align: left;
        }
        
        th {
            background: #f3f4f6;
            font-weight: 600;
        }
        
        .practice-covered {
            background-color: #f0fdf4;
        }
        
        .practice-not-covered {
            background-color: #fef2f2;
        }
        
        .practice-header {
            background: #e5e7eb;
            font-weight: bold;
        }
        
        .mono {
            font-family: 'Courier New', monospace;
            font-size: 0.75rem;
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(min(300px, 100%), 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
            width: 100%;
            box-sizing: border-box;
        }
        
        .feature-box {
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
            overflow-wrap: break-word;
            word-wrap: break-word;
            min-width: 0;
            box-sizing: border-box;
        }
        
        .feature-box h4 {
            font-weight: bold;
            margin-bottom: 0.75rem;
        }
        
        .feature-box ul {
            list-style: none;
        }
        
        .feature-box li {
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
            padding-left: 1rem;
        }
        
        .feature-box li::before {
            content: "✓";
            margin-right: 0.5rem;
            margin-left: -1rem;
        }
        
        ul.bullet-list {
            list-style: disc;
            margin-left: 1.5rem;
        }
        
        ul.bullet-list li {
            margin-bottom: 0.25rem;
        }
        
        @media print {
            body {
                background: white;
            }
            .tab {
                display: none;
            }
            .tab-content {
                display: block !important;
                page-break-before: always;
            }
        }
        
        /* Network Diagram Styles */
        .network-diagram {
            background: white;
            border-radius: 0.5rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }
        
        .network-svg {
            width: 100%;
            min-height: 650px;
        }
        
        .network-node {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .network-node:hover rect,
        .network-node:hover circle {
            filter: brightness(0.95);
            stroke-width: 3;
        }
        
        .network-node text {
            pointer-events: none;
            user-select: none;
        }
        
        .network-connection {
            stroke: #94a3b8;
            stroke-width: 2;
            fill: none;
            opacity: 0.6;
        }
        
        .network-connection.highlighted {
            stroke: #2563eb;
            stroke-width: 3;
            opacity: 1;
        }
        
        .network-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin-top: 1.5rem;
            padding: 1rem;
            background: #f8fafc;
            border-radius: 0.5rem;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }
        
        .legend-box {
            width: 20px;
            height: 20px;
            border-radius: 0.25rem;
            border: 2px solid #334155;
        }
        
        .table-wrapper {
            width: 100%;
            max-width: 100%;
            overflow-x: auto;
            margin-bottom: 1.5rem;
        }
        
        /* SSP-specific styles */
        .practice-card { border: 1px solid #e5e7eb; border-radius: 6px; padding: 1.5rem; margin-bottom: 2rem; background: #ffffff; page-break-inside: avoid; }
        .practice-card.covered { border-left: 4px solid #10b981; }
        .practice-card.not-covered { border-left: 4px solid #ef4444; }
        .practice-id { font-family: 'Courier New', monospace; background: #1f2937; color: #10b981; padding: 0.25rem 0.75rem; border-radius: 4px; font-size: 0.875rem; font-weight: 600; }
        .practice-title { font-size: 1.25rem; font-weight: 600; color: #1f2937; margin: 0.75rem 0; }
        .practice-statement { background: #f9fafb; padding: 1rem; border-radius: 4px; margin: 1rem 0; font-style: italic; color: #4b5563; }
        .objectives-list { list-style: none; padding-left: 0; margin: 1rem 0; }
        .objectives-list li { padding: 0.5rem 0.75rem; margin-bottom: 0.5rem; background: #eff6ff; border-left: 3px solid #2563eb; border-radius: 4px; font-size: 0.9rem; }
        .implementation { background: #f0fdf4; border: 1px solid #10b981; border-radius: 6px; padding: 1rem; margin: 1rem 0; }
        .implementation.not-implemented { background: #fef2f2; border: 1px solid #ef4444; }
        .implementation-title { font-weight: 600; color: #065f46; margin-bottom: 0.5rem; }
        .log-sources { margin-top: 1rem; padding: 0.75rem; background: #fef3c7; border-radius: 4px; border-left: 3px solid #f59e0b; font-size: 0.875rem; }
        .section-title { color: #1e40af; font-size: 1.875rem; margin: 2rem 0 1rem; padding-bottom: 0.5rem; border-bottom: 3px solid #2563eb; }
        .domain-title { color: #4b5563; font-size: 1.5rem; margin: 2rem 0 1rem; padding: 0.5rem; background: #f3f4f6; border-left: 4px solid #6b7280; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🛡️ CMMC Level 2 Compliance Architecture</h1>
            <p class="header-subtitle">Graylog + NetFlow + Omnissa VDI + Microsoft Defender EDR + Azure AD + Defender + AIP + Purview + M365</p>
            <p class="header-desc">Comprehensive security: Network + Endpoints + VDI + Identity + DLP monitoring</p>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value">89</div>
                    <div class="stat-label">Practices Covered</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">80.9%</div>
                    <div class="stat-label">Coverage Rate</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">12 Sources</div>
                    <div class="stat-label">Log Integrations</div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>📊 CMMC Domain Coverage with Full Stack</h2>
            <div class="domain-row">
                <div class="domain-name">Audit & Accountability</div>
                <div class="progress-bar-container">
                    <div class="progress-bar progress-green" style="width: 100%">100%</div>
                </div>
                <div class="coverage-count">9/9</div>
            </div>
            <div class="domain-row">
                <div class="domain-name">Incident Response</div>
                <div class="progress-bar-container">
                    <div class="progress-bar progress-green" style="width: 100%">100%</div>
                </div>
                <div class="coverage-count">3/3</div>
            </div>
            <div class="domain-row">
                <div class="domain-name">System & Info Integrity</div>
                <div class="progress-bar-container">
                    <div class="progress-bar progress-green" style="width: 100%">100%</div>
                </div>
                <div class="coverage-count">9/9</div>
            </div>
            <div class="domain-row">
                <div class="domain-name">Identification & Auth</div>
                <div class="progress-bar-container">
                    <div class="progress-bar progress-blue" style="width: 90.9%">91%</div>
                </div>
                <div class="coverage-count">10/11</div>
            </div>
            <div class="domain-row">
                <div class="domain-name">Access Control</div>
                <div class="progress-bar-container">
                    <div class="progress-bar progress-blue" style="width: 94.7%">94.7%</div>
                </div>
                <div class="coverage-count">18/19</div>
            </div>
            <div class="domain-row">
                <div class="domain-name">Configuration Management</div>
                <div class="progress-bar-container">
                    <div class="progress-bar progress-yellow" style="width: 77.8%">77.8%</div>
                </div>
                <div class="coverage-count">7/9</div>
            </div>
            <div class="domain-row">
                <div class="domain-name">System & Comm Protection</div>
                <div class="progress-bar-container">
                    <div class="progress-bar progress-green" style="width: 100%">100%</div>
                </div>
                <div class="coverage-count">12/12</div>
            </div>
            <div class="domain-row">
                <div class="domain-name">Awareness & Training</div>
                <div class="progress-bar-container">
                    <div class="progress-bar progress-red" style="width: 0%">0%</div>
                </div>
                <div class="coverage-count">0/3</div>
            </div>
            <div class="domain-row">
                <div class="domain-name">Maintenance</div>
                <div class="progress-bar-container">
                    <div class="progress-bar progress-red" style="width: 0%">0%</div>
                </div>
                <div class="coverage-count">0/3</div>
            </div>
            <div class="domain-row">
                <div class="domain-name">Media Protection</div>
                <div class="progress-bar-container">
                    <div class="progress-bar progress-red" style="width: 0%">0%</div>
                </div>
                <div class="coverage-count">0/3</div>
            </div>
            <div class="domain-row">
                <div class="domain-name">Personnel Security</div>
                <div class="progress-bar-container">
                    <div class="progress-bar progress-red" style="width: 0%">0%</div>
                </div>
                <div class="coverage-count">0/2</div>
            </div>
            <div class="domain-row">
                <div class="domain-name">Physical Protection</div>
                <div class="progress-bar-container">
                    <div class="progress-bar progress-red" style="width: 0%">0%</div>
                </div>
                <div class="coverage-count">0/3</div>
            </div>
            <div class="domain-row">
                <div class="domain-name">Risk Assessment</div>
                <div class="progress-bar-container">
                    <div class="progress-bar progress-red" style="width: 0%">0%</div>
                </div>
                <div class="coverage-count">0/3</div>
            </div>
            <div class="domain-row">
                <div class="domain-name">Security Assessment</div>
                <div class="progress-bar-container">
                    <div class="progress-bar progress-red" style="width: 0%">0%</div>
                </div>
                <div class="coverage-count">0/3</div>
            </div>
        </div>

        <div class="info-box info-blue">
            <h3 style="font-weight: bold; font-size: 1.25rem; margin-bottom: 0.75rem;">📊 Executive Summary</h3>
            
            <div style="margin-bottom: 1.5rem;">
                <h4 style="font-weight: 600; margin-bottom: 0.5rem;">Solution Overview</h4>
                <p style="font-size: 0.875rem; line-height: 1.6;">
                    This hybrid SIEM architecture achieves <strong>80.9% CMMC Level 2 compliance coverage</strong> (89 of 110 practices) 
                    by strategically combining on-premises Graylog for high-volume infrastructure logging with Microsoft 365 GCC High 
                    for cloud-native security controls. The solution provides comprehensive threat detection, automated incident response, 
                    and AI-powered security analytics while maintaining full data sovereignty for CUI.
                </p>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <h4 style="font-weight: 600; margin-bottom: 0.75rem;">Integrated Detection & Response Capabilities</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; font-size: 0.875rem;">
                    <div>
                        <strong style="color: #2563eb;">🤖 AI-Powered Threat Detection</strong>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem; line-height: 1.6;">
                            <li>Ollama (Llama 3.2) provides on-premises AI analysis of security events</li>
                            <li>Automated pattern recognition for anomaly detection across all log sources</li>
                            <li>Natural language threat intelligence summarization and reporting</li>
                            <li>Context-aware alert prioritization reducing false positive fatigue</li>
                            <li>No cloud AI costs - runs locally on dedicated GPU infrastructure</li>
                        </ul>
                    </div>
                    <div>
                        <strong style="color: #059669;">📊 Advanced Reporting & Analytics</strong>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem; line-height: 1.6;">
                            <li>Real-time dashboards for security posture visibility across hybrid environment</li>
                            <li>Automated CMMC compliance reports mapped to specific AU/SI/IR practices</li>
                            <li>Cross-platform correlation between Azure AD, Defender, and on-prem logs</li>
                            <li>Executive summaries generated via AI for incident response briefings</li>
                            <li>Customizable KQL workbooks for Azure + Graylog unified views</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="benefits-grid">
                <div>
                    <div class="benefit-item">
                        <span class="check-icon">✓</span>
                        <div>
                            <div style="font-weight: 600;">Hybrid SIEM Architecture</div>
                            <div style="font-size: 0.875rem;">Graylog processes 1,500-2,700 GB/month on-premises (network, VDI, servers) while Azure handles cloud-native logs (O365, AAD, Defender)</div>
                        </div>
                    </div>
                    <div class="benefit-item">
                        <span class="check-icon">✓</span>
                        <div>
                            <div style="font-weight: 600;">Multi-Layer Threat Detection</div>
                            <div style="font-size: 0.875rem;">Microsoft Defender EDR, network flow analysis, VDI session monitoring, file integrity monitoring, and AI-powered behavioral analytics</div>
                        </div>
                    </div>
                    <div class="benefit-item">
                        <span class="check-icon">✓</span>
                        <div>
                            <div style="font-weight: 600;">Automated Incident Response</div>
                            <div style="font-size: 0.875rem;">Graylog pipelines trigger automated actions, email/Slack notifications, ticket creation, and AI-generated incident summaries</div>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="benefit-item">
                        <span class="check-icon">✓</span>
                        <div>
                            <div style="font-weight: 600;">CUI Data Protection</div>
                            <div style="font-size: 0.875rem;">Microsoft Purview DLP with automated CUI detection, AIP Scanner for at-rest files, and real-time policy enforcement across M365 GCC High</div>
                        </div>
                    </div>
                    <div class="benefit-item">
                        <span class="check-icon">✓</span>
                        <div>
                            <div style="font-weight: 600;">Comprehensive Audit Trail</div>
                            <div style="font-size: 0.875rem;">1-2 year retention across all systems with tamper-proof storage, automated correlation, and audit-ready reporting for CMMC assessments</div>
                        </div>
                    </div>
                    <div class="benefit-item">
                        <span class="check-icon">✓</span>
                        <div>
                            <div style="font-weight: 600;">Rapid Deployment</div>
                            <div style="font-size: 0.875rem;">4-6 week phased implementation with validation checkpoints, minimal production impact, and parallel operation during transition</div>
                        </div>
                    </div>
                </div>
            </div>

            <div style="background: white; border-radius: 0.5rem; padding: 1rem; margin-bottom: 1rem;">
                <h4 style="font-weight: 600; margin-bottom: 0.5rem; color: #1e40af;">Key Components</h4>
                <ul style="font-size: 0.875rem; line-height: 1.8; margin-left: 1.25rem;">
                    <li><strong>Graylog SIEM:</strong> Centralized log aggregation for 12 sources (network, endpoints, VDI, authentication)</li>
                    <li><strong>Microsoft Defender EDR:</strong> Advanced endpoint threat detection, behavioral analytics, and automated response</li>
                    <li><strong>Microsoft Purview:</strong> DLP policies and information protection with automated CUI classification</li>
                    <li><strong>Azure AD + Conditional Access:</strong> Zero Trust identity controls with MFA and risk-based access</li>
                    <li><strong>Omnissa Horizon VDI:</strong> Secure remote access with comprehensive session logging</li>
                    <li><strong>NetFlow Analysis:</strong> Network traffic monitoring for lateral movement and data exfiltration</li>
                    <li><strong>Ollama AI:</strong> Local LLM for intelligent log analysis and threat correlation</li>
                </ul>
            </div>

            <div style="background: #f0fdf4; border: 1px solid #059669; border-radius: 0.5rem; padding: 1rem;">
                <h4 style="font-weight: 600; margin-bottom: 0.5rem; color: #065f46;">Expected Outcomes</h4>
                <ul style="font-size: 0.875rem; line-height: 1.8; margin-left: 1.25rem;">
                    <li>Complete audit trail for all 14 CMMC domains with automated evidence collection</li>
                    <li>Real-time threat detection with <5 minute alert latency for critical events</li>
                    <li>Automated CUI protection preventing unauthorized data sharing or exfiltration</li>
                    <li>Reduced manual compliance burden through automated log analysis and reporting</li>
                    <li>Enhanced security posture with multi-layered detection and prevention controls</li>
                </ul>
            </div>
        </div>


        <div class="tabs-wrapper">
        <div class="tabs">
            <button class="tab active" onclick="showTab('overview')"> Overview</button>
            <button class="tab" onclick="showTab('architecture')">Architecture</button>			
            <button class="tab" onclick="showTab('practices')">Practices</button>
            <button class="tab" onclick="showTab('vdi')">VDI</button>			
            <button class="tab" onclick="showTab('defender')">Microsoft Defender</button>
            <button class="tab" onclick="showTab('purview')">Microsoft Purview</button>
            <button class="tab" onclick="showTab('windows')">Windows Logging</button>
            <button class="tab" onclick="showTab('graylog')">Graylog</button>
            <button class="tab" onclick="showTab('ollama')">Ollama</button>
            <button class="tab" onclick="showTab('queries')">Queries</button>			
            <button class="tab" onclick="showTab('gpos')">Hardening</button>
			<button class="tab" onclick="showTab('policies')">Policy Templates</button>			
            <button class="tab" onclick="showTab('ssp')">📋SSP</button>			


        </div>
        
        <div class="tab-contents-wrapper">

        <div id="overview" class="tab-content active">
            <div class="info-box info-green">
                <h3 style="font-size: 1.5rem; font-weight: bold; margin-bottom: 1rem;">Implementation Overview</h3>
                <p style="margin-bottom: 1rem;">
                    This comprehensive CMMC Level 2 compliance architecture integrates 12 log sources to achieve 80.9% 
                    coverage (89 of 110 practices) through a hybrid on-premises and cloud solution with automatic CUI detection and protection.
                </p>
                <div class="grid-2">
                    <div style="background: white; border-radius: 0.5rem; padding: 1rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                        <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Log Sources Integrated</h4>
                        <ul style="font-size: 0.875rem; line-height: 1.5;">
                            <li>Network (NetFlow from GW/FW)</li>
                            <li>Firewalls, Switches, APs (Syslog)</li>
                            <li>Omnissa Horizon (VDI Sessions)</li>
                            <li>Omnissa UAG (Remote Access)</li>
                            <li>Microsoft Defender EDR (EDR/Endpoints)</li>
                            <li>Azure Active Directory (Identity)</li>
                            <li>Microsoft Defender (Endpoint, Office 365, Cloud Apps)</li>
                            <li>Azure Information Protection (CUI Labeling)</li>
                            <li>Microsoft Purview (DLP/Compliance)</li>
                            <li>Microsoft 365 (Exchange, SharePoint, OneDrive, Teams)</li>
                            <li>Windows/Linux Servers (Event Logs)</li>
                            <li>AIP Scanner (LOG02) - Automated CUI Discovery</li>
                        </ul>
                    </div>
                    <div style="background: white; border-radius: 0.5rem; padding: 1rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                        <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Key Capabilities</h4>
                        <ul style="font-size: 0.875rem; line-height: 1.5;">
                            <li>Real-time threat detection</li>
                            <li>Insider threat monitoring</li>
                            <li>Data exfiltration detection</li>
                            <li>DLP and information protection</li>
                            <li>CUI classification and tracking</li>
                            <li>Compliance evidence collection</li>
                            <li>AI-powered log analysis</li>
                            <li>Natural language queries</li>
                            <li>Automated CMMC reporting</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div id="practices" class="tab-content">
            <div class="info-box info-blue">
                <h3 style="font-weight: bold; margin-bottom: 0.5rem;">CMMC Level 2 Practice Coverage</h3>
                <p style="font-size: 0.875rem;">
                    Detailed breakdown of 110 CMMC Level 2 practices: 89 covered (80.9%), 21 not covered (19.1%)
                </p>
            </div>

            <div style="overflow-x: auto;">
                <table>
                    <colgroup>
                        <col style="width: 12%;">
                        <col style="width: 32%;">
                        <col style="width: 18%;">
                        <col style="width: 8%;">
                        <col style="width: 30%;">
                    </colgroup>
                    <thead>
                        <tr>
                            <th>Practice ID</th>
                            <th>Practice Name</th>
                            <th>Domain</th>
                            <th style="text-align: center;">Covered</th>
                            <th>Log Source</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="practice-header">
                            <td colspan="5"><strong>Access Control (AC) - 21/22 Covered (95.5%)</strong></td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.1</td>
                            <td>Limit system access to authorized users</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">VDI, AAD, Windows, Syslog</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.2</td>
                            <td>Limit system access to types of transactions</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">VDI, Windows, Syslog</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.3</td>
                            <td>Control the flow of CUI</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">NetFlow, VDI</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.4</td>
                            <td>Separate duties of individuals</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">AAD, Windows, Syslog</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.5</td>
                            <td>Employ least privilege</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Microsoft Defender EDR, Windows, Syslog</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.6</td>
                            <td>Use non-privileged accounts</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Microsoft Defender EDR, Windows, Syslog</td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">AC.L2-3.1.7</td>
                            <td>Prevent non-privileged users from executing privileged functions</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires PAM solution</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.11</td>
                            <td>Terminate user sessions after inactivity</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">VDI, AAD, Windows</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.12</td>
                            <td>Monitor and control remote access sessions</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">VDI, UAG, NetFlow</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.13</td>
                            <td>Employ cryptographic mechanisms</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">UAG, Syslog</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.14</td>
                            <td>Control CUI in accordance with approved authorizations</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">VDI, AAD</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.15</td>
                            <td>Authorize wireless access</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">NetFlow, Syslog</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.16</td>
                            <td>Protect wireless access using authentication</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">N/A - No WiFi in CMMC boundary</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.18</td>
                            <td>Control connection of mobile devices</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">VDI, UAG</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.19</td>
                            <td>Authorize external system connections</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">NetFlow, VDI</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.20</td>
                            <td>Control use of portable storage devices</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">VDI (USB events)</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.21</td>
                            <td>Limit use of portable storage devices</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">VDI (USB events)</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.22</td>
                            <td>Control CUI posted publicly</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">NetFlow, Web proxy</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AC.L2-3.1.23</td>
                            <td>Control the use of CUI on external systems</td>
                            <td>Access Control</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Purview DLP</td>
                        </tr>

                        <tr class="practice-header">
                            <td colspan="5"><strong>Awareness and Training (AT) - 0/4 Covered (0%)</strong></td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">AT.L2-3.2.1</td>
                            <td>Security awareness and training</td>
                            <td>Awareness & Training</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires training program</td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">AT.L2-3.2.2</td>
                            <td>Insider threat awareness</td>
                            <td>Awareness & Training</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires training program</td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">AT.L2-3.2.3</td>
                            <td>Role-based security training</td>
                            <td>Awareness & Training</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires training program</td>
                        </tr>

                        <tr class="practice-header">
                            <td colspan="5"><strong>Audit and Accountability (AU) - 9/9 Covered (100%)</strong></td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AU.L2-3.3.1</td>
                            <td>Create and retain audit logs</td>
                            <td>Audit & Accountability</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">All sources</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AU.L2-3.3.2</td>
                            <td>Ensure actions can be traced to users</td>
                            <td>Audit & Accountability</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">All sources</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AU.L2-3.3.3</td>
                            <td>Review and update logged events</td>
                            <td>Audit & Accountability</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Graylog dashboards</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AU.L2-3.3.4</td>
                            <td>Alert on audit processing failures</td>
                            <td>Audit & Accountability</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Graylog alerts</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AU.L2-3.3.5</td>
                            <td>Correlate audit record review</td>
                            <td>Audit & Accountability</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Ollama AI analysis</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AU.L2-3.3.6</td>
                            <td>Provide audit reduction and report generation</td>
                            <td>Audit & Accountability</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Graylog queries</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AU.L2-3.3.7</td>
                            <td>Time-stamp audit records</td>
                            <td>Audit & Accountability</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">All sources</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AU.L2-3.3.8</td>
                            <td>Protect audit information</td>
                            <td>Audit & Accountability</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Graylog access control</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">AU.L2-3.3.9</td>
                            <td>Limit audit information management</td>
                            <td>Audit & Accountability</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Graylog RBAC</td>
                        </tr>

                        <tr class="practice-header">
                            <td colspan="5"><strong>Configuration Management (CM) - 7/9 Covered (77.8%)</strong></td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">CM.L2-3.4.1</td>
                            <td>Establish baseline configurations</td>
                            <td>Configuration Mgmt</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Microsoft Defender EDR</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">CM.L2-3.4.2</td>
                            <td>Establish security configuration settings</td>
                            <td>Configuration Mgmt</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Microsoft Defender EDR, Syslog</td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">CM.L2-3.4.3</td>
                            <td>Track and document configuration changes</td>
                            <td>Configuration Mgmt</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires CM tool</td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">CM.L2-3.4.4</td>
                            <td>Analyze security impact of changes</td>
                            <td>Configuration Mgmt</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires CM process</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">CM.L2-3.4.5</td>
                            <td>Define and document restrictions</td>
                            <td>Configuration Mgmt</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Windows, Syslog, Microsoft Defender EDR</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">CM.L2-3.4.6</td>
                            <td>Employ least functionality</td>
                            <td>Configuration Mgmt</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Microsoft Defender EDR, NetFlow</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">CM.L2-3.4.7</td>
                            <td>Restrict software installation</td>
                            <td>Configuration Mgmt</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Microsoft Defender EDR</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">CM.L2-3.4.8</td>
                            <td>Apply deny-by-exception policy</td>
                            <td>Configuration Mgmt</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Microsoft Defender EDR, NetFlow</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">CM.L2-3.4.9</td>
                            <td>Control and monitor user-installed software</td>
                            <td>Configuration Mgmt</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Microsoft Defender EDR</td>
                        </tr>

                        <tr class="practice-header">
                            <td colspan="5"><strong>Identification and Authentication (IA) - 10/11 Covered (90.9%)</strong></td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">IA.L2-3.5.1</td>
                            <td>Identify system users</td>
                            <td>Identification & Auth</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">AAD, VDI, Windows, Syslog</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">IA.L2-3.5.2</td>
                            <td>Authenticate users and devices</td>
                            <td>Identification & Auth</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">AAD, VDI, Windows, Syslog</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">IA.L2-3.5.3</td>
                            <td>Use MFA for network access</td>
                            <td>Identification & Auth</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">AAD, UAG</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">IA.L2-3.5.4</td>
                            <td>Replay-resistant authentication</td>
                            <td>Identification & Auth</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">AD Kerberos, GPO, Windows Security, AAD</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">IA.L2-3.5.5</td>
                            <td>Prevent password reuse</td>
                            <td>Identification & Auth</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">AAD policy logs</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">IA.L2-3.5.6</td>
                            <td>Enforce minimum password complexity</td>
                            <td>Identification & Auth</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">AAD policy logs</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">IA.L2-3.5.7</td>
                            <td>Prohibit password reuse</td>
                            <td>Identification & Auth</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">AAD policy logs</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">IA.L2-3.5.8</td>
                            <td>Allow temporary password for system logon</td>
                            <td>Identification & Auth</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">AAD logs</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">IA.L2-3.5.9</td>
                            <td>Store and transmit passwords securely</td>
                            <td>Identification & Auth</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">VDI, AAD</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">IA.L2-3.5.10</td>
                            <td>Obscure feedback during authentication</td>
                            <td>Identification & Auth</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">VDI, UAG logs</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">IA.L2-3.5.11</td>
                            <td>Manage authenticator lifecycle</td>
                            <td>Identification & Auth</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">AAD logs</td>
                        </tr>

                        <tr class="practice-header">
                            <td colspan="5"><strong>Incident Response (IR) - 3/3 Covered (100%)</strong></td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">IR.L2-3.6.1</td>
                            <td>Establish incident handling capability</td>
                            <td>Incident Response</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">All sources + alerts</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">IR.L2-3.6.2</td>
                            <td>Track and document incidents</td>
                            <td>Incident Response</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Graylog + ticketing</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">IR.L2-3.6.3</td>
                            <td>Test incident response capability</td>
                            <td>Incident Response</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Log data for tabletops</td>
                        </tr>

                        <tr class="practice-header">
                            <td colspan="5"><strong>Maintenance (MA) - 0/6 Covered (0%)</strong></td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">MA.L2-3.7.1</td>
                            <td>Perform maintenance on systems</td>
                            <td>Maintenance</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires maintenance process</td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">MA.L2-3.7.2</td>
                            <td>Control nonlocal maintenance</td>
                            <td>Maintenance</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires maintenance process</td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">MA.L2-3.7.5</td>
                            <td>Require MFA for nonlocal maintenance</td>
                            <td>Maintenance</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Policy requirement</td>
                        </tr>

                        <tr class="practice-header">
                            <td colspan="5"><strong>Media Protection (MP) - 0/8 Covered (0%)</strong></td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">MP.L2-3.8.1</td>
                            <td>Protect system media</td>
                            <td>Media Protection</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires media handling</td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">MP.L2-3.8.2</td>
                            <td>Limit access to CUI on system media</td>
                            <td>Media Protection</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires media controls</td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">MP.L2-3.8.3</td>
                            <td>Sanitize system media</td>
                            <td>Media Protection</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires sanitization</td>
                        </tr>

                        <tr class="practice-header">
                            <td colspan="5"><strong>Personnel Security (PS) - 0/7 Covered (0%)</strong></td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">PS.L2-3.9.1</td>
                            <td>Screen individuals</td>
                            <td>Personnel Security</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires HR process</td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">PS.L2-3.9.2</td>
                            <td>Ensure CUI protection during personnel actions</td>
                            <td>Personnel Security</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires HR process</td>
                        </tr>

                        <tr class="practice-header">
                            <td colspan="5"><strong>Physical Protection (PE) - 0/6 Covered (0%)</strong></td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">PE.L2-3.10.1</td>
                            <td>Limit physical access</td>
                            <td>Physical Protection</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires physical security</td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">PE.L2-3.10.3</td>
                            <td>Escort visitors</td>
                            <td>Physical Protection</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires visitor management</td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">PE.L2-3.10.4</td>
                            <td>Maintain physical access audit logs</td>
                            <td>Physical Protection</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires badge system</td>
                        </tr>

                        <tr class="practice-header">
                            <td colspan="5"><strong>Risk Assessment (RA) - 0/3 Covered (0%)</strong></td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">RA.L2-3.11.1</td>
                            <td>Perform risk assessments</td>
                            <td>Risk Assessment</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires RA process</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">RA.L2-3.11.2</td>
                            <td>Scan for vulnerabilities</td>
                            <td>Risk Assessment</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">SCAP scans, Defender Vuln Mgmt, NSA Horizon AI, Remediation logs</td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">RA.L2-3.11.3</td>
                            <td>Remediate vulnerabilities</td>
                            <td>Risk Assessment</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires patch mgmt</td>
                        </tr>

                        <tr class="practice-header">
                            <td colspan="5"><strong>Security Assessment (CA) - 0/3 Covered (0%)</strong></td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">CA.L2-3.12.1</td>
                            <td>Assess security controls</td>
                            <td>Security Assessment</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires assessment process</td>
                        </tr>
                        <tr class="practice-not-covered">
                            <td class="mono">CA.L2-3.12.2</td>
                            <td>Develop plans of action</td>
                            <td>Security Assessment</td>
                            <td style="text-align: center;">❌</td>
                            <td style="font-size: 0.75rem; color: #6b7280;">Requires POA&M process</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">CA.L2-3.12.4</td>
                            <td>Perform penetration testing</td>
                            <td>Security Assessment</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">SSP, NSA Horizon AI guidance, Network diagrams, System inventory</td>
                        </tr>

                        <tr class="practice-header">
                            <td colspan="5"><strong>System and Communications Protection (SC) - 11/28 Covered (39.3%)</strong></td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SC.L2-3.13.1</td>
                            <td>Monitor communications at system boundaries</td>
                            <td>System & Comm Protection</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">NetFlow, Firewall</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SC.L2-3.13.2</td>
                            <td>Employ architectural designs</td>
                            <td>System & Comm Protection</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">SSP, Network diagrams, Change mgmt docs</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SC.L2-3.13.3</td>
                            <td>Separate user and system functionality</td>
                            <td>System & Comm Protection</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Network diagrams, VLAN configs, Firewall rules, AD GPO</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SC.L2-3.13.5</td>
                            <td>Implement cryptography</td>
                            <td>System & Comm Protection</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">UAG config, Firewall rules, FIPS validation certs</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SC.L2-3.13.6</td>
                            <td>Deny by default network traffic</td>
                            <td>System & Comm Protection</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">NetFlow, Microsoft Defender EDR</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SC.L2-3.13.8</td>
                            <td>Implement cryptography for CUI</td>
                            <td>System & Comm Protection</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">UAG TLS config, O365 GCC High TLS, VPN, NetFlow, FIPS certs</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SC.L2-3.13.11</td>
                            <td>Employ FIPS-validated cryptography</td>
                            <td>System & Comm Protection</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">UAG TLS logs</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SC.L2-3.13.12</td>
                            <td>Prohibit remote activation</td>
                            <td>System & Comm Protection</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">NetFlow, Windows, Syslog</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SC.L2-3.13.13</td>
                            <td>Control split tunneling</td>
                            <td>System & Comm Protection</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">NetFlow, UAG</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SC.L2-3.13.14</td>
                            <td>Control mobile code</td>
                            <td>System & Comm Protection</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Microsoft Defender EDR</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SC.L2-3.13.15</td>
                            <td>Control Voice over IP</td>
                            <td>System & Comm Protection</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">NetFlow</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SC.L2-3.13.16</td>
                            <td>Protect CUI at rest</td>
                            <td>System & Comm Protection</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">VDI monitoring</td>
                        </tr>

                        <tr class="practice-header">
                            <td colspan="5"><strong>System and Information Integrity (SI) - 16/17 Covered (94.1%)</strong></td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SI.L2-3.14.1</td>
                            <td>Identify and report system flaws</td>
                            <td>System & Info Integrity</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Microsoft Defender EDR, Windows, Syslog</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SI.L2-3.14.2</td>
                            <td>Provide malicious code protection</td>
                            <td>System & Info Integrity</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Microsoft Defender EDR</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SI.L2-3.14.3</td>
                            <td>Monitor system security alerts</td>
                            <td>System & Info Integrity</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Microsoft Defender EDR, Windows, Graylog</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SI.L2-3.14.4</td>
                            <td>Update malicious code protection</td>
                            <td>System & Info Integrity</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Microsoft Defender EDR, VDI</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SI.L2-3.14.5</td>
                            <td>Perform periodic scans</td>
                            <td>System & Info Integrity</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Microsoft Defender EDR, VDI</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SI.L2-3.14.6</td>
                            <td>Monitor communications for attacks</td>
                            <td>System & Info Integrity</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">NetFlow, Windows, Microsoft Defender EDR</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SI.L2-3.14.7</td>
                            <td>Identify unauthorized use</td>
                            <td>System & Info Integrity</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">NetFlow, Windows, Microsoft Defender EDR</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SI.L2-3.14.8</td>
                            <td>Perform information input validation</td>
                            <td>System & Info Integrity</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Omnissa Horizon configs, NSA Horizon AI guidance, App security docs</td>
                        </tr>
                        <tr class="practice-covered">
                            <td class="mono">SI.L2-3.14.9</td>
                            <td>Manage information output</td>
                            <td>System & Info Integrity</td>
                            <td style="text-align: center;">✅</td>
                            <td class="mono" style="font-size: 0.75rem;">Purview DLP</td>
                        </tr>

                        <tr class="practice-header">
                            <td colspan="5"><strong>Summary: 89 of 110 practices covered (80.9%) | 21 practices require additional controls</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="info-box info-yellow">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Gap Analysis: Uncovered Practices</h4>
                <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                    The remaining 29 practices (26.4%) require additional technical controls beyond logging:
                </p>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>Physical Security (PE):</strong> 8 practices - Requires physical access controls, visitor management</li>
                    <li><strong>Personnel Security (PS):</strong> 7 practices - Requires HR processes, background checks</li>
                    <li><strong>System & Comm Protection (SC):</strong> 17 practices - Requires encryption, network segmentation</li>
                    <li><strong>Access Control (AC):</strong> 1 practice - Requires PAM solution for privileged access management</li>
                    <li><strong>Awareness & Training (AT):</strong> 4 practices - Requires formal security training program</li>
                </ul>
            </div>
        </div>


        <div id="ssp" class="tab-content">
            <div class="info-box info-blue">
                <h3 style="font-size: 1.5rem; font-weight: bold; margin-bottom: 1rem;">📋 System Security Plan (SSP)</h3>
                <p style="margin-bottom: 1rem;">
                    Complete CMMC Level 2 System Security Plan with all 110 practices documented, including requirements, 
                    assessment objectives, implementation details, and evidence sources.
                </p>
            </div>

            <h2 class="section-title">1. System Identification</h2>
            
            <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 2rem; margin-bottom: 2rem;">
                <table style="width: 100%; border-collapse: collapse;">
                    <tr style="border-bottom: 1px solid #e5e7eb;">
                        <td style="padding: 1rem; font-weight: 600; width: 30%; color: #4b5563;">System Name:</td>
                        <td style="padding: 1rem;">CUI Processing Environment</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #e5e7eb; background: #f9fafb;">
                        <td style="padding: 1rem; font-weight: 600; color: #4b5563;">System Owner:</td>
                        <td style="padding: 1rem;">[Organization Name]</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #e5e7eb;">
                        <td style="padding: 1rem; font-weight: 600; color: #4b5563;">System Type:</td>
                        <td style="padding: 1rem;">Hybrid Cloud Environment (On-Premises + Microsoft 365 GCC High)</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #e5e7eb; background: #f9fafb;">
                        <td style="padding: 1rem; font-weight: 600; color: #4b5563;">CMMC Level:</td>
                        <td style="padding: 1rem;">Level 2 (Foundational)</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #e5e7eb;">
                        <td style="padding: 1rem; font-weight: 600; color: #4b5563;">Authorization Boundary:</td>
                        <td style="padding: 1rem;">All systems processing, storing, or transmitting CUI including VDI environment, file servers, Microsoft 365 GCC High tenant, and supporting infrastructure</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #e5e7eb; background: #f9fafb;">
                        <td style="padding: 1rem; font-weight: 600; color: #4b5563;">System Location:</td>
                        <td style="padding: 1rem;">
                            <strong>On-Premises:</strong> [Physical Address]<br>
                            <strong>Cloud:</strong> Microsoft Azure Government (GCC High)
                        </td>
                    </tr>
                    <tr style="border-bottom: 1px solid #e5e7eb;">
                        <td style="padding: 1rem; font-weight: 600; color: #4b5563;">System Description:</td>
                        <td style="padding: 1rem;">Hybrid environment providing secure processing of Controlled Unclassified Information (CUI) through Omnissa Horizon virtual desktop infrastructure, Microsoft 365 GCC High cloud services, and supporting on-premises infrastructure with comprehensive logging via Graylog SIEM.</td>
                    </tr>
                    <tr style="background: #f9fafb;">
                        <td style="padding: 1rem; font-weight: 600; color: #4b5563;">Date Prepared:</td>
                        <td style="padding: 1rem;">[Date Prepared]</td>
                    </tr>
                </table>
            </div>
            
            <div style="background: #fef3c7; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #f59e0b; margin-bottom: 2rem;">
                <h4 style="color: #92400e; margin-bottom: 0.5rem; font-weight: 600;">Key System Components</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-top: 1rem;">
                    <div>
                        <strong style="color: #92400e;">On-Premises Infrastructure:</strong>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem; font-size: 0.875rem;">
                            <li>Omnissa Horizon VDI Environment</li>
                            <li>Active Directory Domain Controllers (2x)</li>
                            <li>File Server (FILE01)</li>
                            <li>Graylog SIEM (LOG01)</li>
                            <li>AIP Scanner Server (LOG02)</li>
                            <li>Network Gateway / Firewall</li>
                        </ul>
                    </div>
                    <div>
                        <strong style="color: #92400e;">Cloud Services:</strong>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem; font-size: 0.875rem;">
                            <li>Microsoft 365 GCC High</li>
                            <li>Azure Active Directory</li>
                            <li>Microsoft Defender for Endpoint</li>
                            <li>Microsoft Purview (DLP & Information Protection)</li>
                            <li>Azure Log Analytics</li>
                        </ul>
                    </div>
                    <div>
                        <strong style="color: #92400e;">Security Infrastructure:</strong>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem; font-size: 0.875rem;">
                            <li>Omnissa Unified Access Gateway (UAG)</li>
                            <li>Network Firewalls with NetFlow</li>
                            <li>802.1X Network Authentication</li>
                            <li>Graylog SIEM with 2-year retention</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h2 class="section-title">2. System Environment</h2>
            
            <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 2rem; margin-bottom: 2rem;">
                <h3 style="color: #1e40af; margin-bottom: 1rem;">Network Architecture Overview</h3>
                <p style="margin-bottom: 1.5rem; color: #4b5563;">
                    The CUI processing environment utilizes a segmented network architecture with dedicated VLANs for different security zones. Remote access is provided through a UAG (Unified Access Gateway) positioned in a DMZ (VLAN 44) directly connected to the network firewall, ensuring proper isolation before reaching internal systems. The environment is managed through a centralized gateway with comprehensive logging and monitoring.
                </p>
                
                <!-- Network Diagram SVG -->
                <div style="background: #f9fafb; padding: 2rem; border-radius: 8px; border: 2px solid #e5e7eb; margin: 2rem 0;">
                    <svg viewBox="0 0 1200 800" style="width: 100%; height: auto; max-width: 1200px; margin: 0 auto; display: block;">
                        <!-- Title -->
                        <text x="600" y="30" text-anchor="middle" style="font-size: 24px; font-weight: bold; fill: #1e40af;">CUI Processing Environment - Network Architecture</text>
                        
                        <!-- Internet Cloud -->
                        <ellipse cx="600" cy="100" rx="80" ry="40" fill="#dbeafe" stroke="#2563eb" stroke-width="2"/>
                        <text x="600" y="105" text-anchor="middle" style="font-size: 14px; font-weight: bold; fill: #1e40af;">Internet</text>
                        
                        <!-- Arrow to Gateway -->
                        <line x1="600" y1="140" x2="600" y2="180" stroke="#6b7280" stroke-width="2" marker-end="url(#arrowhead)"/>
                        
                        <!-- Gateway/Firewall -->
                        <rect x="500" y="180" width="200" height="80" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="3"/>
                        <text x="600" y="205" text-anchor="middle" style="font-size: 14px; font-weight: bold; fill: #92400e;">Gateway/Firewall</text>
                        <text x="600" y="225" text-anchor="middle" style="font-size: 12px; fill: #92400e;">Network Firewall</text>
                        <text x="600" y="242" text-anchor="middle" style="font-size: 11px; fill: #92400e;">NetFlow + Firewall</text>
                        <text x="600" y="256" text-anchor="middle" style="font-size: 10px; fill: #78350f;">Internet Connected</text>
                        
                        <!-- Management VLAN 99 -->
                        <rect x="50" y="180" width="180" height="80" rx="8" fill="#faf5ff" stroke="#9333ea" stroke-width="2"/>
                        <text x="140" y="205" text-anchor="middle" style="font-size: 13px; font-weight: bold; fill: #6b21a8;">Management</text>
                        <text x="140" y="222" text-anchor="middle" style="font-size="11px; fill: #6b21a8;">VLAN 99</text>
                        <text x="140" y="238" text-anchor="middle" style="font-size: 10px; fill: #6b21a8;">Admin Access Only</text>
                        <text x="140" y="253" text-anchor="middle" style="font-size: 9px; fill: #581c87;">X.Y.99.0/24</text>
                        
                        <!-- UAG External - DMZ VLAN 44 -->
                        <rect x="750" y="180" width="170" height="80" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="3"/>
                        <text x="835" y="203" text-anchor="middle" style="font-size: 13px; font-weight: bold; fill: #92400e;">UAG External</text>
                        <text x="835" y="220" text-anchor="middle" style="font-size: 11px; fill: #92400e;">DMZ (VLAN 44)</text>
                        <text x="835" y="236" text-anchor="middle" style="font-size: 10px; fill: #92400e;">Remote Access</text>
                        <text x="835" y="252" text-anchor="middle" style="font-size: 9px; fill: #78350f;">X.Y.44.10</text>
                        
                        <!-- Central switching area -->
                        <rect x="400" y="320" width="400" height="60" rx="8" fill="#e0f2fe" stroke="#0284c7" stroke-width="2"/>
                        <text x="600" y="345" text-anchor="middle" style="font-size: 14px; font-weight: bold; fill: #0c4a6e;">Core Switch / Router</text>
                        <text x="600" y="365" text-anchor="middle" style="font-size: 11px; fill: #0c4a6e;">VLAN Segmentation & Routing</text>
                        
                        <!-- VLANs -->
                        <!-- VLAN 10 - VDI -->
                        <rect x="50" y="450" width="240" height="120" rx="8" fill="#dbeafe" stroke="#2563eb" stroke-width="3"/>
                        <text x="170" y="475" text-anchor="middle" style="font-size: 14px; font-weight: bold; fill: #1e40af;">VLAN 10 - VDI Users</text>
                        <text x="170" y="492" text-anchor="middle" style="font-size: 10px; fill: #1e40af;">X.Y.10.0/24</text>
                        <text x="170" y="515" text-anchor="middle" style="font-size: 11px; fill: #1e3a8a;">Omnissa Horizon</text>
                        <text x="170" y="532" text-anchor="middle" style="font-size: 10px; fill: #1e3a8a;">Virtual Desktops</text>
                        <text x="170" y="548" text-anchor="middle" style="font-size: 10px; fill: #1e3a8a;">User Workspaces</text>
                        <text x="170" y="563" text-anchor="middle" style="font-size: 9px; fill: #1e3a8a; font-weight: 600;">🔒 CUI Processing</text>
                        
                        <!-- VLAN 20 - Infrastructure -->
                        <rect x="330" y="450" width="240" height="120" rx="8" fill="#dcfce7" stroke="#059669" stroke-width="3"/>
                        <text x="450" y="475" text-anchor="middle" style="font-size: 14px; font-weight: bold; fill: #065f46;">VLAN 20 - Infrastructure</text>
                        <text x="450" y="492" text-anchor="middle" style="font-size: 10px; fill: #065f46;">X.Y.20.0/24</text>
                        <text x="450" y="515" text-anchor="middle" style="font-size: 11px; fill: #064e3b;">DC01, DC02 (AD)</text>
                        <text x="450" y="532" text-anchor="middle" style="font-size: 11px; fill: #064e3b;">LOG01 (Graylog SIEM)</text>
                        <text x="450" y="548" text-anchor="middle" style="font-size: 11px; fill: #064e3b;">LOG02 (AIP Scanner)</text>
                        <text x="450" y="563" text-anchor="middle" style="font-size: 9px; fill: #064e3b; font-weight: 600;">🔐 Core Services</text>
                        
                        <!-- VLAN 30 - File Storage -->
                        <rect x="610" y="450" width="240" height="120" rx="8" fill="#fce7f3" stroke="#be185d" stroke-width="3"/>
                        <text x="730" y="475" text-anchor="middle" style="font-size: 14px; font-weight: bold; fill: #831843;">VLAN 30 - File Storage</text>
                        <text x="730" y="492" text-anchor="middle" style="font-size: 10px; fill: #831843;">X.Y.30.0/24</text>
                        <text x="730" y="515" text-anchor="middle" style="font-size: 11px; fill: #831843;">FILE01</text>
                        <text x="730" y="532" text-anchor="middle" style="font-size: 10px; fill: #9f1239;">SMB File Shares</text>
                        <text x="730" y="548" text-anchor="middle" style="font-size: 10px; fill: #9f1239;">CUI Documents</text>
                        <text x="730" y="563" text-anchor="middle" style="font-size: 9px; fill: #9f1239; font-weight: 600;">📁 Data Storage</text>
                        
                        <!-- GCC High Cloud -->
                        <rect x="890" y="450" width="260" height="120" rx="8" fill="#f3f4f6" stroke="#4b5563" stroke-width="2" stroke-dasharray="5,5"/>
                        <text x="1020" y="475" text-anchor="middle" style="font-size: 14px; font-weight: bold; fill: #1f2937;">Microsoft 365 GCC High</text>
                        <text x="1020" y="492" text-anchor="middle" style="font-size: 9px; fill: #4b5563;">Azure Government Cloud</text>
                        <text x="1020" y="512" text-anchor="middle" style="font-size: 10px; fill: #374151;">• Azure AD</text>
                        <text x="1020" y="528" text-anchor="middle" style="font-size: 10px; fill: #374151;">• Defender for Endpoint</text>
                        <text x="1020" y="544" text-anchor="middle" style="font-size: 10px; fill: #374151;">• Purview DLP</text>
                        <text x="1020" y="560" text-anchor="middle" style="font-size: 10px; fill: #374151;">• Azure Log Analytics</text>
                        
                        <!-- Network Connections -->
                        <!-- Gateway to Core Switch -->
                        <line x1="600" y1="260" x2="600" y2="320" stroke="#6b7280" stroke-width="3"/>
                        
                        <!-- Gateway DMZ Port to UAG External -->
                        <line x1="700" y1="220" x2="750" y2="220" stroke="#f59e0b" stroke-width="3"/>
                        <text x="725" y="210" text-anchor="middle" style="font-size: 9px; fill: #92400e;">DMZ</text>
                        
                        <!-- Core Switch to VLANs -->
                        <line x1="450" y1="380" x2="170" y2="450" stroke="#2563eb" stroke-width="2"/>
                        <line x1="550" y1="380" x2="450" y2="450" stroke="#059669" stroke-width="2"/>
                        <line x1="650" y1="380" x2="730" y2="450" stroke="#be185d" stroke-width="2"/>
                        
                        <!-- Management connections -->
                        <line x1="230" y1="220" x2="400" y2="340" stroke="#9333ea" stroke-width="1" stroke-dasharray="3,3"/>
                        
                        <!-- GCC High connection -->
                        <line x1="800" y1="350" x2="1020" y2="450" stroke="#4b5563" stroke-width="2" stroke-dasharray="5,5"/>
                        <text x="900" y="400" style="font-size: 10px; fill: #4b5563;">HTTPS/TLS</text>
                        
                        <!-- Logging flows -->
                        <text x="300" y="510" style="font-size: 9px; fill: #6b7280;">← Logs</text>
                        <text x="580" y="510" style="font-size: 9px; fill: #6b7280;">Logs →</text>
                        
                        <!-- Legend -->
                        <rect x="50" y="620" width="1100" height="150" rx="8" fill="white" stroke="#e5e7eb" stroke-width="2"/>
                        <text x="600" y="645" text-anchor="middle" style="font-size: 16px; font-weight: bold; fill: #1f2937;">Legend & Security Controls</text>
                        
                        <text x="80" y="675" style="font-size: 12px; fill: #1f2937; font-weight: 600;">Network Segmentation:</text>
                        <rect x="80" y="685" width="30" height="15" fill="#dbeafe" stroke="#2563eb" stroke-width="2"/>
                        <text x="115" y="697" style="font-size: 11px; fill: #374151;">VDI User Zone</text>
                        
                        <rect x="230" y="685" width="30" height="15" fill="#dcfce7" stroke="#059669" stroke-width="2"/>
                        <text x="265" y="697" style="font-size: 11px; fill: #374151;">Infrastructure Zone</text>
                        
                        <rect x="400" y="685" width="30" height="15" fill="#fce7f3" stroke="#be185d" stroke-width="2"/>
                        <text x="435" y="697" style="font-size: 11px; fill: #374151;">Storage Zone</text>
                        
                        <rect x="550" y="685" width="30" height="15" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
                        <text x="585" y="697" style="font-size: 11px; fill: #374151;">Gateway/DMZ</text>
                        
                        <text x="80" y="725" style="font-size: 12px; fill: #1f2937; font-weight: 600;">Security Controls:</text>
                        <text x="80" y="743" style="font-size: 11px; fill: #374151;">• Firewall rules between all VLANs</text>
                        <text x="80" y="758" style="font-size: 11px; fill: #374151;">• NetFlow monitoring on all interfaces</text>
                        
                        <text x="350" y="743" style="font-size: 11px; fill: #374151;">• UAG in isolated DMZ (VLAN 44)</text>
                        <text x="350" y="758" style="font-size: 11px; fill: #374151;">• 802.1X network authentication</text>
                        
                        <text x="650" y="743" style="font-size: 11px; fill: #374151;">• TLS 1.2+ for all remote access</text>
                        <text x="650" y="758" style="font-size: 11px; fill: #374151;">• 2-year log retention per CMMC</text>
                        
                        <!-- Arrow marker definition -->
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#6b7280" />
                            </marker>
                        </defs>
                    </svg>
                </div>
                
                <h3 style="color: #1e40af; margin: 2rem 0 1rem;">VLAN Allocation & Purpose</h3>
                <table style="width: 100%; border-collapse: collapse; margin-bottom: 2rem;">
                    <thead>
                        <tr style="background: #dbeafe; color: black;">
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid #2563eb; color: black; font-weight: 600;">VLAN ID</th>
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid #2563eb; color: black; font-weight: 600;">Network</th>
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid #2563eb; color: black; font-weight: 600;">Purpose</th>
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid #2563eb; color: black; font-weight: 600;">Key Systems</th>
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid #2563eb; color: black; font-weight: 600;">Security Zone</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: #dbeafe;">
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-weight: 600;">VLAN 10</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-family: monospace;">X.Y.10.0/24</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">VDI User Desktops</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">Omnissa Horizon VMs, User Sessions</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;"><span style="background: #10b981; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">CUI Processing</span></td>
                        </tr>
                        <tr style="background: #dcfce7;">
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-weight: 600;">VLAN 20</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-family: monospace;">X.Y.20.0/24</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">Core Infrastructure</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">DC01, DC02, LOG01 (Graylog), LOG02 (AIP)</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;"><span style="background: #059669; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">Critical Services</span></td>
                        </tr>
                        <tr style="background: #fce7f3;">
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-weight: 600;">VLAN 30</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-family: monospace;">X.Y.30.0/24</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">File Storage</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">FILE01 (SMB Shares, CUI Documents)</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;"><span style="background: #be185d; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">Data Storage</span></td>
                        </tr>
                        
                        <tr style="background: #fef3c7;">
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-weight: 600;">VLAN 44</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-family: monospace;">X.Y.44.0/24</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">DMZ (Demilitarized Zone)</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">UAG External (Remote Access Gateway)</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;"><span style="background: #f59e0b; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">DMZ</span></td>
                        </tr>
                        <tr style="background: #faf5ff;">
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-weight: 600;">VLAN 99</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-family: monospace;">X.Y.99.0/24</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">Management Network</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">Admin Access to All Devices</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;"><span style="background: #9333ea; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">Management Only</span></td>
                        </tr>
                    </tbody>
                </table>
                
                <h3 style="color: #1e40af; margin: 2rem 0 1rem;">Cloud Services Integration</h3>
                <div style="background: #f3f4f6; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #4b5563;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                        <div>
                            <h4 style="color: #1f2937; margin-bottom: 0.5rem;">Microsoft 365 GCC High</h4>
                            <ul style="font-size: 0.875rem; margin-left: 1.5rem; color: #4b5563;">
                                <li>Exchange Online (Email)</li>
                                <li>SharePoint Online</li>
                                <li>OneDrive for Business</li>
                                <li>Microsoft Teams</li>
                            </ul>
                        </div>
                        <div>
                            <h4 style="color: #1f2937; margin-bottom: 0.5rem;">Security Services</h4>
                            <ul style="font-size: 0.875rem; margin-left: 1.5rem; color: #4b5563;">
                                <li>Azure Active Directory</li>
                                <li>Microsoft Defender for Endpoint</li>
                                <li>Microsoft Purview (DLP & AIP)</li>
                                <li>Azure Conditional Access</li>
                            </ul>
                        </div>
                        <div>
                            <h4 style="color: #1f2937; margin-bottom: 0.5rem;">Logging & Monitoring</h4>
                            <ul style="font-size: 0.875rem; margin-left: 1.5rem; color: #4b5563;">
                                <li>Azure Log Analytics</li>
                                <li>Microsoft Sentinel (SIEM)</li>
                                <li>Unified Audit Logs</li>
                                <li>Sign-in & Audit Logs</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <h3 style="color: #1e40af; margin: 2rem 0 1rem;">Data Flow & Information Protection</h3>
                <div style="background: #eff6ff; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #2563eb; margin-bottom: 2rem;">
                    <h4 style="color: #1e40af; margin-bottom: 0.75rem;">CUI Data Flows</h4>
                    <ol style="margin-left: 1.5rem; color: #1f2937; line-height: 1.8;">
                        <li><strong>User Access:</strong> Remote users connect via UAG (HTTPS/TLS 1.2+) → VDI desktops (VLAN 10) → Access CUI via controlled environment</li>
                        <li><strong>File Storage:</strong> VDI desktops → FILE01 (VLAN 30) via SMB over encrypted channels → AIP Scanner monitors for CUI</li>
                        <li><strong>Cloud Services:</strong> VDI & Infrastructure → Microsoft 365 GCC High via HTTPS → Azure AD authentication required</li>
                        <li><strong>Logging:</strong> All systems → Graylog (VLAN 20) via Syslog/WinRM → Azure Log Analytics for cloud events</li>
                    </ol>
                    
                    <h4 style="color: #1e40af; margin: 1.5rem 0 0.75rem;">Information Protection Controls</h4>
                    <ul style="margin-left: 1.5rem; color: #1f2937; line-height: 1.8;">
                        <li><strong>Network Segmentation:</strong> Firewall rules between all VLANs with deny-by-default policy</li>
                        <li><strong>Encryption in Transit:</strong> TLS 1.2+ for all external connections, SMB signing for internal file shares</li>
                        <li><strong>Encryption at Rest:</strong> BitLocker on all Windows systems, AES-256 for Azure storage</li>
                        <li><strong>Data Loss Prevention:</strong> Microsoft Purview DLP policies prevent CUI transmission outside authorized systems</li>
                        <li><strong>Access Control:</strong> Azure AD + on-premises AD with MFA for privileged access</li>
                        <li><strong>Monitoring:</strong> NetFlow + Graylog SIEM + Microsoft Defender EDR provide comprehensive visibility</li>
                    </ul>
                </div>
            </div>

            <h2 class="section-title">4. Change Record</h2>
            
            <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 2rem; margin-bottom: 2rem;">
                <p style="margin-bottom: 1.5rem; color: #4b5563;">
                    This section documents all changes made to the System Security Plan, including updates to system configuration, practice implementations, and documentation revisions.
                </p>
                
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: #dbeafe; color: black;">
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid #2563eb; width: 12%; color: black; font-weight: 600;">Version</th>
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid #2563eb; width: 15%; color: black; font-weight: 600;">Date</th>
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid #2563eb; width: 20%; color: black; font-weight: 600;">Author</th>
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid #2563eb; color: black; font-weight: 600;">Description of Changes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: #f9fafb;">
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-weight: 600;">1.0</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">[Today's Date]</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">[System Owner]</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">
                                <strong>Initial SSP Creation</strong>
                                <ul style="margin: 0.5rem 0 0 1.5rem; font-size: 0.875rem;">
                                    <li>Documented hybrid CUI processing environment</li>
                                    <li>Completed all 110 CMMC Level 2 practice assessments</li>
                                    <li>89 practices implemented (80.9% coverage)</li>
                                    <li>Created network architecture diagram</li>
                                    <li>Documented logging and monitoring infrastructure</li>
                                    <li>Mapped evidence sources for all implemented controls</li>
                                </ul>
                            </td>
                        </tr>
                        <tr style="background: white;">
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-weight: 600;">1.1</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">[Future Date]</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">[Author Name]</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">
                                [Document future changes here, such as:]
                                <ul style="margin: 0.5rem 0 0 1.5rem; font-size: 0.875rem;">
                                    <li>Implementation of AC.L2-3.1.7 (PAM solution deployed)</li>
                                    <li>Updated network diagram to reflect new security zones</li>
                                    <li>Added training program documentation (AT practices)</li>
                                </ul>
                            </td>
                        </tr>
                        <tr style="background: #f9fafb;">
                            <td colspan="4" style="padding: 1rem; border: 1px solid #e5e7eb; text-align: center; color: #6b7280; font-style: italic;">
                                Additional revisions will be documented here as the system evolves and additional controls are implemented.
                            </td>
                        </tr>
                    </tbody>
                </table>
                
                <div style="background: #fef3c7; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #f59e0b; margin-top: 2rem;">
                    <h4 style="color: #92400e; margin-bottom: 0.75rem; font-weight: 600;">📋 Change Management Process</h4>
                    <p style="font-size: 0.875rem; color: #78350f; margin-bottom: 0.75rem;">
                        All changes to the System Security Plan must follow the documented change management process:
                    </p>
                    <ol style="margin-left: 1.5rem; font-size: 0.875rem; color: #78350f; line-height: 1.8;">
                        <li><strong>Change Request:</strong> Submit proposed changes to system owner or security officer</li>
                        <li><strong>Impact Assessment:</strong> Evaluate security impact of proposed changes (CM.L2-3.4.4)</li>
                        <li><strong>Review & Approval:</strong> Changes reviewed by security team and approved by system owner</li>
                        <li><strong>Implementation:</strong> Execute changes with appropriate testing and validation</li>
                        <li><strong>Documentation:</strong> Update SSP and add entry to Change Record table</li>
                        <li><strong>Communication:</strong> Notify stakeholders and update relevant personnel</li>
                    </ol>
                </div>
                
                <div style="background: #eff6ff; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #2563eb; margin-top: 1.5rem;">
                    <h4 style="color: #1e40af; margin-bottom: 0.75rem; font-weight: 600;">🔄 Review Schedule</h4>
                    <ul style="margin-left: 1.5rem; font-size: 0.875rem; color: #1e3a8a; line-height: 1.8;">
                        <li><strong>Quarterly Reviews:</strong> System configuration and practice implementation status</li>
                        <li><strong>Annual Reviews:</strong> Complete SSP review and update for CMMC compliance</li>
                        <li><strong>Change-Triggered Reviews:</strong> Major system changes, security incidents, or new CMMC guidance</li>
                        <li><strong>Pre-Assessment Review:</strong> Comprehensive review 60 days prior to C3PAO assessment</li>
                    </ul>
                </div>
            </div>
<h2 class="section-title">Executive Summary</h2>
            
            <div style="background: linear-gradient(135deg, #1e40af 0%, #7c3aed 100%); border-radius: 8px; padding: 2rem; color: white; margin-bottom: 2rem;">
                <h3 style="font-size: 1.75rem; font-weight: bold; margin-bottom: 1rem;">🛡️ CMMC Level 2 System Security Plan</h3>
                <p style="opacity: 0.95; margin-bottom: 1.5rem;">
                    Comprehensive documentation of security controls and implementation status across all CMMC domains
                </p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                    <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); border-radius: 6px; padding: 1.25rem; text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 0.25rem;">89</div>
                        <div style="font-size: 0.875rem; opacity: 0.95;">Practices Implemented</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); border-radius: 6px; padding: 1.25rem; text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 0.25rem;">80.9%</div>
                        <div style="font-size: 0.875rem; opacity: 0.95;">Coverage Rate</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); border-radius: 6px; padding: 1.25rem; text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 0.25rem;">21</div>
                        <div style="font-size: 0.875rem; opacity: 0.95;">Remaining Gaps</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); border-radius: 6px; padding: 1.25rem; text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 0.25rem;">110</div>
                        <div style="font-size: 0.875rem; opacity: 0.95;">Total Practices</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3 style="font-size: 1.375rem; font-weight: bold; margin-bottom: 1.5rem; color: #1f2937;">📊 CMMC Domain Coverage</h3>
                
                <div class="domain-row">
                    <div class="domain-name">Audit & Accountability</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar progress-green" style="width: 100%">100%</div>
                    </div>
                    <div class="coverage-count">9/9</div>
                </div>
                
                <div class="domain-row">
                    <div class="domain-name">Incident Response</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar progress-green" style="width: 100%">100%</div>
                    </div>
                    <div class="coverage-count">3/3</div>
                </div>
                
                <div class="domain-row">
                    <div class="domain-name">System & Info Integrity</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar progress-green" style="width: 100%">100%</div>
                    </div>
                    <div class="coverage-count">9/9</div>
                </div>
                
                <div class="domain-row">
                    <div class="domain-name">System & Comm Protection</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar progress-green" style="width: 100%">100%</div>
                    </div>
                    <div class="coverage-count">12/12</div>
                </div>
                
                <div class="domain-row">
                    <div class="domain-name">Access Control</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar progress-blue" style="width: 94.7%">94.7%</div>
                    </div>
                    <div class="coverage-count">18/19</div>
                </div>
                
                <div class="domain-row">
                    <div class="domain-name">Identification & Auth</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar progress-blue" style="width: 90.9%">90.9%</div>
                    </div>
                    <div class="coverage-count">10/11</div>
                </div>
                
                <div class="domain-row">
                    <div class="domain-name">Configuration Management</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar progress-yellow" style="width: 77.8%">77.8%</div>
                    </div>
                    <div class="coverage-count">7/9</div>
                </div>
                
                <div class="domain-row">
                    <div class="domain-name">Awareness & Training</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar progress-red" style="width: 0%">0%</div>
                    </div>
                    <div class="coverage-count">0/3</div>
                </div>
                
                <div class="domain-row">
                    <div class="domain-name">Maintenance</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar progress-red" style="width: 0%">0%</div>
                    </div>
                    <div class="coverage-count">0/3</div>
                </div>
                
                <div class="domain-row">
                    <div class="domain-name">Media Protection</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar progress-red" style="width: 0%">0%</div>
                    </div>
                    <div class="coverage-count">0/3</div>
                </div>
                
                <div class="domain-row">
                    <div class="domain-name">Personnel Security</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar progress-red" style="width: 0%">0%</div>
                    </div>
                    <div class="coverage-count">0/2</div>
                </div>
                
                <div class="domain-row">
                    <div class="domain-name">Physical Protection</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar progress-red" style="width: 0%">0%</div>
                    </div>
                    <div class="coverage-count">0/3</div>
                </div>
                
                <div class="domain-row">
                    <div class="domain-name">Risk Assessment</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar progress-red" style="width: 0%">0%</div>
                    </div>
                    <div class="coverage-count">0/3</div>
                </div>
                
                <div class="domain-row">
                    <div class="domain-name">Security Assessment</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar progress-red" style="width: 0%">0%</div>
                    </div>
                    <div class="coverage-count">0/3</div>
                </div>
            </div>
            
            <div style="background: #eff6ff; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #2563eb; margin: 2rem 0;">
                <h3 style="color: #1e40af; margin-bottom: 0.5rem;">Architecture Overview</h3>
                <p style="font-size: 0.875rem; color: #1f2937; margin-bottom: 0.5rem;">
                    This System Security Plan documents CMMC Level 2 implementation within a hybrid environment:
                </p>
                <ul style="font-size: 0.875rem; margin-left: 2rem; color: #1f2937; line-height: 1.8;">
                    <li><strong>On-Premises:</strong> Omnissa Horizon VDI (VLAN 10), Domain Controllers (VLAN 20), File Server (VLAN 30), Gateway/Firewall (Internet Connected), DMZ (VLAN 44)</li>
                    <li><strong>Cloud:</strong> Microsoft 365 GCC High with Azure AD, Microsoft Defender for Endpoint, Microsoft Purview DLP</li>
                    <li><strong>Logging:</strong> Graylog SIEM with NetFlow, Syslog, Windows Event Forwarding, Azure Log Analytics</li>
                    <li><strong>Network:</strong> VLAN segmentation, DMZ isolation, firewall rules, NetFlow monitoring, 802.1X authentication</li>
                </ul>
            </div>
            
            <h2 class="section-title">Security Practices Implementation</h2>
            <p style="margin-bottom: 2rem;">This section documents CMMC Level 2 practices with requirements, assessment objectives, and implementation details.</p>

<h3 class="domain-title">Access Control - 18/19 Covered</h3>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.1</span>
                <div class="practice-title">Limit system access to authorized users</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Limit system access to authorized users, processes acting on behalf of authorized users, and devices (including other systems).
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] authorized users are identified;</li>
                        <li>[b] processes acting on behalf of authorized users are identified;</li>
                        <li>[c] devices (and other systems) authorized to connect to the system are identified;</li>
                        <li>[d] system access is limited to authorized users;</li>
                        <li>[e] system access is limited to processes acting on behalf of authorized users; and</li>
                        <li>[f] system access is limited to authorized devices (including other systems).</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Active Directory integration with VDI environment ensures all users are authenticated before accessing CUI. Omnissa Horizon tracks all user sessions and automated processes. Azure AD logs capture all authentication attempts. Network devices use 802.1X for device authentication. Account creation requires documented approval and accounts are reviewed quarterly. All system access is logged and monitored through Graylog SIEM.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> VDI, AAD, Windows, Syslog
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.11</span>
                <div class="practice-title">Terminate user sessions after inactivity</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Terminate (automatically) a user session after a defined condition.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] conditions requiring a user session to terminate are defined; and</li>
                        <li>[b] a user session is automatically terminated after any of the defined conditions occur.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    VDI session timeout configured for 30 minutes of inactivity. Omnissa Horizon automatically terminates idle sessions. Azure AD session lifetime policies enforce maximum session duration. Conditional access policies terminate sessions based on risk. Session termination events logged to Graylog.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> VDI, AAD, Windows
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.12</span>
                <div class="practice-title">Monitor and control remote access sessions</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Monitor and control remote access sessions.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] remote access sessions are permitted;</li>
                        <li>[b] the types of permitted remote access are identified;</li>
                        <li>[c] remote access sessions are controlled; and</li>
                        <li>[d] remote access sessions are monitored.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Omnissa Unified Access Gateway (UAG) provides single entry point for remote access. All remote sessions proxied through UAG with session monitoring. NetFlow tracks all remote access connections. UAG logs capture session start/stop, data transfer, and client details. Graylog dashboards visualize remote access patterns and anomalies.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> VDI, UAG, NetFlow
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.13</span>
                <div class="practice-title">Employ cryptographic mechanisms</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Employ cryptographic mechanisms to protect the confidentiality of remote access sessions.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] cryptographic mechanisms to protect the confidentiality of remote access sessions are identified; and</li>
                        <li>[b] cryptographic mechanisms to protect the confidentiality of remote access sessions are implemented.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    UAG enforces TLS 1.2+ for all remote access sessions. Azure AD uses TLS for authentication. VDI traffic encrypted with AES-256 via Omnissa Blast protocol. All cryptographic settings logged in syslog.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> UAG, Syslog
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.14</span>
                <div class="practice-title">Control CUI in accordance with approved authorizations</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Route remote access via managed access control points.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] managed access control points are identified and implemented; and</li>
                        <li>[b] remote access is routed through managed network access control points.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    UAG serves as mandatory managed access point for all remote access. No direct RDP or SSH access allowed from external networks. Firewall rules enforce routing through UAG. Azure AD conditional access requires compliant devices. All remote access attempts logged with source IP and authentication details.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> VDI, AAD
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.15</span>
                <div class="practice-title">Authorize wireless access</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Authorize wireless access prior to allowing such connections.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] privileged commands authorized for remote execution are identified;</li>
                        <li>[b] security-relevant information authorized to be accessed remotely is identified;</li>
                        <li>[c] the execution of the identified privileged commands via remote access is authorized; and</li>
                        <li>[d] access to the identified security-relevant information via remote access is authorized.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Network flow monitoring via Graylog NetFlow. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> NetFlow, Syslog
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.16</span>
                <div class="practice-title">Protect wireless access using authentication</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Protect wireless access using authentication and encryption.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] wireless access points are identified; and</li>
                        <li>[b] wireless access is authorized prior to allowing such connections.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Implemented via: N/A - No WiFi in CMMC boundary
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> N/A - No WiFi in CMMC boundary
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.18</span>
                <div class="practice-title">Control connection of mobile devices</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Control connection of mobile devices.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] mobile devices that process, store, or transmit CUI are identified;</li>
                        <li>[b] mobile device connections are authorized; and</li>
                        <li>[c] mobile device connections are monitored and logged.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Omnissa Horizon VDI logging configured. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> VDI, UAG
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.19</span>
                <div class="practice-title">Authorize external system connections</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Encrypt CUI on mobile devices and mobile computing platforms.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] mobile devices and mobile computing platforms that process, store, or transmit CUI are identified; and</li>
                        <li>[b] encryption is employed to protect CUI on identified mobile devices and mobile computing platforms.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Omnissa Horizon VDI logging configured. Network flow monitoring via Graylog NetFlow. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> NetFlow, VDI
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.2</span>
                <div class="practice-title">Limit system access to types of transactions</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Limit system access to the types of transactions and functions that authorized users are permitted to execute.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] the types of transactions and functions that authorized users are permitted to execute are defined; and</li>
                        <li>[b] system access is limited to the defined types of transactions and functions for authorized users.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Role-Based Access Control (RBAC) implemented through Active Directory security groups defines transaction types by role. VDI golden images enforce application whitelisting. Transaction logging in Windows Event Logs tracks all user actions. Access control lists limit application and data access based on role and identity.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> VDI, Windows, Syslog
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.20</span>
                <div class="practice-title">Control use of portable storage devices</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Verify and control/limit connections to and use of external systems.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] external systems that connect to the system are identified;</li>
                        <li>[b] the interface used for the connection to external systems is identified;</li>
                        <li>[c] security requirements for the connection to external systems are identified; and</li>
                        <li>[d] a terms and conditions agreement that details security requirements is employed for connections to external systems.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Omnissa Horizon VDI logging configured. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> VDI (USB events)
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.21</span>
                <div class="practice-title">Limit use of portable storage devices</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Limit use of portable storage devices on external systems.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] the use of portable storage devices containing CUI on external systems is identified;</li>
                        <li>[b] restrictions on the use of portable storage devices containing CUI on external systems are defined; and</li>
                        <li>[c] the use of portable storage devices containing CUI on external systems is restricted in accordance with the defined restrictions.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Omnissa Horizon VDI logging configured. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> VDI (USB events)
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.22</span>
                <div class="practice-title">Control CUI posted publicly</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Control CUI posted or processed on publicly accessible systems.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] public information systems are identified;</li>
                        <li>[b] controls on CUI posted or processed on public information systems or publicly accessible information systems are defined; and</li>
                        <li>[c] CUI posted or processed on public information systems or publicly accessible information systems is controlled in accordance with defined controls.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Network flow monitoring via Graylog NetFlow. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> NetFlow, Web proxy
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.23</span>
                <div class="practice-title">Control the use of CUI on external systems</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Control the use of CUI on external systems.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] NOTE: This practice does not exist in official CMMC Level 2 (110 practices). The following objectives are based on related NIST controls:</li>
                        <li>[b] external systems on which CUI may be accessed, processed, or stored are identified;</li>
                        <li>[c] requirements and restrictions for the use of CUI on external systems are defined;</li>
                        <li>[d] controls are implemented to ensure CUI on external systems is protected in accordance with defined requirements; and</li>
                        <li>[e] the use of CUI on external systems is monitored and controlled in accordance with organizational policies.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Microsoft Purview DLP policies enforced. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Purview DLP
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.3</span>
                <div class="practice-title">Control the flow of CUI</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Control the flow of CUI in accordance with approved authorizations.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] information flow control policies are defined;</li>
                        <li>[b] methods and enforcement mechanisms for controlling the flow of CUI are defined;</li>
                        <li>[c] designated sources and destinations (e.g., networks, individuals, and devices) for CUI within the system and between interconnected systems are identified;</li>
                        <li>[d] authorizations for controlling the flow of CUI are defined; and</li>
                        <li>[e] approved authorizations for controlling the flow of CUI are enforced.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Information flow control policies documented in security policy. NetFlow monitoring tracks all CUI data flows between networks. Microsoft Purview DLP policies prevent unauthorized CUI transmission. Firewall rules enforce network segmentation with designated sources and destinations. VDI session logs track all file transfers and clipboard operations.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> NetFlow, VDI
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.4</span>
                <div class="practice-title">Separate duties of individuals</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Separate the duties of individuals to reduce the risk of malevolent activity without collusion.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] the duties of individuals requiring separation are defined;</li>
                        <li>[b] responsibilities for duties that require separation are assigned to separate individuals; and</li>
                        <li>[c] access privileges that enable individuals to exercise the duties that require separation are granted to separate individuals.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Security roles defined with separation of duties matrix. Critical functions (security admin, system admin, auditor) assigned to different individuals. Active Directory group policies enforce role-based access. Quarterly reviews verify separation maintained. Windows Event Logs and Azure AD logs track role assignments and usage.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> AAD, Windows, Syslog
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.5</span>
                <div class="practice-title">Employ least privilege</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Employ the principle of least privilege, including for specific security functions and privileged accounts.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] privileged accounts are identified;</li>
                        <li>[b] access to privileged accounts is authorized in accordance with the principle of least privilege;</li>
                        <li>[c] security functions are identified; and</li>
                        <li>[d] access to security functions is authorized in accordance with the principle of least privilege.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Privileged accounts (Domain Admins, Enterprise Admins) identified and documented. Just-in-time privileged access implemented via Azure AD PIM. Microsoft Defender EDR monitors privileged account usage. GPOs restrict admin rights to only necessary systems. All privileged actions logged to Graylog with alerts for suspicious activity.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Microsoft Defender EDR, Windows, Syslog
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AC.L2-3.1.6</span>
                <div class="practice-title">Use non-privileged accounts</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Use non-privileged accounts or roles when accessing nonsecurity functions.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] nonsecurity functions are identified; and</li>
                        <li>[b] users are required to use non-privileged accounts or roles when accessing nonsecurity functions.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Standard user accounts defined for day-to-day work. Administrative functions blocked on standard accounts. Microsoft Defender EDR detects and alerts on privilege escalation attempts. VDI desktops run with standard user privileges. Azure AD conditional access enforces non-privileged account usage for routine tasks.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Microsoft Defender EDR, Windows, Syslog
                </div>
            </div>

            <div class="practice-card not-covered">
                <span class="practice-id">AC.L2-3.1.7</span>
                <div class="practice-title">Prevent non-privileged users from executing privileged functions</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Prevent non-privileged users from executing privileged functions and capture the execution of such functions in audit logs.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] privileged functions are defined;</li>
                        <li>[b] non-privileged users are defined;</li>
                        <li>[c] non-privileged users are prevented from executing privileged functions; and</li>
                        <li>[d] the execution of privileged functions is captured in audit logs.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires PAM solution
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires PAM solution
                </div>
            </div>

<h3 class="domain-title">Audit & Accountability - 9/9 Covered</h3>

            <div class="practice-card covered">
                <span class="practice-id">AU.L2-3.3.1</span>
                <div class="practice-title">Create and retain audit logs</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] an audit record generation capability for the system is implemented;</li>
                        <li>[b] event types that the system is capable of auditing are defined from the following list: [successful and unsuccessful account logon events, account management events, object access, policy change, privilege functions, process tracking, and system events];</li>
                        <li>[c] an audit record generation capability for the organization-defined event types from the list is provided; and</li>
                        <li>[d] the event types that are to be audited on the system are coordinated with related audit information contained in audit records generated by other organizational systems.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Implemented via: All sources
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> All sources
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AU.L2-3.3.2</span>
                <div class="practice-title">Ensure actions can be traced to users</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] the content of audit records needed to support after-the-fact investigations of security incidents is defined;</li>
                        <li>[b] audit records contain the defined content needed to support after-the-fact investigations of security incidents.</li>
                        <li>[c] the system's audit records for the organization-defined event types from AU.L2-3.3.1 include what, when, where, source, outcome, and identity information.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Implemented via: All sources
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> All sources
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AU.L2-3.3.3</span>
                <div class="practice-title">Review and update logged events</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] a process for reviewing and analyzing system audit records for indications of inappropriate or unusual activity is defined;</li>
                        <li>[b] the frequency to review and analyze system audit records for indications of inappropriate or unusual activity is defined;</li>
                        <li>[c] system audit records are reviewed and analyzed for indications of inappropriate or unusual activity in accordance with the organization-defined process; and</li>
                        <li>[d] system audit records are reviewed and analyzed for indications of inappropriate or unusual activity with the organization-defined frequency.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Graylog SIEM aggregation and analysis. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Graylog dashboards
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AU.L2-3.3.4</span>
                <div class="practice-title">Alert on audit processing failures</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] audit failure events are defined;</li>
                        <li>[b] personnel or roles to be alerted in the event of an audit failure are identified; and</li>
                        <li>[c] personnel or roles are alerted in the event of an audit failure.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Graylog SIEM aggregation and analysis. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Graylog alerts
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AU.L2-3.3.5</span>
                <div class="practice-title">Correlate audit record review</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] a capability to centrally review and analyze audit records from multiple system components is provided; and</li>
                        <li>[b] a capability to centrally manage the content captured in audit records generated by multiple system components is provided.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Implemented via: Ollama AI analysis
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Ollama AI analysis
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AU.L2-3.3.6</span>
                <div class="practice-title">Provide audit reduction and report generation</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] a process to reduce the level of audit activity is defined;</li>
                        <li>[b] the level of audit activity is reduced when there is a reduction in identified security risks; and</li>
                        <li>[c] security violations are reported when they are detected.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Graylog SIEM aggregation and analysis. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Graylog queries
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AU.L2-3.3.7</span>
                <div class="practice-title">Time-stamp audit records</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] system clocks are compared to an authoritative time source on an organization-defined frequency; and</li>
                        <li>[b] system clocks are synchronized to the authoritative time source on an organization-defined frequency when the time difference exceeds the organization-defined time period.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Implemented via: All sources
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> All sources
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AU.L2-3.3.8</span>
                <div class="practice-title">Protect audit information</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] audit information is protected from unauthorized access;</li>
                        <li>[b] audit information is protected from unauthorized modification; and</li>
                        <li>[c] audit tools are protected from unauthorized access, modification, and deletion.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Graylog SIEM aggregation and analysis. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Graylog access control
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">AU.L2-3.3.9</span>
                <div class="practice-title">Limit audit information management</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] audit records are retained for an organization-defined time period consistent with records retention requirements to provide support for after-the-fact investigations of security incidents;</li>
                        <li>[b] audit records are available for analysis for investigations; and</li>
                        <li>[c] the audit records of online audit logs are protected from unauthorized deletion.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Graylog SIEM aggregation and analysis. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Graylog RBAC
                </div>
            </div>

<h3 class="domain-title">Awareness & Training - 0/3 Covered</h3>

            <div class="practice-card not-covered">
                <span class="practice-id">AT.L2-3.2.1</span>
                <div class="practice-title">Security awareness and training</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] roles and responsibilities of users are defined;</li>
                        <li>[b] security risks associated with defined roles and responsibilities are identified;</li>
                        <li>[c] security risk awareness training is provided to defined roles and responsibilities; and</li>
                        <li>[d] security risk awareness training is provided before authorizing access to the system or performing assigned duties, when required by system changes, and on an organization-defined frequency thereafter.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires training program
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires training program
                </div>
            </div>

            <div class="practice-card not-covered">
                <span class="practice-id">AT.L2-3.2.2</span>
                <div class="practice-title">Insider threat awareness</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] roles and responsibilities of users are defined;</li>
                        <li>[b] security-related skills and proficiencies required to perform assigned roles and responsibilities are identified;</li>
                        <li>[c] role-based security-related training is provided to defined roles; and</li>
                        <li>[d] role-based security-related training is provided before authorizing access to the system or performing assigned duties, when required by system changes, and on an organization-defined frequency thereafter.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires training program
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires training program
                </div>
            </div>

            <div class="practice-card not-covered">
                <span class="practice-id">AT.L2-3.2.3</span>
                <div class="practice-title">Role-based security training</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] insider threat indicators are identified;</li>
                        <li>[b] security awareness training on insider threat indicators is provided; and</li>
                        <li>[c] security awareness training on insider threat indicators is provided on an organization-defined frequency.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires training program
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires training program
                </div>
            </div>

<h3 class="domain-title">Configuration Mgmt - 7/9 Covered</h3>

            <div class="practice-card covered">
                <span class="practice-id">CM.L2-3.4.1</span>
                <div class="practice-title">Establish baseline configurations</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] current baseline configurations are maintained for the system;</li>
                        <li>[b] current baseline configurations are reviewed and updated with an organization-defined frequency; and</li>
                        <li>[c] current baseline configurations are reviewed and updated as required in accordance with the organization-defined circumstances.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Microsoft Defender for Endpoint behavioral monitoring. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Microsoft Defender EDR
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">CM.L2-3.4.2</span>
                <div class="practice-title">Establish security configuration settings</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] configuration settings for the information technology products employed within the system are established and documented;</li>
                        <li>[b] the configuration settings for the information technology products employed within the system are implemented;</li>
                        <li>[c] departures from established configuration settings are identified and documented; and</li>
                        <li>[d] the organization's established and documented configuration settings or approved deviations are enforced for the information technology products employed within the system.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Microsoft Defender for Endpoint behavioral monitoring. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Microsoft Defender EDR, Syslog
                </div>
            </div>

            <div class="practice-card not-covered">
                <span class="practice-id">CM.L2-3.4.3</span>
                <div class="practice-title">Track and document configuration changes</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] the types of system changes that are configuration-controlled are defined;</li>
                        <li>[b] configuration-controlled system changes are tracked;</li>
                        <li>[c] security impact analyses are conducted before implementing configuration-controlled system changes to the system; and</li>
                        <li>[d] approval for changes to the system are tracked.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires CM tool
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires CM tool
                </div>
            </div>

            <div class="practice-card not-covered">
                <span class="practice-id">CM.L2-3.4.4</span>
                <div class="practice-title">Analyze security impact of changes</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] security impact analyses are conducted to assess the potential security impacts prior to implementing changes to the system; and</li>
                        <li>[b] configuration-controlled system changes to the system are only implemented with management approval of security impact analyses.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires CM process
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires CM process
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">CM.L2-3.4.5</span>
                <div class="practice-title">Define and document restrictions</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] individuals or groups that define physical and logical access restrictions associated with changes to the system are identified;</li>
                        <li>[b] physical access restrictions associated with changes to the system are defined; </li>
                        <li>[c] logical access restrictions associated with changes to the system are defined;</li>
                        <li>[d] physical access restrictions associated with changes to the system are enforced; and</li>
                        <li>[e] logical access restrictions associated with changes to the system are enforced.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Windows Event Logs collected centrally. Microsoft Defender for Endpoint behavioral monitoring. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Windows, Syslog, Microsoft Defender EDR
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">CM.L2-3.4.6</span>
                <div class="practice-title">Employ least functionality</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] essential capabilities that must be provided by the system are identified;</li>
                        <li>[b] the system is configured to provide only the identified essential capabilities; and</li>
                        <li>[c] prohibited or restricted functions, ports, protocols, and services are identified.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Network flow monitoring via Graylog NetFlow. Microsoft Defender for Endpoint behavioral monitoring. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Microsoft Defender EDR, NetFlow
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">CM.L2-3.4.7</span>
                <div class="practice-title">Restrict software installation</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] functions that are unnecessary are identified;</li>
                        <li>[b] ports that are unnecessary are identified;</li>
                        <li>[c] protocols that are unnecessary are identified;</li>
                        <li>[d] services that are unnecessary are identified;</li>
                        <li>[e] unnecessary functions are prohibited or restricted;</li>
                        <li>[f] unnecessary ports are prohibited or restricted;</li>
                        <li>[g] unnecessary protocols are prohibited or restricted; and</li>
                        <li>[h] unnecessary services are prohibited or restricted.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Microsoft Defender for Endpoint behavioral monitoring. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Microsoft Defender EDR
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">CM.L2-3.4.8</span>
                <div class="practice-title">Apply deny-by-exception policy</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] a policy to control the use of, and procedures for the use of, application execution policies is defined;</li>
                        <li>[b] rules that identify software programs that are allowed to execute on the system are defined;</li>
                        <li>[c] rules that identify software programs that are not allowed to execute on the system are defined; and</li>
                        <li>[d] the policy and procedures for application execution policies that control the execution of software programs are enforced.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Network flow monitoring via Graylog NetFlow. Microsoft Defender for Endpoint behavioral monitoring. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Microsoft Defender EDR, NetFlow
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">CM.L2-3.4.9</span>
                <div class="practice-title">Control and monitor user-installed software</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] software programs that users are not permitted to install without privileged status are defined; and</li>
                        <li>[b] the installation of organization-defined software programs by users is governed by an explicit policy.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Microsoft Defender for Endpoint behavioral monitoring. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Microsoft Defender EDR
                </div>
            </div>

<h3 class="domain-title">Identification & Auth - 10/11 Covered</h3>

            <div class="practice-card covered">
                <span class="practice-id">IA.L2-3.5.1</span>
                <div class="practice-title">Identify system users</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] system users are identified; and</li>
                        <li>[b] system users are uniquely identified.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Omnissa Horizon VDI logging configured. Azure Active Directory authentication and audit logs. Windows Event Logs collected centrally. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> AAD, VDI, Windows, Syslog
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">IA.L2-3.5.10</span>
                <div class="practice-title">Obscure feedback during authentication</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] passwords are protected through cryptographic mechanisms during transmission; and</li>
                        <li>[b] passwords are protected through cryptographic mechanisms during storage.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Omnissa Horizon VDI logging configured. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> VDI, UAG logs
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">IA.L2-3.5.11</span>
                <div class="practice-title">Manage authenticator lifecycle</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] authentication feedback information is obscured during the authentication process.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Azure Active Directory authentication and audit logs. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> AAD logs
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">IA.L2-3.5.2</span>
                <div class="practice-title">Authenticate users and devices</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] system users are authenticated; and</li>
                        <li>[b] devices are authenticated before establishing a connection.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Omnissa Horizon VDI logging configured. Azure Active Directory authentication and audit logs. Windows Event Logs collected centrally. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> AAD, VDI, Windows, Syslog
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">IA.L2-3.5.3</span>
                <div class="practice-title">Use MFA for network access</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] multifactor authentication is implemented for local access to privileged accounts;</li>
                        <li>[b] multifactor authentication is implemented for local access to non-privileged accounts;</li>
                        <li>[c] multifactor authentication is implemented for network access to privileged accounts; and</li>
                        <li>[d] multifactor authentication is implemented for network access to non-privileged accounts.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Azure Active Directory authentication and audit logs. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> AAD, UAG
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">IA.L2-3.5.4</span>
                <div class="practice-title">Replay-resistant authentication</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Employ replay-resistant authentication mechanisms for network access to privileged and non-privileged accounts.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] authentication methods are replay resistant.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Active Directory implements Kerberos v5 authentication protocol which provides replay resistance through the use of timestamps and ticket lifetimes. Group Policy Objects (GPO) enforce Kerberos authentication settings including maximum ticket lifetime (10 hours), maximum renewal age (7 days), and clock synchronization requirements. All domain-joined systems use Kerberos for authentication to domain resources. TLS 1.2+ with session tickets provides replay resistance for web-based authentication. Azure AD uses OAuth 2.0 and OpenID Connect with nonce values and short-lived tokens for replay protection in Microsoft 365 GCC High. Replay attacks are detected through timestamp validation and logged in Windows Security event logs.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Active Directory Kerberos configuration, Group Policy Objects, Windows Security logs, Azure AD authentication logs
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">IA.L2-3.5.5</span>
                <div class="practice-title">Prevent password reuse</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] a time period of inactivity after which an identifier is disabled is defined; and</li>
                        <li>[b] identifiers that have been inactive for the organization-defined time period are disabled.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Azure Active Directory authentication and audit logs. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> AAD policy logs
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">IA.L2-3.5.6</span>
                <div class="practice-title">Enforce minimum password complexity</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] authenticators for users who have left the organization or are reassigned are disabled on an organization-defined time period; and</li>
                        <li>[b] authenticators for users who have left the organization or are reassigned are revoked on an organization-defined time period.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Azure Active Directory authentication and audit logs. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> AAD policy logs
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">IA.L2-3.5.7</span>
                <div class="practice-title">Prohibit password reuse</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] password complexity is enforced through minimum password complexity requirements; and</li>
                        <li>[b] minimum password complexity requirements include a minimum password length.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Azure Active Directory authentication and audit logs. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> AAD policy logs
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">IA.L2-3.5.8</span>
                <div class="practice-title">Allow temporary password for system logon</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] a limit to the number of times that a password can be reused is defined; and</li>
                        <li>[b] password reuse is prohibited during the organization-defined number of generations.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Azure Active Directory authentication and audit logs. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> AAD logs
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">IA.L2-3.5.9</span>
                <div class="practice-title">Store and transmit passwords securely</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] system-generated temporary passwords are changed to permanent passwords at first use; and</li>
                        <li>[b] user-defined temporary passwords are changed to permanent passwords at first use.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Omnissa Horizon VDI logging configured. Azure Active Directory authentication and audit logs. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> VDI, AAD
                </div>
            </div>

<h3 class="domain-title">Incident Response - 3/3 Covered</h3>

            <div class="practice-card covered">
                <span class="practice-id">IR.L2-3.6.1</span>
                <div class="practice-title">Establish incident handling capability</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] security incidents are tracked, documented, and reported through an incident response capability;</li>
                        <li>[b] security incidents are tracked, documented, and reported through an incident handling capability;</li>
                        <li>[c] the incident response capability employs organization-defined processes; and</li>
                        <li>[d] the incident handling capability employs organization-defined processes.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Implemented via: All sources + alerts
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> All sources + alerts
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">IR.L2-3.6.2</span>
                <div class="practice-title">Track and document incidents</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] events that qualify as security incidents are defined;</li>
                        <li>[b] a reporting requirement is established for incidents;</li>
                        <li>[c] security incidents are reported in accordance with the reporting requirement; and</li>
                        <li>[d] incident information is reported to organization-defined authorities.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Graylog SIEM aggregation and analysis. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Graylog + ticketing
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">IR.L2-3.6.3</span>
                <div class="practice-title">Test incident response capability</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] the incident response capability is tested at an organization-defined frequency; and</li>
                        <li>[b] the incident response capability is tested using organization-defined tests.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Implemented via: Log data for tabletops
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Log data for tabletops
                </div>
            </div>

<h3 class="domain-title">Maintenance - 0/3 Covered</h3>

            <div class="practice-card not-covered">
                <span class="practice-id">MA.L2-3.7.1</span>
                <div class="practice-title">Perform maintenance on systems</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] scheduled maintenance on the system is performed;</li>
                        <li>[b] unscheduled maintenance on the system is performed; and</li>
                        <li>[c] scheduled and unscheduled system maintenance is documented.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires maintenance process
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires maintenance process
                </div>
            </div>

            <div class="practice-card not-covered">
                <span class="practice-id">MA.L2-3.7.2</span>
                <div class="practice-title">Control nonlocal maintenance</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] controls for system maintenance in association with maintenance tools (local or non-local) are approved;</li>
                        <li>[b] controls for system maintenance in association with maintenance tools (local or non-local) are monitored;</li>
                        <li>[c] controls for system maintenance in association with maintenance tools (local or non-local) are controlled; and</li>
                        <li>[d] maintenance personnel are required to explicitly approve each maintenance session.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires maintenance process
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires maintenance process
                </div>
            </div>

            <div class="practice-card not-covered">
                <span class="practice-id">MA.L2-3.7.5</span>
                <div class="practice-title">Require MFA for nonlocal maintenance</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] remote maintenance of the system requires approval;</li>
                        <li>[b] remote maintenance of the system requires logging;</li>
                        <li>[c] remote maintenance of the system requires the use of multifactor authentication that is replay resistant; and</li>
                        <li>[d] strong identification for remote maintenance is enforced.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Policy requirement
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Policy requirement
                </div>
            </div>

<h3 class="domain-title">Media Protection - 0/3 Covered</h3>

            <div class="practice-card not-covered">
                <span class="practice-id">MP.L2-3.8.1</span>
                <div class="practice-title">Protect system media</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] media containing CUI is identified;</li>
                        <li>[b] media is protected in accordance with the security category or classification of the information on the media; and</li>
                        <li>[c] media is protected in a manner commensurate with the security category or classification of the information on the media.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires media handling
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires media handling
                </div>
            </div>

            <div class="practice-card not-covered">
                <span class="practice-id">MP.L2-3.8.2</span>
                <div class="practice-title">Limit access to CUI on system media</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] access to media is restricted to authorized users; and</li>
                        <li>[b] system media sanitization actions are logged and includes the identity of the user.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires media controls
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires media controls
                </div>
            </div>

            <div class="practice-card not-covered">
                <span class="practice-id">MP.L2-3.8.3</span>
                <div class="practice-title">Sanitize system media</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] system media that requires disposal is identified;</li>
                        <li>[b] a system media sanitization process is implemented; and</li>
                        <li>[c] system media is sanitized before disposal.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires sanitization
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires sanitization
                </div>
            </div>

<h3 class="domain-title">Personnel Security - 0/2 Covered</h3>

            <div class="practice-card not-covered">
                <span class="practice-id">PS.L2-3.9.1</span>
                <div class="practice-title">Screen individuals</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] individuals are screened prior to authorizing access to the system; and</li>
                        <li>[b] individuals are screened prior to authorizing access to CUI.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires HR process
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires HR process
                </div>
            </div>

            <div class="practice-card not-covered">
                <span class="practice-id">PS.L2-3.9.2</span>
                <div class="practice-title">Ensure CUI protection during personnel actions</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] requirements for personnel actions (e.g., transfer, termination) are defined;</li>
                        <li>[b] transfer actions of individuals are carried out;</li>
                        <li>[c] termination actions of individuals are carried out; and</li>
                        <li>[d] the organization-defined requirements for personnel transfer and termination actions are followed when transfer and termination actions occur.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires HR process
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires HR process
                </div>
            </div>

<h3 class="domain-title">Physical Protection - 0/3 Covered</h3>

            <div class="practice-card not-covered">
                <span class="practice-id">PE.L2-3.10.1</span>
                <div class="practice-title">Limit physical access</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] physical access authorizations are managed;</li>
                        <li>[b] physical access to facilities is limited to authorized users; and</li>
                        <li>[c] physical access to information systems is limited to authorized users.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires physical security
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires physical security
                </div>
            </div>

            <div class="practice-card not-covered">
                <span class="practice-id">PE.L2-3.10.3</span>
                <div class="practice-title">Escort visitors</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] visitors to facilities where the system resides are authorized before granting access;</li>
                        <li>[b] visitors to facilities where the system resides are escorted; and</li>
                        <li>[c] visitor access records to the facility where the system resides are maintained.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires visitor management
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires visitor management
                </div>
            </div>

            <div class="practice-card not-covered">
                <span class="practice-id">PE.L2-3.10.4</span>
                <div class="practice-title">Maintain physical access audit logs</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] physical access logs are maintained for facilities where the system resides;</li>
                        <li>[b] physical access logs are reviewed with an organization-defined frequency; and</li>
                        <li>[c] physical access logs are retained for an organization-defined time period.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires badge system
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires badge system
                </div>
            </div>

<h3 class="domain-title">Risk Assessment - 0/3 Covered</h3>

            <div class="practice-card not-covered">
                <span class="practice-id">RA.L2-3.11.1</span>
                <div class="practice-title">Perform risk assessments</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] risk assessments are conducted periodically that identify threats to, vulnerabilities in, likelihood of and impact to organizational operations and assets, individuals, other organizations, and the Nation;</li>
                        <li>[b] threats identified by the risk assessments are documented;</li>
                        <li>[c] vulnerabilities identified by the risk assessments are documented;</li>
                        <li>[d] likelihood identified by the risk assessments is documented;</li>
                        <li>[e] impact identified by the risk assessments is documented;</li>
                        <li>[f] risk assessment results are documented and disseminated; and</li>
                        <li>[g] risk assessments are updated with an organization-defined frequency or when there are significant changes to the system, the environment of operation, or other conditions that may impact the security or privacy of the system.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires RA process
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires RA process
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">RA.L2-3.11.2</span>
                <div class="practice-title">Scan for vulnerabilities</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Scan for vulnerabilities in organizational systems and applications periodically and when new vulnerabilities affecting the systems are identified.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] vulnerability scans are performed with an organization-defined frequency; and</li>
                        <li>[b] vulnerability scans are performed randomly in accordance with the organization-defined process when new vulnerabilities potentially affecting the system are identified and reported.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Vulnerability scanning implemented using Security Content Automation Protocol (SCAP) compliant tools following NSA Horizon AI guidance for DIB organizations. Authenticated vulnerability scans performed monthly on all systems within the CUI boundary including VDI infrastructure, domain controllers, file servers, and security appliances. Microsoft Defender Vulnerability Management provides continuous vulnerability assessment for endpoints. Ad-hoc scans triggered when new critical vulnerabilities are announced (e.g., via CISA alerts). Scan results reviewed within 5 business days and remediation tracked through POA&M process. Reference: NSA Cybersecurity Collaboration Center - DIB Cybersecurity Services (https://www.nsa.gov/About/Cybersecurity-Collaboration-Center/DIB-Cybersecurity-Services/).
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> SCAP scan reports, Microsoft Defender Vulnerability Management, NSA Horizon AI guidance implementation, Remediation tracking logs
                </div>
            </div>

            <div class="practice-card not-covered">
                <span class="practice-id">RA.L2-3.11.3</span>
                <div class="practice-title">Remediate vulnerabilities</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] identified vulnerabilities are remediated or documented with risk acceptance; and</li>
                        <li>[b] identified vulnerabilities are remediated or documented in accordance with organizational risk assessment.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires patch mgmt
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires patch mgmt
                </div>
            </div>

<h3 class="domain-title">Security Assessment - 0/3 Covered</h3>

            <div class="practice-card not-covered">
                <span class="practice-id">CA.L2-3.12.1</span>
                <div class="practice-title">Assess security controls</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] a process for conducting security control assessments is developed;</li>
                        <li>[b] security control assessments are conducted periodically to assess the effectiveness of the controls;</li>
                        <li>[c] an action plan is developed to correct security control assessment deficiencies; and</li>
                        <li>[d] deficiencies are corrected.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires assessment process
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires assessment process
                </div>
            </div>

            <div class="practice-card not-covered">
                <span class="practice-id">CA.L2-3.12.2</span>
                <div class="practice-title">Develop plans of action</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] an operational plan of action is developed and implemented;</li>
                        <li>[b] the operational plan of action documents known system vulnerabilities;</li>
                        <li>[c] the operational plan of action documents known system security deficiencies;</li>
                        <li>[d] the operational plan of action documents planned remediation actions; and</li>
                        <li>[e] progress on remediation actions in the operational plan of action is monitored at an organization-defined frequency.</li>
                    </ul>
                </div>
                <div class="implementation not-implemented">
                    <div class="implementation-title">Implementation Details:</div>
                    <strong style='color: #991b1b;'>NOT IMPLEMENTED:</strong> Requires POA&M process
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Requires POA&M process
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">CA.L2-3.12.4</span>
                <div class="practice-title">Develop and maintain system security plan</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Develop, document, and periodically update system security plans that describe system boundaries, system environments of operation, how security requirements are implemented, and the relationships with or connections to other systems.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] a system security plan is developed that describes the system boundary; and</li>
                        <li>[b] a system security plan is developed that provides an overview of the security requirements for the system and a description of the security controls in place or planned for meeting those requirements, including a rationale for any tailoring decisions.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    This document serves as the System Security Plan (SSP) for the CUI processing environment. The SSP describes the system boundary encompassing the Omnissa Horizon VDI environment, Microsoft 365 GCC High tenant, on-premises infrastructure, and supporting security systems. System architecture and environment of operation are documented including network segmentation, access controls, and data flows. Security requirements mapped to CMMC Level 2 practices with implementation details for each control. SSP development follows NSA Horizon AI guidance for DIB cybersecurity. Reference: NSA Cybersecurity Collaboration Center - DIB Cybersecurity Services (https://www.nsa.gov/About/Cybersecurity-Collaboration-Center/DIB-Cybersecurity-Services/). SSP reviewed and updated annually and upon significant system changes.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> This System Security Plan (SSP), NSA Horizon AI guidance, Network diagrams, System inventory
                </div>
            </div>

<h3 class="domain-title">System & Comm Protection - 12/12 Covered</h3>

            <div class="practice-card covered">
                <span class="practice-id">SC.L2-3.13.1</span>
                <div class="practice-title">Monitor communications at system boundaries</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] connections from the system to other information systems are monitored; and</li>
                        <li>[b] connections from the system to other information systems are controlled.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Network flow monitoring via Graylog NetFlow. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> NetFlow, Firewall
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SC.L2-3.13.11</span>
                <div class="practice-title">Employ FIPS-validated cryptography</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] cryptographic mechanisms are implemented to prevent unauthorized disclosure of CUI at rest.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Implemented via: UAG TLS logs
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> UAG TLS logs
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SC.L2-3.13.12</span>
                <div class="practice-title">Prohibit remote activation</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] collaborative computing devices are managed, which includes disabling collaborative computing devices in a manner that prevents inadvertent activation.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Windows Event Logs collected centrally. Network flow monitoring via Graylog NetFlow. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> NetFlow, Windows, Syslog
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SC.L2-3.13.13</span>
                <div class="practice-title">Control split tunneling</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] mobile code use is controlled;</li>
                        <li>[b] mobile code use is authorized; and</li>
                        <li>[c] mobile code technologies are controlled and monitored.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Network flow monitoring via Graylog NetFlow. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> NetFlow, UAG
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SC.L2-3.13.14</span>
                <div class="practice-title">Control mobile code</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] Voice over Internet Protocol (VoIP) technologies are controlled;</li>
                        <li>[b] Voice over Internet Protocol (VoIP) technologies are authorized; and</li>
                        <li>[c] Voice over Internet Protocol (VoIP) technologies are monitored.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Microsoft Defender for Endpoint behavioral monitoring. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Microsoft Defender EDR
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SC.L2-3.13.15</span>
                <div class="practice-title">Control Voice over IP</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] the authenticity of communications sessions is protected.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Network flow monitoring via Graylog NetFlow. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> NetFlow
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SC.L2-3.13.16</span>
                <div class="practice-title">Protect CUI at rest</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] the confidentiality of CUI at rest is protected.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Omnissa Horizon VDI logging configured. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> VDI monitoring
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SC.L2-3.13.2</span>
                <div class="practice-title">Employ architectural designs</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Employ architectural designs, software development techniques, and systems engineering principles that promote effective information security within organizational systems.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] security engineering principles are applied in the specification of the system; and</li>
                        <li>[b] security engineering principles are applied in the design, development, implementation, and modification of the system.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Security engineering principles documented in this System Security Plan (SSP). The SSP describes the application of defense-in-depth, least privilege, separation of duties, and secure configuration principles throughout the system architecture. Network segmentation, encrypted communications, multifactor authentication, and continuous monitoring are incorporated in the system design. Changes to system architecture require security impact analysis as documented in the change management process. The SSP is reviewed and updated annually or when significant system changes occur.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> System Security Plan (SSP), Network diagrams, Change management documentation
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SC.L2-3.13.3</span>
                <div class="practice-title">Separate user and system functionality</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Separate user functionality from system management functionality.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] security functions are separated from nonsecurity functions.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Network segregation implemented using VLANs to separate user workspaces from system management functions. Dedicated management network established for administrative access to infrastructure components including Active Directory domain controllers, Omnissa vCenter, ESXi hosts, and security appliances. User VDI sessions operate on separate network segments from management interfaces. Administrative functions require privileged credentials and access through the management network only. All management traffic is logged and monitored separately.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Network diagrams, VLAN configs, Firewall rules, AD Group Policy
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SC.L2-3.13.5</span>
                <div class="practice-title">Separate public-access systems</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Logically separate public-access system components from internal organizational networks.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] publicly accessible system components are identified;</li>
                        <li>[b] publicly accessible system components are logically separated from internal organizational networks; and</li>
                        <li>[c] network connections between components of the public access information system and organizational information systems that are not publicly accessible are prevented.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Omnissa Unified Access Gateway (UAG) provides secure external access to the VDI environment using FIPS 140-2 validated cryptographic modules. All external traffic is routed through port 443 (HTTPS) only, ensuring encryption in transit. UAG is deployed in a DMZ and provides logical separation between publicly accessible components and internal CUI networks. No direct network connections exist between public-facing systems and internal CUI processing systems.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> UAG config, Firewall rules, FIPS validation certificates
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SC.L2-3.13.6</span>
                <div class="practice-title">Deny by default network traffic</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] default deny network communications policies are defined;</li>
                        <li>[b] network communications traffic is controlled by default deny policies at managed interfaces; and</li>
                        <li>[c] exceptions to the default deny policies are explicitly allowed.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Network flow monitoring via Graylog NetFlow. Microsoft Defender for Endpoint behavioral monitoring. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> NetFlow, Microsoft Defender EDR
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SC.L2-3.13.8</span>
                <div class="practice-title">Implement cryptographic mechanisms for data in transit</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Implement cryptographic mechanisms to prevent unauthorized disclosure of CUI during transmission unless otherwise protected by alternative physical safeguards.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] cryptographic mechanisms are implemented to prevent unauthorized disclosure of CUI during transmission.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    All CUI transmission is encrypted using FIPS 140-2 validated cryptographic modules. Omnissa Unified Access Gateway (UAG) enforces TLS 1.2 or higher for all remote access sessions to the VDI environment. Microsoft 365 GCC High implements TLS 1.2+ for all email and file transmission. Internal network traffic between CUI systems uses encryption for sensitive data transfers. VPN connections require FIPS-validated IPsec or TLS encryption. All web-based applications serving CUI enforce HTTPS with strong cipher suites. Unencrypted protocols (HTTP, FTP, Telnet) are disabled on all systems processing CUI.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> UAG TLS configuration, O365 GCC High TLS logs, VPN configs, Network traffic analysis, FIPS validation certificates
                </div>
            </div>

<h3 class="domain-title">System & Info Integrity - 9/9 Covered</h3>

            <div class="practice-card covered">
                <span class="practice-id">SI.L2-3.14.1</span>
                <div class="practice-title">Identify and report system flaws</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] security-relevant software updates are identified;</li>
                        <li>[b] security-relevant firmware updates are identified;</li>
                        <li>[c] security-relevant software updates are installed within an organization-defined time period of the release of the updates; and</li>
                        <li>[d] security-relevant firmware updates are installed within an organization-defined time period of the release of the updates.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Windows Event Logs collected centrally. Microsoft Defender for Endpoint behavioral monitoring. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Microsoft Defender EDR, Windows, Syslog
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SI.L2-3.14.2</span>
                <div class="practice-title">Provide malicious code protection</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] malicious code protection mechanisms are implemented at system entry and exit points;</li>
                        <li>[b] malicious code protection mechanisms are employed to detect malicious code; and</li>
                        <li>[c] malicious code protection mechanisms are employed to eradicate malicious code.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Microsoft Defender for Endpoint behavioral monitoring. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Microsoft Defender EDR
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SI.L2-3.14.3</span>
                <div class="practice-title">Monitor system security alerts</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] security alerts and advisories are received on an ongoing basis;</li>
                        <li>[b] security alerts and advisories are generated internally;</li>
                        <li>[c] security alerts and advisories are disseminated; and</li>
                        <li>[d] security directives are implemented in accordance with established time frames, or the issuing organization is notified of the degree of noncompliance.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Windows Event Logs collected centrally. Microsoft Defender for Endpoint behavioral monitoring. Graylog SIEM aggregation and analysis. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Microsoft Defender EDR, Windows, Graylog
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SI.L2-3.14.4</span>
                <div class="practice-title">Update malicious code protection</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] the system is configured so that malicious code protection mechanisms perform periodic scans; and</li>
                        <li>[b] the system is configured so that malicious code protection mechanisms perform real-time scans of files from external sources at endpoints and network entry and exit points as the files are downloaded, opened, or executed.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Omnissa Horizon VDI logging configured. Microsoft Defender for Endpoint behavioral monitoring. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Microsoft Defender EDR, VDI
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SI.L2-3.14.5</span>
                <div class="practice-title">Perform periodic scans</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] the system is configured so that security alert and malicious code detection tools and techniques are employed to monitor and analyze the behavior of organizational systems and hosted applications; and</li>
                        <li>[b] the system is configured so that security alert and malicious code detection tools and techniques are employed to identify potentially suspicious, abnormal, or anomalous activity.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Omnissa Horizon VDI logging configured. Microsoft Defender for Endpoint behavioral monitoring. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Microsoft Defender EDR, VDI
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SI.L2-3.14.6</span>
                <div class="practice-title">Monitor communications for attacks</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] system communications are monitored for attacks and indicators of potential attacks; and</li>
                        <li>[b] inbound and outbound communications traffic are monitored for unusual or unauthorized activities or conditions.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Windows Event Logs collected centrally. Network flow monitoring via Graylog NetFlow. Microsoft Defender for Endpoint behavioral monitoring. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> NetFlow, Windows, Microsoft Defender EDR
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SI.L2-3.14.7</span>
                <div class="practice-title">Identify unauthorized use</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> CMMC requirement statement.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] unauthorized use of the system is identified; and</li>
                        <li>[b] unauthorized use of the system is monitored.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Windows Event Logs collected centrally. Network flow monitoring via Graylog NetFlow. Microsoft Defender for Endpoint behavioral monitoring. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> NetFlow, Windows, Microsoft Defender EDR
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SI.L2-3.14.8</span>
                <div class="practice-title">Perform information input validation</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Check the validity of information inputs.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] NOTE: This practice does not exist in official CMMC Level 2 (110 practices). The following objectives are based on NIST SP 800-53 SI-10:</li>
                        <li>[b] the types of information inputs requiring validity checks are defined;</li>
                        <li>[c] validity checks are implemented for defined information inputs; and</li>
                        <li>[d] information inputs are checked for accuracy, completeness, validity, and authenticity.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Input validation implemented following NSA's Horizon AI cybersecurity guidance for Defense Industrial Base (DIB) organizations. Omnissa Horizon environment configured with input validation controls at the VDI gateway level. Session validation ensures only properly authenticated connections are established. Application-level input validation implemented through secure development practices for custom applications accessing CUI. Reference: NSA Cybersecurity Collaboration Center - DIB Cybersecurity Services (https://www.nsa.gov/About/Cybersecurity-Collaboration-Center/DIB-Cybersecurity-Services/).
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Omnissa Horizon configs, NSA Horizon AI guidance implementation, Application security documentation
                </div>
            </div>

            <div class="practice-card covered">
                <span class="practice-id">SI.L2-3.14.9</span>
                <div class="practice-title">Manage information output</div>
                <div class="practice-statement">
                    <strong>Requirement:</strong> Handle and retain information output from the system in accordance with applicable laws, policies, and regulations.
                </div>
                <div>
                    <strong>Assessment Objectives:</strong>
                    <ul class="objectives-list">
                        <li>[a] NOTE: This practice does not exist in official CMMC Level 2 (110 practices). The following objectives are based on related NIST controls:</li>
                        <li>[b] requirements for handling and retaining information output are defined;</li>
                        <li>[c] information output handling requirements are based on applicable laws, executive orders, directives, regulations, policies, standards, and operational requirements;</li>
                        <li>[d] controls are implemented to manage information output in accordance with defined requirements; and</li>
                        <li>[e] information output is handled and retained in accordance with applicable laws, policies, and regulations.</li>
                    </ul>
                </div>
                <div class="implementation ">
                    <div class="implementation-title">Implementation Details:</div>
                    Microsoft Purview DLP policies enforced. All events retained for 2+ years per CMMC requirements.
                </div>
                <div class="log-sources">
                    <strong>Evidence Sources:</strong> Purview DLP
                </div>
            </div>

        </div>
        </div>

        <div id="architecture" class="tab-content">
            <div class="info-box info-purple">
                <h3 style="font-weight: bold; margin-bottom: 0.5rem;">📊 Network Architecture Visualization</h3>
                <p style="font-size: 0.875rem;">
                    Visual representation of the CMMC boundary, VLANs, and system interconnections with updated DMZ configuration.
                </p>
            </div>

            <div style="margin-bottom: 2rem;">
                <h3 style="color: #1e40af; margin-bottom: 1rem;">Network Architecture Overview</h3>
                <p style="margin-bottom: 1.5rem; color: #4b5563;">
                    The CUI processing environment utilizes a segmented network architecture with dedicated VLANs for different security zones. Remote access is provided through a UAG (Unified Access Gateway) positioned in a DMZ (VLAN 44) directly connected to the network firewall, ensuring proper isolation before reaching internal systems. The environment is managed through a centralized gateway with comprehensive logging and monitoring.
                </p>
                
                <!-- Network Diagram SVG -->
                <div style="background: #f9fafb; padding: 2rem; border-radius: 8px; border: 2px solid #e5e7eb; margin: 2rem 0;">
                    <svg viewBox="0 0 1200 800" style="width: 100%; height: auto; max-width: 1200px; margin: 0 auto; display: block;">
                        <!-- Title -->
                        <text x="600" y="30" text-anchor="middle" style="font-size: 24px; font-weight: bold; fill: #1e40af;">CUI Processing Environment - Network Architecture</text>
                        
                        <!-- Internet Cloud -->
                        <ellipse cx="600" cy="100" rx="80" ry="40" fill="#dbeafe" stroke="#2563eb" stroke-width="2"/>
                        <text x="600" y="105" text-anchor="middle" style="font-size: 14px; font-weight: bold; fill: #1e40af;">Internet</text>
                        
                        <!-- Arrow to Gateway -->
                        <line x1="600" y1="140" x2="600" y2="180" stroke="#6b7280" stroke-width="2" marker-end="url(#arrowhead)"/>
                        
                        <!-- Gateway/Firewall -->
                        <rect x="500" y="180" width="200" height="80" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="3"/>
                        <text x="600" y="205" text-anchor="middle" style="font-size: 14px; font-weight: bold; fill: #92400e;">Gateway/Firewall</text>
                        <text x="600" y="225" text-anchor="middle" style="font-size: 12px; fill: #92400e;">Network Firewall</text>
                        <text x="600" y="242" text-anchor="middle" style="font-size: 11px; fill: #92400e;">NetFlow + Firewall</text>
                        <text x="600" y="256" text-anchor="middle" style="font-size: 10px; fill: #78350f;">Internet Connected</text>
                        
                        <!-- Management VLAN 99 -->
                        <rect x="50" y="180" width="180" height="80" rx="8" fill="#faf5ff" stroke="#9333ea" stroke-width="2"/>
                        <text x="140" y="205" text-anchor="middle" style="font-size: 13px; font-weight: bold; fill: #6b21a8;">Management</text>
                        <text x="140" y="222" text-anchor="middle" style="font-size="11px; fill: #6b21a8;">VLAN 99</text>
                        <text x="140" y="238" text-anchor="middle" style="font-size: 10px; fill: #6b21a8;">Admin Access Only</text>
                        <text x="140" y="253" text-anchor="middle" style="font-size: 9px; fill: #581c87;">X.Y.99.0/24</text>
                        
                        <!-- UAG External - DMZ VLAN 44 -->
                        <rect x="750" y="180" width="170" height="80" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="3"/>
                        <text x="835" y="203" text-anchor="middle" style="font-size: 13px; font-weight: bold; fill: #92400e;">UAG External</text>
                        <text x="835" y="220" text-anchor="middle" style="font-size: 11px; fill: #92400e;">DMZ (VLAN 44)</text>
                        <text x="835" y="236" text-anchor="middle" style="font-size: 10px; fill: #92400e;">Remote Access</text>
                        <text x="835" y="252" text-anchor="middle" style="font-size: 9px; fill: #78350f;">X.Y.44.10</text>
                        
                        <!-- Central switching area -->
                        <rect x="400" y="320" width="400" height="60" rx="8" fill="#e0f2fe" stroke="#0284c7" stroke-width="2"/>
                        <text x="600" y="345" text-anchor="middle" style="font-size: 14px; font-weight: bold; fill: #0c4a6e;">Core Switch / Router</text>
                        <text x="600" y="365" text-anchor="middle" style="font-size: 11px; fill: #0c4a6e;">VLAN Segmentation & Routing</text>
                        
                        <!-- VLANs -->
                        <!-- VLAN 10 - VDI -->
                        <rect x="50" y="450" width="240" height="120" rx="8" fill="#dbeafe" stroke="#2563eb" stroke-width="3"/>
                        <text x="170" y="475" text-anchor="middle" style="font-size: 14px; font-weight: bold; fill: #1e40af;">VLAN 10 - VDI Users</text>
                        <text x="170" y="492" text-anchor="middle" style="font-size: 10px; fill: #1e40af;">X.Y.10.0/24</text>
                        <text x="170" y="515" text-anchor="middle" style="font-size: 11px; fill: #1e3a8a;">Omnissa Horizon</text>
                        <text x="170" y="532" text-anchor="middle" style="font-size: 10px; fill: #1e3a8a;">Virtual Desktops</text>
                        <text x="170" y="548" text-anchor="middle" style="font-size: 10px; fill: #1e3a8a;">User Workspaces</text>
                        <text x="170" y="563" text-anchor="middle" style="font-size: 9px; fill: #1e3a8a; font-weight: 600;">🔒 CUI Processing</text>
                        
                        <!-- VLAN 20 - Infrastructure -->
                        <rect x="330" y="450" width="240" height="120" rx="8" fill="#dcfce7" stroke="#059669" stroke-width="3"/>
                        <text x="450" y="475" text-anchor="middle" style="font-size: 14px; font-weight: bold; fill: #065f46;">VLAN 20 - Infrastructure</text>
                        <text x="450" y="492" text-anchor="middle" style="font-size: 10px; fill: #065f46;">X.Y.20.0/24</text>
                        <text x="450" y="515" text-anchor="middle" style="font-size: 11px; fill: #064e3b;">DC01, DC02 (AD)</text>
                        <text x="450" y="532" text-anchor="middle" style="font-size: 11px; fill: #064e3b;">LOG01 (Graylog SIEM)</text>
                        <text x="450" y="548" text-anchor="middle" style="font-size: 11px; fill: #064e3b;">LOG02 (AIP Scanner)</text>
                        <text x="450" y="563" text-anchor="middle" style="font-size: 9px; fill: #064e3b; font-weight: 600;">🔐 Core Services</text>
                        
                        <!-- VLAN 30 - File Storage -->
                        <rect x="610" y="450" width="240" height="120" rx="8" fill="#fce7f3" stroke="#be185d" stroke-width="3"/>
                        <text x="730" y="475" text-anchor="middle" style="font-size: 14px; font-weight: bold; fill: #831843;">VLAN 30 - File Storage</text>
                        <text x="730" y="492" text-anchor="middle" style="font-size: 10px; fill: #831843;">X.Y.30.0/24</text>
                        <text x="730" y="515" text-anchor="middle" style="font-size: 11px; fill: #831843;">FILE01</text>
                        <text x="730" y="532" text-anchor="middle" style="font-size: 10px; fill: #9f1239;">SMB File Shares</text>
                        <text x="730" y="548" text-anchor="middle" style="font-size: 10px; fill: #9f1239;">CUI Documents</text>
                        <text x="730" y="563" text-anchor="middle" style="font-size: 9px; fill: #9f1239; font-weight: 600;">📁 Data Storage</text>
                        
                        <!-- GCC High Cloud -->
                        <rect x="890" y="450" width="260" height="120" rx="8" fill="#f3f4f6" stroke="#4b5563" stroke-width="2" stroke-dasharray="5,5"/>
                        <text x="1020" y="475" text-anchor="middle" style="font-size: 14px; font-weight: bold; fill: #1f2937;">Microsoft 365 GCC High</text>
                        <text x="1020" y="492" text-anchor="middle" style="font-size: 9px; fill: #4b5563;">Azure Government Cloud</text>
                        <text x="1020" y="512" text-anchor="middle" style="font-size: 10px; fill: #374151;">• Azure AD</text>
                        <text x="1020" y="528" text-anchor="middle" style="font-size: 10px; fill: #374151;">• Defender for Endpoint</text>
                        <text x="1020" y="544" text-anchor="middle" style="font-size: 10px; fill: #374151;">• Purview DLP</text>
                        <text x="1020" y="560" text-anchor="middle" style="font-size: 10px; fill: #374151;">• Azure Log Analytics</text>
                        
                        <!-- Network Connections -->
                        <!-- Gateway to Core Switch -->
                        <line x1="600" y1="260" x2="600" y2="320" stroke="#6b7280" stroke-width="3"/>
                        
                        <!-- Gateway DMZ Port to UAG External -->
                        <line x1="700" y1="220" x2="750" y2="220" stroke="#f59e0b" stroke-width="3"/>
                        <text x="725" y="210" text-anchor="middle" style="font-size: 9px; fill: #92400e;">DMZ</text>
                        
                        <!-- Core Switch to VLANs -->
                        <line x1="450" y1="380" x2="170" y2="450" stroke="#2563eb" stroke-width="2"/>
                        <line x1="550" y1="380" x2="450" y2="450" stroke="#059669" stroke-width="2"/>
                        <line x1="650" y1="380" x2="730" y2="450" stroke="#be185d" stroke-width="2"/>
                        
                        <!-- Management connections -->
                        <line x1="230" y1="220" x2="400" y2="340" stroke="#9333ea" stroke-width="1" stroke-dasharray="3,3"/>
                        
                        <!-- GCC High connection -->
                        <line x1="800" y1="350" x2="1020" y2="450" stroke="#4b5563" stroke-width="2" stroke-dasharray="5,5"/>
                        <text x="900" y="400" style="font-size: 10px; fill: #4b5563;">HTTPS/TLS</text>
                        
                        <!-- Logging flows -->
                        <text x="300" y="510" style="font-size: 9px; fill: #6b7280;">← Logs</text>
                        <text x="580" y="510" style="font-size: 9px; fill: #6b7280;">Logs →</text>
                        
                        <!-- Legend -->
                        <rect x="50" y="620" width="1100" height="150" rx="8" fill="white" stroke="#e5e7eb" stroke-width="2"/>
                        <text x="600" y="645" text-anchor="middle" style="font-size: 16px; font-weight: bold; fill: #1f2937;">Legend & Security Controls</text>
                        
                        <text x="80" y="675" style="font-size: 12px; fill: #1f2937; font-weight: 600;">Network Segmentation:</text>
                        <rect x="80" y="685" width="30" height="15" fill="#dbeafe" stroke="#2563eb" stroke-width="2"/>
                        <text x="115" y="697" style="font-size: 11px; fill: #374151;">VDI User Zone</text>
                        
                        <rect x="230" y="685" width="30" height="15" fill="#dcfce7" stroke="#059669" stroke-width="2"/>
                        <text x="265" y="697" style="font-size: 11px; fill: #374151;">Infrastructure Zone</text>
                        
                        <rect x="400" y="685" width="30" height="15" fill="#fce7f3" stroke="#be185d" stroke-width="2"/>
                        <text x="435" y="697" style="font-size: 11px; fill: #374151;">Storage Zone</text>
                        
                        <rect x="550" y="685" width="30" height="15" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
                        <text x="585" y="697" style="font-size: 11px; fill: #374151;">Gateway/DMZ</text>
                        
                        <text x="80" y="725" style="font-size: 12px; fill: #1f2937; font-weight: 600;">Security Controls:</text>
                        <text x="80" y="743" style="font-size: 11px; fill: #374151;">• Firewall rules between all VLANs</text>
                        <text x="80" y="758" style="font-size: 11px; fill: #374151;">• NetFlow monitoring on all interfaces</text>
                        
                        <text x="350" y="743" style="font-size: 11px; fill: #374151;">• UAG in isolated DMZ (VLAN 44)</text>
                        <text x="350" y="758" style="font-size: 11px; fill: #374151;">• 802.1X network authentication</text>
                        
                        <text x="650" y="743" style="font-size: 11px; fill: #374151;">• TLS 1.2+ for all remote access</text>
                        <text x="650" y="758" style="font-size: 11px; fill: #374151;">• 2-year log retention per CMMC</text>
                        
                        <!-- Arrow marker definition -->
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#6b7280" />
                            </marker>
                        </defs>
                    </svg>
                </div>
                
                <h3 style="color: #1e40af; margin: 2rem 0 1rem;">VLAN Allocation & Purpose</h3>
                <table style="width: 100%; border-collapse: collapse; margin-bottom: 2rem;">
                    <thead>
                        <tr style="background: #dbeafe; color: black;">
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid #2563eb; color: black; font-weight: 600;">VLAN ID</th>
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid #2563eb; color: black; font-weight: 600;">Network</th>
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid #2563eb; color: black; font-weight: 600;">Purpose</th>
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid #2563eb; color: black; font-weight: 600;">Key Systems</th>
                            <th style="padding: 0.75rem; text-align: left; border: 1px solid #2563eb; color: black; font-weight: 600;">Security Zone</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: #dbeafe;">
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-weight: 600;">VLAN 10</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-family: monospace;">X.Y.10.0/24</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">VDI User Desktops</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">Omnissa Horizon VMs, User Sessions</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;"><span style="background: #10b981; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">CUI Processing</span></td>
                        </tr>
                        <tr style="background: #dcfce7;">
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-weight: 600;">VLAN 20</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-family: monospace;">X.Y.20.0/24</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">Core Infrastructure</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">DC01, DC02, LOG01 (Graylog), LOG02 (AIP)</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;"><span style="background: #059669; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">Critical Services</span></td>
                        </tr>
                        <tr style="background: #fce7f3;">
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-weight: 600;">VLAN 30</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-family: monospace;">X.Y.30.0/24</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">File Storage</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">FILE01 (SMB Shares, CUI Documents)</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;"><span style="background: #be185d; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">Data Storage</span></td>
                        </tr>
                        
                        <tr style="background: #fef3c7;">
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-weight: 600;">VLAN 44</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-family: monospace;">X.Y.44.0/24</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">DMZ (Demilitarized Zone)</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">UAG External (Remote Access Gateway)</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;"><span style="background: #f59e0b; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">DMZ</span></td>
                        </tr>
                        <tr style="background: #faf5ff;">
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-weight: 600;">VLAN 99</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb; font-family: monospace;">X.Y.99.0/24</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">Management Network</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;">Admin Access to All Devices</td>
                            <td style="padding: 0.75rem; border: 1px solid #e5e7eb;"><span style="background: #9333ea; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">Management Only</span></td>
                        </tr>
                    </tbody>
                </table>
                
            </div>

            <h3 style="font-size: 1.25rem; font-weight: bold; margin: 2rem 0 1rem;">🔌 IP Ports and Protocols</h3>
            
            <div style="background: white; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); padding: 1.5rem; margin-bottom: 1.5rem;">
                <p style="font-size: 0.875rem; margin-bottom: 1rem; color: #6b7280;">
                    Network subnets: <strong>VLAN 10 (X.Y.10.0/24)</strong>, <strong>VLAN 20 (X.Y.20.0/24)</strong>, 
                    <strong>VLAN 30 (X.Y.30.0/24 - File Services)</strong>, 
                    <strong>VLAN 44 (X.Y.44.0/24 - DMZ)</strong>, 
                    <strong>VLAN 99 (X.Y.99.0/24 - Management)</strong>
                </p>
                
                <table style="width: 100%; border-collapse: collapse; font-size: 0.875rem;">
                    <thead>
                        <tr style="background: #f3f4f6; border-bottom: 2px solid #e5e7eb;">
                            <th style="padding: 0.75rem; text-align: left; font-weight: 600;">Source Zone</th>
                            <th style="padding: 0.75rem; text-align: left; font-weight: 600;">Destination Zone</th>
                            <th style="padding: 0.75rem; text-align: left; font-weight: 600;">Service/Purpose</th>
                            <th style="padding: 0.75rem; text-align: left; font-weight: 600;">Protocol</th>
                            <th style="padding: 0.75rem; text-align: left; font-weight: 600;">Port(s)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Internet to DMZ -->
                        <tr style="border-bottom: 1px solid #e5e7eb;">
                            <td style="padding: 0.75rem;">Internet</td>
                            <td style="padding: 0.75rem;">Gateway/Firewall (Internet)</td>
                            <td style="padding: 0.75rem;">UAG Remote Access</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">443 (HTTPS)</td>
                        </tr>
                        
                        <!-- DMZ to Internal VLANs -->
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #fef3c7;">
                            <td style="padding: 0.75rem;">Gateway/Firewall (Internet)</td>
                            <td style="padding: 0.75rem;">VLAN 10</td>
                            <td style="padding: 0.75rem;">VDI Connection (Horizon)</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">443, 8443, 4172</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #fef3c7;">
                            <td style="padding: 0.75rem;">Gateway/Firewall (Internet)</td>
                            <td style="padding: 0.75rem;">VLAN 20</td>
                            <td style="padding: 0.75rem;">Authentication (DC01, DC02)</td>
                            <td style="padding: 0.75rem;">TCP/UDP</td>
                            <td style="padding: 0.75rem;">88, 389, 636, 3268</td>
                        </tr>
                        
                        <!-- VLAN 10 to VLAN 20 -->
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #dbeafe;">
                            <td style="padding: 0.75rem;">VLAN 10 (Horizon)</td>
                            <td style="padding: 0.75rem;">VLAN 20</td>
                            <td style="padding: 0.75rem;">Authentication (DC01, DC02)</td>
                            <td style="padding: 0.75rem;">TCP/UDP</td>
                            <td style="padding: 0.75rem;">88, 389, 636, 3268, 53</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #dbeafe;">
                            <td style="padding: 0.75rem;">VLAN 10 (Horizon)</td>
                            <td style="padding: 0.75rem;">VLAN 20 (LOG01)</td>
                            <td style="padding: 0.75rem;">Syslog (Horizon)</td>
                            <td style="padding: 0.75rem;">UDP</td>
                            <td style="padding: 0.75rem;">514, 5140</td>
                        </tr>
                        
                        <!-- VLAN 30 to other VLANs (FILE01 access) -->
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #fce7f3;">
                            <td style="padding: 0.75rem;">VLAN 30 (FILE01)</td>
                            <td style="padding: 0.75rem;">VLAN 10 (Horizon)</td>
                            <td style="padding: 0.75rem;">File Services (SMB)</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">445, 135, 139</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #fce7f3;">
                            <td style="padding: 0.75rem;">VLAN 30 (FILE01)</td>
                            <td style="padding: 0.75rem;">VLAN 20 (LOG01, LOG02)</td>
                            <td style="padding: 0.75rem;">File Services (SMB)</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">445, 135, 139</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #fce7f3;">
                            <td style="padding: 0.75rem;">VLAN 30 (FILE01)</td>
                            <td style="padding: 0.75rem;">VLAN 20 (DC01, DC02)</td>
                            <td style="padding: 0.75rem;">Active Directory Services</td>
                            <td style="padding: 0.75rem;">TCP/UDP</td>
                            <td style="padding: 0.75rem;">53, 88, 135, 389, 445, 636, 3268, 3269</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #fce7f3;">
                            <td style="padding: 0.75rem;">VLAN 30 (FILE01)</td>
                            <td style="padding: 0.75rem;">VLAN 20 (LOG01)</td>
                            <td style="padding: 0.75rem;">Syslog Forwarding</td>
                            <td style="padding: 0.75rem;">UDP</td>
                            <td style="padding: 0.75rem;">5140</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #fce7f3;">
                            <td style="padding: 0.75rem;">VLAN 10 (Horizon)</td>
                            <td style="padding: 0.75rem;">VLAN 30 (FILE01)</td>
                            <td style="padding: 0.75rem;">File Access from VDI (SMB)</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">445, 135, 139</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #fce7f3;">
                            <td style="padding: 0.75rem;">VLAN 20 (LOG02)</td>
                            <td style="padding: 0.75rem;">VLAN 30 (FILE01)</td>
                            <td style="padding: 0.75rem;">AIP Scanner (File Scanning)</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">445</td>
                        </tr>
                        
                        <!-- VLAN 20 Internal Services -->
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #dcfce7;">
                            <td style="padding: 0.75rem;">VLAN 20 (All)</td>
                            <td style="padding: 0.75rem;">VLAN 20 (LOG01)</td>
                            <td style="padding: 0.75rem;">Syslog Logging</td>
                            <td style="padding: 0.75rem;">UDP</td>
                            <td style="padding: 0.75rem;">514, 5140</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #dcfce7;">
                            <td style="padding: 0.75rem;">VLAN 20 (DC, LOG02)</td>
                            <td style="padding: 0.75rem;">VLAN 20 (LOG01)</td>
                            <td style="padding: 0.75rem;">Windows Event Forwarding</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">5985, 5986 (WinRM)</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #dcfce7;">
                            <td style="padding: 0.75rem;">VLAN 20 (GW)</td>
                            <td style="padding: 0.75rem;">VLAN 20 (LOG01)</td>
                            <td style="padding: 0.75rem;">NetFlow Export</td>
                            <td style="padding: 0.75rem;">UDP</td>
                            <td style="padding: 0.75rem;">2055, 9995</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #dcfce7;">
                            <td style="padding: 0.75rem;">VLAN 20 (All Servers)</td>
                            <td style="padding: 0.75rem;">VLAN 20 (DC01, DC02)</td>
                            <td style="padding: 0.75rem;">Active Directory Services</td>
                            <td style="padding: 0.75rem;">TCP/UDP</td>
                            <td style="padding: 0.75rem;">53, 88, 135, 389, 445, 636, 3268, 3269</td>
                        </tr>
                        
                        <!-- GCC High Cloud Connectivity -->
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #e0f2fe;">
                            <td style="padding: 0.75rem;">VLAN 10, 20, 30</td>
                            <td style="padding: 0.75rem;">GCC High</td>
                            <td style="padding: 0.75rem;">Azure AD Authentication</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">443 (HTTPS)</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #e0f2fe;">
                            <td style="padding: 0.75rem;">VLAN 10, 20, 30</td>
                            <td style="padding: 0.75rem;">GCC High</td>
                            <td style="padding: 0.75rem;">Microsoft 365 Services</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">443 (HTTPS)</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #e0f2fe;">
                            <td style="padding: 0.75rem;">VLAN 20 (LOG01)</td>
                            <td style="padding: 0.75rem;">GCC High</td>
                            <td style="padding: 0.75rem;">Azure Log Analytics Export</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">443 (HTTPS)</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #e0f2fe;">
                            <td style="padding: 0.75rem;">VLAN 20 (LOG02)</td>
                            <td style="padding: 0.75rem;">GCC High</td>
                            <td style="padding: 0.75rem;">AIP Cloud Services</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">443 (HTTPS)</td>
                        </tr>
                        
                        <!-- Management VLAN 99 -->
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #faf5ff;">
                            <td style="padding: 0.75rem;">VLAN 99 (Mgmt)</td>
                            <td style="padding: 0.75rem;">VLAN 20 (LOG01)</td>
                            <td style="padding: 0.75rem;">SSH Management</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">22</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #faf5ff;">
                            <td style="padding: 0.75rem;">VLAN 99 (Mgmt)</td>
                            <td style="padding: 0.75rem;">VLAN 20 (DC01, DC02, LOG02)</td>
                            <td style="padding: 0.75rem;">RDP Management</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">3389</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #faf5ff;">
                            <td style="padding: 0.75rem;">VLAN 99 (Mgmt)</td>
                            <td style="padding: 0.75rem;">VLAN 30 (FILE01)</td>
                            <td style="padding: 0.75rem;">RDP/SSH Management</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">22, 3389</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #faf5ff;">
                            <td style="padding: 0.75rem;">VLAN 99 (Mgmt)</td>
                            <td style="padding: 0.75rem;">VLAN 10 (Horizon)</td>
                            <td style="padding: 0.75rem;">HTTPS Management</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">443, 9443</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #faf5ff;">
                            <td style="padding: 0.75rem;">VLAN 99 (Mgmt)</td>
                            <td style="padding: 0.75rem;">VLAN 20 (LOG01)</td>
                            <td style="padding: 0.75rem;">Graylog Web UI</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">9000, 443</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #e5e7eb; background: #faf5ff;">
                            <td style="padding: 0.75rem;">VLAN 99 (Mgmt)</td>
                            <td style="padding: 0.75rem;">Gateway/Firewall, DMZ VLAN 44 (UAG)</td>
                            <td style="padding: 0.75rem;">Device Management</td>
                            <td style="padding: 0.75rem;">TCP</td>
                            <td style="padding: 0.75rem;">22, 443</td>
                        </tr>
                    </tbody>
                </table>
                
                <div style="margin-top: 1rem; padding: 1rem; background: #f0fdf4; border-left: 4px solid #059669; border-radius: 0.25rem;">
                    <h5 style="font-weight: bold; margin-bottom: 0.5rem; color: #065f46;">Key Logging Ports Summary</h5>
                    <ul style="font-size: 0.875rem; line-height: 1.5; color: #065f46;">
                        <li><strong>Syslog:</strong> UDP 514, UDP 5140 → LOG01</li>
                        <li><strong>NetFlow:</strong> UDP 2055, UDP 9995 → LOG01</li>
                        <li><strong>Windows Event Forwarding:</strong> TCP 5985/5986 (WinRM) → LOG01</li>
                        <li><strong>Graylog GELF:</strong> UDP 12201 → LOG01</li>
                    </ul>
                </div>
            </div>

            <h3 style="font-size: 1.5rem; font-weight: bold; margin: 2rem 0 1rem;">Implementation Steps</h3>
            
            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-title">Deploy Graylog On-Premises (Core SIEM)</div>
                </div>
                <ul class="step-list">
                    <li>Install Graylog server: MongoDB + OpenSearch + Graylog (Docker Compose)</li>
                    <li>Configure inputs: Syslog (UDP/TCP 514), NetFlow (UDP 2055), GELF (UDP 12201)</li>
                    <li>Configure GW/FW NetFlow v9 export to Graylog</li>
                    <li>Add all network devices (firewalls, switches, APs) as syslog sources</li>
                    <li>Set retention: 90 days hot, 2+ years archive for CMMC</li>
                    <li>Storage: 1TB+ NVMe for hot data, NAS/S3 for archive</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-title">Configure NetFlow + Omnissa VDI Logging</div>
                </div>
                <ul class="step-list">
                    <li>UniFi Console > Settings > System > Advanced > NetFlow</li>
                    <li>Enable NetFlow v9, Collector: [Graylog IP], Port: 2055</li>
                    <li>Configure Omnissa Horizon Connection Server syslog</li>
                    <li>Configure Omnissa UAG (Unified Access Gateway) logs</li>
                    <li>Expected VDI data: 5-15 GB/day for 100-500 users</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <div class="step-title">Enable Azure Logging to Log Analytics (Identity, Security, Compliance)</div>
                </div>
                <ul class="step-list">
                    <li>Create Log Analytics workspace: 'CMMC-Cloud-Logs'</li>
                    <li><strong>Azure AD Logs:</strong> Azure Portal > Azure Active Directory > Diagnostic settings</li>
                    <li>Enable AAD logs: SignInLogs, AuditLogs, RiskyUsers, UserRiskEvents, ProvisioningLogs</li>
                    <li><strong>Microsoft Defender Logs:</strong> Enable Defender for Endpoint, Defender for Office 365, Defender for Cloud Apps</li>
                    <li>Send Defender alerts, incidents, and advanced hunting data to Log Analytics</li>
                    <li><strong>Azure Information Protection (AIP) Logs:</strong> Enable AIP audit logs and scanner reports</li>
                    <li>Track CUI classification, labeling actions, file access, and protection events</li>
                    <li><strong>Microsoft 365 Logs:</strong> Enable unified audit log in Compliance Center</li>
                    <li>Forward Exchange, SharePoint, OneDrive, Teams audit logs to Log Analytics</li>
                    <li><strong>Purview DLP Logs:</strong> Send DLP policy matches, alerts, and incidents to Log Analytics</li>
                    <li>Retention: 730 days (2 years) in workspace for CMMC compliance</li>
                    <li>Cost: ~15-25 GB/month = $45-75/month (AAD 5-10GB, Defender 5-10GB, AIP/Purview 5GB)</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">4</div>
                    <div class="step-title">Deploy Microsoft Purview for DLP & Information Protection</div>
                </div>
                <ul class="step-list">
                    <li>Enable Microsoft Purview in Microsoft 365 Compliance Center</li>
                    <li>Configure sensitivity labels for CUI classification</li>
                    <li>Create DLP policies: Prevent CUI sharing to external systems</li>
                    <li>Enable endpoint DLP on Windows devices</li>
                    <li><strong>Deploy LOG02:</strong> Windows Server 2019/2022 on VLAN 20 for AIP Scanner</li>
                    <li><strong>Install AIP Scanner:</strong> Automatic CUI detection in SharePoint, OneDrive, Teams, FILE01</li>
                    <li><strong>Conditional Access:</strong> Restrict CUI document access to Horizon VDI clients only</li>
                    <li>Configure audit logging: Send Purview alerts to Log Analytics</li>
                    <li>Set up alerts for: CUI in emails, file uploads, USB transfers, external sharing</li>
                    <li>Cost: Included with Microsoft 365 E5 Compliance</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">5</div>
                    <div class="step-title">Deploy Ollama AI Analysis Service</div>
                </div>
                <ul class="step-list">
                    <li>Hardware: Server with RTX 5070 Ti (16GB VRAM)</li>
                    <li>Install Ollama: curl -fsSL https://ollama.ai/install.sh | sh</li>
                    <li>Pull model: ollama pull llama3.2:7b</li>
                    <li>Install Python 3.11+ and dependencies</li>
                    <li>Configure API access to both Graylog and Azure Log Analytics</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">6</div>
                    <div class="step-title">Build Unified Query Service</div>
                </div>
                <ul class="step-list">
                    <li>Create Python service with Flask/FastAPI REST API</li>
                    <li>Implement Graylog REST API client (read-only token)</li>
                    <li>Build query translator: Natural language → Graylog query + KQL</li>
                    <li>Connect to Ollama for AI-powered analysis</li>
                    <li>Create web UI for security team</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">7</div>
                    <div class="step-title">Configure CMMC Compliance Dashboards</div>
                </div>
                <ul class="step-list">
                    <li>Create Graylog dashboards for each CMMC domain</li>
                    <li>Build KQL queries for AAD compliance requirements</li>
                    <li>Set up scheduled searches and reports</li>
                    <li>Configure alerts for critical CMMC violations</li>
                    <li>Document log retention and review procedures</li>
                </ul>
            </div>
        </div>

        <div id="defender" class="tab-content">
            <div class="info-box info-red">
                <h3 style="font-weight: bold; margin-bottom: 0.5rem;">Microsoft Defender EDR Integration</h3>
            </div>

            <div class="grid-2">
                <div class="feature-box" style="background: #fff7ed;">
                    <h4 style="color: #9a3412;">Defender EDR Event Types:</h4>
                    <ul>
                        <li>Advanced Threat Protection (ATP) Alerts</li>
                        <li>Malware & Ransomware Detections</li>
                        <li>Behavioral Analytics & Anomaly Detection</li>
                        <li>Process Creation & Command Line Execution</li>
                        <li>Network Connection Events</li>
                        <li>File Operations & Modifications</li>
                        <li>Registry & System Changes</li>
                        <li>PowerShell & Script Execution</li>
                        <li>USB & Removable Media Activity</li>
                        <li>Automated Investigation Results</li>
                        <li>Threat & Vulnerability Management</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #faf5ff;">
                    <h4 style="color: #6b21a8;">Additional CMMC Practices from EDR:</h4>
                    <ul>
                        <li>SI.L2-3.14.1: Identify/report info system flaws</li>
                        <li>SI.L2-3.14.2: Malicious code protection</li>
                        <li>SI.L2-3.14.3: Monitor system security alerts</li>
                        <li>AC.L2-3.1.5: Employ least privilege</li>
                        <li>AC.L2-3.1.6: Use non-privileged accounts</li>
                        <li>CM.L2-3.4.1: Baseline configurations</li>
                        <li>CM.L2-3.4.9: Control/monitor user software</li>
                        <li>SI.L2-3.14.6: Monitor organizational communications</li>
                        <li>SI.L2-3.14.7: Identify unauthorized use</li>
                        <li>RA.L2-3.11.3: Remediate vulnerabilities</li>
                    </ul>
                </div>
            </div>

            <h3 style="font-size: 1.125rem; font-weight: bold; margin: 1.5rem 0 1rem;">🔒 Key Capabilities</h3>

            <div class="grid-2">
                <div class="feature-box" style="background: #eff6ff; border: 1px solid #3b82f6;">
                    <h4 style="color: #1e40af;">Attack Surface Reduction</h4>
                    <ul>
                        <li>Block executable content from email/webmail</li>
                        <li>Prevent credential theft from LSASS</li>
                        <li>Control execution of potentially obfuscated scripts</li>
                        <li>Block untrusted/unsigned processes from USB</li>
                        <li>Restrict Office apps from creating child processes</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 1px solid #059669;">
                    <h4 style="color: #065f46;">Automated Investigation & Response</h4>
                    <ul>
                        <li>Automated alert correlation and grouping</li>
                        <li>AI-driven investigation graphs</li>
                        <li>Automated file/process remediation</li>
                        <li>Threat hunting with advanced queries (KQL)</li>
                        <li>Custom detection rules and indicators</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 1px solid #f59e0b;">
                    <h4 style="color: #92400e;">Threat & Vulnerability Management</h4>
                    <ul>
                        <li>Continuous asset discovery and inventory</li>
                        <li>Software vulnerability assessment</li>
                        <li>Security configuration misalignment detection</li>
                        <li>Risk-based remediation recommendations</li>
                        <li>Patch management integration</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #fae8ff; border: 1px solid #9333ea;">
                    <h4 style="color: #6b21a8;">Integration & Orchestration</h4>
                    <ul>
                        <li>Microsoft Sentinel SIEM integration</li>
                        <li>Azure AD identity correlation</li>
                        <li>Microsoft 365 Defender unified portal</li>
                        <li>Third-party SIEM connectors (Graylog)</li>
                        <li>SOAR playbook automation</li>
                    </ul>
                </div>
            </div>

            <div class="info-box info-yellow" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Integration with Graylog</h4>
                <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">Multiple approaches to forward Defender EDR data to Graylog for centralized analysis:</p>
                
                <div style="background: white; border-radius: 0.5rem; padding: 0.75rem; margin-bottom: 0.5rem;">
                    <div style="font-weight: 600; margin-bottom: 0.25rem;">Option 1: Microsoft 365 Defender API (Recommended)</div>
                    <p style="font-size: 0.875rem;">Use Microsoft Graph Security API to pull alerts and incidents. Python script polls API every 5-15 minutes, transforms to GELF/JSON, forwards to Graylog. Full control over data transformation and filtering.</p>
                </div>

                <div style="background: white; border-radius: 0.5rem; padding: 0.75rem; margin-bottom: 0.5rem;">
                    <div style="font-weight: 600; margin-bottom: 0.25rem;">Option 2: Azure Log Analytics Connector</div>
                    <p style="font-size: 0.875rem;">Stream Defender logs to Azure Log Analytics workspace, then use Azure Monitor to forward to Graylog via syslog/HTTP. Lower latency, native Azure integration.</p>
                </div>

                <div style="background: white; border-radius: 0.5rem; padding: 0.75rem;">
                    <div style="font-weight: 600; margin-bottom: 0.25rem;">Option 3: Microsoft Sentinel Data Connector</div>
                    <p style="font-size: 0.875rem;">For organizations using Azure Sentinel, leverage built-in Defender connector, then export to Graylog. Provides enrichment and correlation before forwarding.</p>
                </div>
            </div>

            <h3 style="font-size: 1.125rem; font-weight: bold; margin: 2rem 0 1rem;">Implementation Steps</h3>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-title">Onboard Endpoints to Defender</div>
                </div>
                <ul class="step-list">
                    <li>Deploy Defender for Endpoint agent via Group Policy or Intune</li>
                    <li>Configure sensing settings and data collection preferences</li>
                    <li>Verify endpoints appear in Microsoft 365 Defender portal</li>
                    <li>Enable EDR in block mode for proactive protection</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-title">Configure Defender for Omnissa Horizon Instant Clones</div>
                </div>
                <ul class="step-list">
                    <li>Enable Group Policy: Computer Configuration → Administrative Templates → Windows Components → Microsoft Defender Antivirus → "Allow anti-malware service to remain running with normal priority"</li>
                    <li>Set registry key: HKLM\SOFTWARE\Policies\Microsoft\Windows Advanced Threat Protection\DeviceTagging → Create DWORD "VDI" = 1</li>
                    <li>Configure Group Policy: "Configure offboarding" to prevent machine ID conflicts during instant clone refresh</li>
                    <li>Use group-based onboarding via GPO rather than individual machine onboarding scripts</li>
                    <li>Set Defender to "Passive Mode" in master image, automatically activates on clone deployment</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <div class="step-title">Configure Attack Surface Reduction Rules</div>
                </div>
                <ul class="step-list">
                    <li>Enable ASR rules in audit mode initially to measure impact</li>
                    <li>Review audit logs for false positives and create exclusions</li>
                    <li>Gradually transition rules to block mode over 2-4 weeks</li>
                    <li>Document all exceptions in CMMC System Security Plan</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">4</div>
                    <div class="step-title">Set Up API Integration with Graylog</div>
                </div>
                <ul class="step-list">
                    <li>Register application in Azure AD with appropriate API permissions</li>
                    <li>Create service principal with Microsoft.Graph SecurityEvents.Read.All</li>
                    <li>Deploy Python integration script on LOG01 Graylog server</li>
                    <li>Configure polling interval and alert severity filters</li>
                    <li>Test data flow and validate log ingestion into Graylog</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">5</div>
                    <div class="step-title">Configure Alerting & Response</div>
                </div>
                <ul class="step-list">
                    <li>Create custom detection rules for CMMC-specific threats</li>
                    <li>Set up email/webhook alerts for high/critical severity events</li>
                    <li>Configure automated response actions (isolate device, block file)</li>
                    <li>Integrate with incident response workflow and SOAR platform</li>
                </ul>
            </div>

            <div class="info-box info-green" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Licensing Requirements</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>Microsoft Defender for Endpoint P2:</strong> Standalone at $5.20/user/month or included with Microsoft 365 E5</li>
                    <li><strong>Microsoft 365 E5 Security:</strong> $12/user/month - includes Defender P2, AAD Premium P2, Cloud App Security</li>
                    <li><strong>Microsoft 365 E5:</strong> $57/user/month - full suite including Defender, Purview, compliance tools</li>
                    <li><strong>Recommended:</strong> E5 Security add-on for existing E3 customers provides best value for CMMC compliance</li>
                </ul>
            </div>
        </div>


        </div>

        <div id="purview" class="tab-content">
            <div class="info-box info-blue">
                <h3 style="font-weight: bold; margin-bottom: 0.5rem;">Microsoft Purview for Data Loss Prevention & Information Protection</h3>
            </div>

            <h3 style="font-size: 1.125rem; font-weight: bold; margin-bottom: 1rem;">🎯 CMMC Practices Covered by Purview</h3>
            
            <div class="info-box info-green">
                <h4 style="font-weight: bold; margin-bottom: 0.75rem;">Access Control (AC)</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>AC.L2-3.1.23:</strong> Control the use of CUI on external systems
                        <div style="margin-top: 0.25rem; color: #065f46;">Purview DLP prevents CUI from being shared via email, uploaded to unauthorized cloud services, or transferred to external systems</div>
                    </li>
                </ul>
            </div>

            <div class="info-box info-green" style="margin-top: 1rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.75rem;">System and Information Integrity (SI)</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>SI.L2-3.14.9:</strong> Manage information output
                        <div style="margin-top: 0.25rem; color: #065f46;">Purview monitors and controls how CUI is shared, printed, copied, and transmitted across all endpoints and services</div>
                    </li>
                </ul>
            </div>

            <h3 style="font-size: 1.125rem; font-weight: bold; margin: 2rem 0 1rem;">Key Capabilities</h3>

            <div class="grid-2">
                <div class="feature-box" style="background: #eff6ff; border: 1px solid #3b82f6;">
                    <h4 style="color: #1e40af;">Data Loss Prevention (DLP)</h4>
                    <ul>
                        <li>Sensitive information types for CUI detection</li>
                        <li>Policy enforcement across Microsoft 365, endpoints, on-prem</li>
                        <li>Real-time blocking of unauthorized CUI sharing</li>
                        <li>User education with policy tips</li>
                        <li>Detailed incident reports and alerts</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 1px solid #059669;">
                    <h4 style="color: #065f46;">Information Protection</h4>
                    <ul>
                        <li>Sensitivity labels for CUI classification</li>
                        <li>Automatic labeling based on content</li>
                        <li>Encryption and access controls</li>
                        <li>Label inheritance across copies</li>
                        <li>Visual markings (headers, footers, watermarks)</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 1px solid #f59e0b;">
                    <h4 style="color: #92400e;">AIP Scanner (LOG02)</h4>
                    <ul>
                        <li>Automatic CUI discovery in SharePoint, OneDrive, Teams</li>
                        <li>On-premises file server scanning (FILE01)</li>
                        <li>Pattern-based detection (keywords, regex, fingerprints)</li>
                        <li>Bulk auto-labeling of existing documents</li>
                        <li>Scheduled incremental and full scans</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #fae8ff; border: 1px solid #9333ea;">
                    <h4 style="color: #6b21a8;">Conditional Access</h4>
                    <ul>
                        <li>Restrict CUI access to Horizon VDI clients only</li>
                        <li>Block downloads outside VDI environment</li>
                        <li>Device compliance requirements</li>
                        <li>Location-based access controls</li>
                        <li>Session-level monitoring and restrictions</li>
                    </ul>
                </div>
            </div>

            <h3 style="font-size: 1.125rem; font-weight: bold; margin: 2rem 0 1rem;">Implementation Guide</h3>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-title">Configure Sensitivity Labels</div>
                </div>
                <ul class="step-list">
                    <li>Create label: "CUI - Controlled Unclassified Information"</li>
                    <li>Configure protection: Encryption, access restrictions</li>
                    <li>Add visual markings: "CUI" header/footer</li>
                    <li>Publish to all users via label policy</li>
                    <li>Enable auto-labeling for content matching CUI patterns</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-title">Create DLP Policies</div>
                </div>
                <ul class="step-list">
                    <li><strong>Policy 1 - Block CUI in Email:</strong> Prevent sending CUI to external domains</li>
                    <li><strong>Policy 2 - Block Cloud Uploads:</strong> Prevent CUI upload to personal OneDrive, Dropbox, etc.</li>
                    <li><strong>Policy 3 - Control USB Transfers:</strong> Prevent copying CUI to removable media</li>
                    <li><strong>Policy 4 - Monitor Printing:</strong> Audit when CUI is printed</li>
                    <li>Configure actions: Block, Audit, Notify user, Send alert to admins</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <div class="step-title">Enable Endpoint DLP</div>
                </div>
                <ul class="step-list">
                    <li>Deploy Endpoint DLP to Windows 10/11 devices via Intune</li>
                    <li>Configure device groups for policy scope</li>
                    <li>Enable file activity monitoring</li>
                    <li>Set up browser and app restrictions for CUI</li>
                    <li>Test in audit mode before enforcement</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">4</div>
                    <div class="step-title">Configure Audit & Alerting</div>
                </div>
                <ul class="step-list">
                    <li>Enable unified audit log in Microsoft 365</li>
                    <li>Configure alert policies for DLP violations</li>
                    <li>Send Purview alerts to Azure Log Analytics workspace</li>
                    <li>Create Power BI reports for CMMC evidence</li>
                    <li>Set up email notifications for security team</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">5</div>
                    <div class="step-title">Deploy Azure Information Protection (AIP) Scanner on LOG02</div>
                </div>
                <ul class="step-list">
                    <li><strong>Server Requirements:</strong> Windows Server 2019/2022 (LOG02), SQL Server Express or full, 4GB RAM, joined to domain</li>
                    <li>Install AIP Unified Labeling Scanner from Microsoft Download Center</li>
                    <li>Configure scanner service account with read access to file shares, SharePoint libraries</li>
                    <li>Define content scan jobs: SharePoint Online, OneDrive, Teams, on-prem file servers (FILE01)</li>
                    <li>Configure automatic CUI detection: Keywords (ITAR, EAR, CUI, proprietary), regex patterns, document fingerprinting</li>
                    <li>Set auto-labeling policy: Apply "CUI" sensitivity label when patterns match</li>
                    <li>Schedule scans: Daily incremental, weekly full scan</li>
                    <li>Monitor scanner logs and reports in Azure Portal (Purview > Information Protection > Scanner)</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">6</div>
                    <div class="step-title">Configure Conditional Access for CUI Protection</div>
                </div>
                <ul class="step-list">
                    <li><strong>Policy Name:</strong> "Block CUI Access Outside Horizon VDI"</li>
                    <li><strong>Assignments:</strong> All users accessing documents with "CUI" sensitivity label</li>
                    <li><strong>Conditions:</strong> Client app = Office apps, Browser; Device state = Compliant or Hybrid Azure AD joined</li>
                    <li><strong>Session Controls:</strong> Use app enforced restrictions; Block download/print/copy for non-VDI sessions</li>
                    <li><strong>Grant Access Only From:</strong> Horizon Client IP ranges (VDI session IPs only)</li>
                    <li>Test policy with pilot group before enforcing organization-wide</li>
                    <li>Create exception group for IT admins and compliance team</li>
                    <li>Enable monitoring and alerting for policy violations</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">7</div>
                    <div class="step-title">Enable CUI Protection in SharePoint, OneDrive, Teams</div>
                </div>
                <ul class="step-list">
                    <li><strong>SharePoint:</strong> Enable sensitivity labels in SharePoint Admin Center; Configure site-level labels for CUI document libraries</li>
                    <li><strong>OneDrive:</strong> Apply DLP policies to detect and protect CUI in user OneDrive folders</li>
                    <li><strong>Teams:</strong> Enable channel-level sensitivity labels; Restrict external sharing for CUI-labeled channels</li>
                    <li>Configure default sensitivity label for new files in CUI-designated libraries</li>
                    <li>Enable audit logging for all file activities (view, download, share, modify)</li>
                    <li>Set up alerts for: External sharing attempts, Label removal, Large file downloads</li>
                    <li>Create Power Automate flows for automatic notifications on CUI access violations</li>
                </ul>
            </div>

            <div class="info-box info-blue" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">🗂️ CUI Storage Locations Protected</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>SharePoint Online:</strong> All document libraries with automatic CUI detection and labeling</li>
                    <li><strong>OneDrive for Business:</strong> User personal storage with DLP enforcement</li>
                    <li><strong>Microsoft Teams:</strong> Channel file tabs, chat attachments, meeting recordings</li>
                    <li><strong>Exchange Online:</strong> Email attachments with CUI labels (DLP enforcement)</li>
                    <li><strong>On-Premises File Servers:</strong> FILE01 and network shares (via AIP Scanner)</li>
                    <li><strong>VDI Desktops:</strong> Horizon virtual desktops (local files, clipboard operations)</li>
                </ul>
            </div>

            <div class="info-box info-yellow" style="margin-top: 2rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">💡 Best Practices</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li>Start with audit mode to understand data flows before blocking</li>
                    <li>Use policy tips to educate users about CUI handling</li>
                    <li>Create exceptions for approved external collaborators</li>
                    <li>Regularly review DLP incidents and refine policies</li>
                    <li>Document all sensitivity labels and DLP policies in SSP</li>
                    <li>Train users on how to apply sensitivity labels correctly</li>
                    <li><strong>AIP Scanner:</strong> Run discovery scans first before enabling auto-labeling to avoid mislabeling</li>
                    <li><strong>Conditional Access:</strong> Test policies with pilot group; create break-glass admin accounts</li>
                    <li><strong>SharePoint/OneDrive/Teams:</strong> Enable versioning to recover from accidental label changes</li>
                </ul>
            </div>

            <div class="info-box info-blue" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">📊 Monitoring & Reporting</h4>
                <p style="font-size: 0.875rem; margin-bottom: 0.5rem;">
                    Key metrics to track for CMMC compliance:
                </p>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>DLP Policy Matches:</strong> Number of CUI sharing attempts blocked</li>
                    <li><strong>Label Coverage:</strong> Percentage of documents with sensitivity labels</li>
                    <li><strong>Policy Violations:</strong> Users attempting to share CUI externally</li>
                    <li><strong>CUI Inventory:</strong> Total volume of classified CUI in environment</li>
                    <li><strong>External Sharing:</strong> All instances of CUI shared outside organization</li>
                    <li><strong>AIP Scanner Statistics:</strong> Files scanned, auto-labeled, exceptions detected</li>
                    <li><strong>Conditional Access Blocks:</strong> CUI access attempts outside Horizon VDI</li>
                    <li><strong>Storage Location Breakdown:</strong> CUI distribution across SharePoint, OneDrive, Teams, file servers</li>
                </ul>
            </div>

            <div class="info-box info-purple" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">💰 Licensing Requirements</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>Microsoft 365 E5 Compliance:</strong> Full Purview DLP and Information Protection</li>
                    <li><strong>Microsoft 365 E3 + E5 Compliance Add-on:</strong> Alternative licensing option</li>
                    <li><strong>Azure Information Protection:</strong> Included with E5 Compliance (AIP Scanner rights)</li>
                    <li><strong>Endpoint DLP:</strong> Requires Microsoft 365 E5 or E5 Compliance</li>
                    <li><strong>Conditional Access:</strong> Requires Azure AD Premium P1 (included in E3/E5)</li>
                    <li><strong>LOG02 Server:</strong> Windows Server 2019/2022 license + SQL Server Express (free)</li>
                    <li><strong>Cost:</strong> ~$12/user/month for E5 Compliance add-on</li>
                    <li><strong>Alternative:</strong> Microsoft 365 E5 includes all Purview features ($57/user/month)</li>
                </ul>
            </div>
        </div>

        <div id="vdi" class="tab-content">
            <div class="info-box info-blue">
                <h3 style="font-weight: bold; margin-bottom: 0.5rem;">Omnissa Horizon + UAG Logs</h3>
            </div>

            <div class="info-box info-red" style="margin-bottom: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.75rem;">🔒 CMMC Level 2 Requirements for VDI</h4>
                
                <div style="margin-bottom: 1rem;">
                    <h5 style="font-weight: 600; margin-bottom: 0.5rem;">FIPS 140-2 Compliance (SC.L2-3.13.8, SC.L2-3.13.11)</h5>
                    <ul class="bullet-list" style="font-size: 0.875rem;">
                        <li><strong>UAG FIPS Mode:</strong> Enable FIPS 140-2 validated cryptographic modules in UAG appliance settings
                            <ul style="margin-left: 1rem; font-size: 0.8125rem; margin-top: 0.25rem;">
                                <li>Navigate to: UAG Admin UI → Settings → System Configuration → Enable FIPS Mode</li>
                                <li>Requires UAG appliance restart</li>
                                <li>Validates all cryptographic operations use FIPS 140-2 approved algorithms</li>
                            </ul>
                        </li>
                        <li><strong>Horizon Connection Server FIPS:</strong> Enable on all Connection Servers
                            <ul style="margin-left: 1rem; font-size: 0.8125rem; margin-top: 0.25rem;">
                                <li>Registry: HKLM\System\CurrentControlSet\Control\Lsa\FIPSAlgorithmPolicy\Enabled = 1</li>
                                <li>Or via GPO: Security Settings → Local Policies → Security Options → "System cryptography: Use FIPS compliant algorithms"</li>
                                <li>Requires Connection Server restart</li>
                            </ul>
                        </li>
                        <li><strong>Horizon Client FIPS:</strong> Deploy clients with FIPS mode enabled
                            <ul style="margin-left: 1rem; font-size: 0.8125rem; margin-top: 0.25rem;">
                                <li>Windows Client: Registry key HKLM\Software\Omnissa, Inc.\Omnissa VDM\Client\Security\FipsEnabled = 1</li>
                                <li>Or install client with: Omnissa-Horizon-Client-x.x.x-xxxxx.exe /install /silent /norestart FIPS_ENABLED=1</li>
                                <li>macOS/Linux clients: Enable in client preferences or config file</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div style="margin-bottom: 1rem;">
                    <h5 style="font-weight: 600; margin-bottom: 0.5rem;">TLS 1.2+ and Strong Cipher Suites (SC.L2-3.13.8)</h5>
                    <ul class="bullet-list" style="font-size: 0.875rem;">
                        <li><strong>Minimum TLS Version:</strong> Disable TLS 1.0 and 1.1, require TLS 1.2 or 1.3 on UAG and Connection Servers</li>
                        <li><strong>Approved Cipher Suites:</strong> Configure only FIPS-compliant ciphers:
                            <ul style="margin-left: 1rem; font-size: 0.8125rem; margin-top: 0.25rem;">
                                <li>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</li>
                                <li>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</li>
                                <li>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384</li>
                                <li>TLS_DHE_RSA_WITH_AES_128_GCM_SHA256</li>
                            </ul>
                        </li>
                        <li><strong>Certificate Requirements:</strong> Use certificates with SHA-256 or stronger, minimum 2048-bit RSA or 256-bit ECC keys</li>
                    </ul>
                </div>

                <div style="margin-bottom: 1rem;">
                    <h5 style="font-weight: 600; margin-bottom: 0.5rem;">Multi-Factor Authentication (IA.L2-3.5.3)</h5>
                    <ul class="bullet-list" style="font-size: 0.875rem;">
                        <li><strong>UAG MFA:</strong> Configure RADIUS, RSA SecurID, or SAML-based MFA for all external access</li>
                        <li><strong>Enforce MFA:</strong> Require MFA for all remote connections to CUI environments</li>
                        <li><strong>Log MFA Events:</strong> Ensure all MFA challenges, successes, and failures are logged and forwarded to Graylog</li>
                    </ul>
                </div>

                <div style="margin-bottom: 1rem;">
                    <h5 style="font-weight: 600; margin-bottom: 0.5rem;">Session Management (AC.L2-3.1.11, AC.L2-3.1.12)</h5>
                    <ul class="bullet-list" style="font-size: 0.875rem;">
                        <li><strong>Session Timeout:</strong> Configure idle timeout (15 minutes) and maximum session duration (8-10 hours)</li>
                        <li><strong>Disconnect Policy:</strong> Force disconnect on timeout, do not allow reconnect without re-authentication</li>
                        <li><strong>Session Monitoring:</strong> Log all session connects, disconnects, reconnects, and timeouts</li>
                    </ul>
                </div>

                <div style="margin-bottom: 1rem;">
                    <h5 style="font-weight: 600; margin-bottom: 0.5rem;">USB Redirection & Data Transfer Controls (AC.L2-3.1.20, AC.L2-3.1.21)</h5>
                    <ul class="bullet-list" style="font-size: 0.875rem;">
                        <li><strong>USB Policy:</strong> Block USB mass storage devices by default, allowlist specific devices for business need</li>
                        <li><strong>Client Drive Redirection:</strong> Disable or restrict to read-only for CUI environments</li>
                        <li><strong>Copy/Paste Restrictions:</strong> Disable bidirectional clipboard or restrict to one-way (VDI to client only)</li>
                        <li><strong>Printing Controls:</strong> Enable print logging, consider watermarking for CUI documents</li>
                        <li><strong>Screenshot Prevention:</strong> Consider enabling screenshot blocking for highly sensitive CUI</li>
                    </ul>
                </div>

                <div>
                    <h5 style="font-weight: 600; margin-bottom: 0.5rem;">Logging & Auditing (AU.L2-3.3.1, AU.L2-3.3.2)</h5>
                    <ul class="bullet-list" style="font-size: 0.875rem;">
                        <li><strong>Comprehensive Logging:</strong> Enable verbose logging on Connection Servers, UAG, and Horizon Agent</li>
                        <li><strong>Syslog Forwarding:</strong> Configure Connection Servers and UAG to forward logs to Graylog in real-time</li>
                        <li><strong>Event Types:</strong> Capture authentication, authorization, session lifecycle, USB events, file transfers, policy violations</li>
                        <li><strong>Log Retention:</strong> Maintain logs for minimum 1 year per CMMC requirements (configure in Graylog)</li>
                        <li><strong>Time Synchronization:</strong> Ensure all VDI components use NTP for accurate timestamps</li>
                    </ul>
                </div>
            </div>

            <h3 style="font-size: 1.25rem; font-weight: bold; margin: 1.5rem 0 1rem;">📊 Log Sources & Event Types</h3>

            <div class="grid-2">
                <div class="feature-box" style="background: #faf5ff;">
                    <h4 style="color: #6b21a8;">Horizon Connection Server Events:</h4>
                    <ul>
                        <li>User authentication (local + RADIUS/LDAP/SAML)</li>
                        <li>Session lifecycle (connect, disconnect, timeout)</li>
                        <li>Desktop/app entitlements and launches</li>
                        <li>USB device redirection events</li>
                        <li>Client device types and versions</li>
                        <li>Protocol usage (Blast, PCoIP, RDP)</li>
                        <li>Session quality metrics</li>
                        <li>Policy violations</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #f0fdf4;">
                    <h4 style="color: #065f46;">UAG (Unified Access Gateway) Logs:</h4>
                    <ul>
                        <li>External access attempts (geography, IP)</li>
                        <li>Authentication successes/failures</li>
                        <li>Certificate validation events</li>
                        <li>MFA challenges and responses</li>
                        <li>SSL/TLS handshakes</li>
                        <li>Load balancer health checks</li>
                        <li>Web reverse proxy access</li>
                        <li>Admin configuration changes</li>
                    </ul>
                </div>
            </div>

            <div class="info-box info-red">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Security Use Cases</h4>
                <div class="grid-2" style="font-size: 0.875rem;">
                    <div>
                        <div style="font-weight: 600; margin-bottom: 0.25rem;">Detect Insider Threats:</div>
                        <ul class="bullet-list">
                            <li>Unusual session times (3 AM access)</li>
                            <li>Excessive USB device usage</li>
                            <li>Large print jobs or screenshots</li>
                            <li>Multiple concurrent sessions</li>
                        </ul>
                    </div>
                    <div>
                        <div style="font-weight: 600; margin-bottom: 0.25rem;">Catch External Attackers:</div>
                        <ul class="bullet-list">
                            <li>Brute force login attempts</li>
                            <li>Access from sanctioned countries</li>
                            <li>Impossible travel (NY then Tokyo)</li>
                            <li>Unusual user agent strings</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="font-size: 1.125rem; font-weight: bold; margin: 2rem 0 1rem;">Implementation Steps</h3>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-title">Enable FIPS Mode on UAG</div>
                </div>
                <ul class="step-list">
                    <li>Log into UAG Admin UI (https://uag-ip:9443/admin)</li>
                    <li>Navigate to Settings → System Configuration → Enable FIPS Mode</li>
                    <li>Restart UAG appliance and verify FIPS status in system logs</li>
                    <li>Test external connections to ensure no connectivity issues</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-title">Enable FIPS on Horizon Connection Servers</div>
                </div>
                <ul class="step-list">
                    <li>Create GPO or set registry: HKLM\System\CurrentControlSet\Control\Lsa\FIPSAlgorithmPolicy\Enabled = 1</li>
                    <li>Apply to all Connection Servers and restart Omnissa Horizon Services</li>
                    <li>Verify FIPS mode in Event Viewer (Security log for FIPS algorithm policy changes)</li>
                    <li>Test broker functionality and desktop launches</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <div class="step-title">Deploy Horizon Clients with FIPS Enabled</div>
                </div>
                <ul class="step-list">
                    <li>Deploy Windows clients with: Omnissa-Horizon-Client-x.x.x.exe /install /silent FIPS_ENABLED=1</li>
                    <li>For existing clients, set registry: HKLM\Software\Omnissa, Inc.\Omnissa VDM\Client\Security\FipsEnabled = 1</li>
                    <li>Configure macOS/Linux clients via preferences or config files</li>
                    <li>Verify client FIPS status in client logs (C:\Users\USERNAME\AppData\Local\Temp\Omnissa-USERNAME\)</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">4</div>
                    <div class="step-title">Configure TLS 1.2+ and Strong Ciphers</div>
                </div>
                <ul class="step-list">
                    <li>Disable TLS 1.0/1.1 via registry on Connection Servers and UAG</li>
                    <li>Configure cipher suite order in UAG appliance settings</li>
                    <li>Update Connection Server TLS settings via Omnissa admin tools</li>
                    <li>Test with SSL Labs or similar scanner to verify TLS configuration</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">5</div>
                    <div class="step-title">Configure Session Policies and USB Controls</div>
                </div>
                <ul class="step-list">
                    <li>Set idle timeout to 15 minutes and max session duration to 8-10 hours in Horizon policies</li>
                    <li>Configure USB redirection policies to block mass storage by default</li>
                    <li>Disable or restrict client drive redirection and clipboard sharing</li>
                    <li>Enable print logging and consider watermarking for CUI documents</li>
                    <li>Test policies on test pool before applying to production</li>
                </ul>
            </div>

            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">6</div>
                    <div class="step-title">Configure Syslog Forwarding to Graylog</div>
                </div>
                <ul class="step-list">
                    <li>Configure Connection Server syslog: Omnissa Horizon Administrator → Events → Event Configuration → Enable syslog</li>
                    <li>Configure UAG syslog: Admin UI → Settings → Syslog → Add Graylog server IP/port</li>
                    <li>Enable verbose logging for authentication, session, and policy events</li>
                    <li>Create Graylog inputs for UDP/TCP syslog on port 514 or 1514</li>
                    <li>Verify log ingestion with test connections and search for events in Graylog</li>
                </ul>
            </div>

            <div class="info-box info-green" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Verification Checklist</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li>✅ FIPS mode enabled and verified on UAG, Connection Servers, and clients</li>
                    <li>✅ TLS 1.2+ enforced with FIPS-compliant cipher suites</li>
                    <li>✅ MFA configured and tested for external access via UAG</li>
                    <li>✅ Session timeouts and USB policies applied and tested</li>
                    <li>✅ All VDI events flowing to Graylog with proper timestamps</li>
                    <li>✅ Certificate chain validated with SHA-256+ and 2048-bit+ keys</li>
                    <li>✅ Documentation updated in CMMC System Security Plan (SSP)</li>
                </ul>
            </div>
        </div>

        <div id="windows" class="tab-content">
            <div class="info-box info-blue">
                <h3 style="font-weight: bold; margin-bottom: 0.5rem;">Windows Event Logging for CMMC Compliance</h3>
            </div>

            <h3 style="font-size: 1.25rem; font-weight: bold; margin: 1.5rem 0 1rem;">📋 Audit Policies to Enable</h3>

            <div class="grid-2">
                <div class="feature-box" style="background: #eff6ff; border: 1px solid #2563eb;">
                    <h4 style="color: #1e40af;">Account Logon Events</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem;"><strong>Enable:</strong> Success and Failure</p>
                    <ul style="font-size: 0.875rem;">
                        <li>Event 4768: Kerberos TGT requested</li>
                        <li>Event 4769: Kerberos service ticket requested</li>
                        <li>Event 4771: Kerberos pre-auth failed</li>
                        <li>Event 4776: Credential validation</li>
                    </ul>
                    <p style="font-size: 0.75rem; margin-top: 0.5rem; color: #6b7280;"><strong>CMMC:</strong> IA.L2-3.5.2, AU.L2-3.3.2</p>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 1px solid #059669;">
                    <h4 style="color: #065f46;">Account Management</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem;"><strong>Enable:</strong> Success and Failure</p>
                    <ul style="font-size: 0.875rem;">
                        <li>Event 4720: User account created</li>
                        <li>Event 4722: User account enabled</li>
                        <li>Event 4723: Password change attempt</li>
                        <li>Event 4724: Password reset attempt</li>
                        <li>Event 4725: User account disabled</li>
                        <li>Event 4726: User account deleted</li>
                        <li>Event 4728: User added to security group</li>
                        <li>Event 4732: User added to local group</li>
                        <li>Event 4756: User added to universal group</li>
                    </ul>
                    <p style="font-size: 0.75rem; margin-top: 0.5rem; color: #6b7280;"><strong>CMMC:</strong> AC.L2-3.1.4, AU.L2-3.3.2</p>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 1px solid #d97706;">
                    <h4 style="color: #92400e;">Logon/Logoff</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem;"><strong>Enable:</strong> Success and Failure</p>
                    <ul style="font-size: 0.875rem;">
                        <li>Event 4624: Successful logon</li>
                        <li>Event 4625: Failed logon</li>
                        <li>Event 4634: Logoff</li>
                        <li>Event 4647: User-initiated logoff</li>
                        <li>Event 4648: Explicit credentials logon</li>
                        <li>Event 4672: Special privileges assigned</li>
                        <li>Event 4778: RDP session reconnected</li>
                        <li>Event 4779: RDP session disconnected</li>
                    </ul>
                    <p style="font-size: 0.75rem; margin-top: 0.5rem; color: #6b7280;"><strong>CMMC:</strong> AC.L2-3.1.1, AU.L2-3.3.1</p>
                </div>

                <div class="feature-box" style="background: #fae8ff; border: 1px solid #9333ea;">
                    <h4 style="color: #6b21a8;">Object Access</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem;"><strong>Enable:</strong> Success and Failure</p>
                    <ul style="font-size: 0.875rem;">
                        <li>Event 4656: Handle to object requested</li>
                        <li>Event 4663: Attempt to access object</li>
                        <li>Event 4660: Object deleted</li>
                        <li>Event 5140: Network share accessed</li>
                        <li>Event 5145: Network share object accessed</li>
                    </ul>
                    <p style="font-size: 0.75rem; margin-top: 0.5rem; color: #6b7280;"><strong>CMMC:</strong> AC.L2-3.1.3, AU.L2-3.3.1</p>
                </div>

                <div class="feature-box" style="background: #fee2e2; border: 1px solid #dc2626;">
                    <h4 style="color: #991b1b;">Policy Change</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem;"><strong>Enable:</strong> Success and Failure</p>
                    <ul style="font-size: 0.875rem;">
                        <li>Event 4719: System audit policy changed</li>
                        <li>Event 4739: Domain policy changed</li>
                        <li>Event 4906: CrashOnAuditFail value changed</li>
                        <li>Event 4713: Kerberos policy changed</li>
                    </ul>
                    <p style="font-size: 0.75rem; margin-top: 0.5rem; color: #6b7280;"><strong>CMMC:</strong> AU.L2-3.3.3, CM.L2-3.4.3</p>
                </div>

                <div class="feature-box" style="background: #ecfccb; border: 1px solid #65a30d;">
                    <h4 style="color: #3f6212;">Privilege Use</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem;"><strong>Enable:</strong> Success and Failure</p>
                    <ul style="font-size: 0.875rem;">
                        <li>Event 4672: Special privileges assigned</li>
                        <li>Event 4673: Privileged service called</li>
                        <li>Event 4674: Operation on privileged object</li>
                    </ul>
                    <p style="font-size: 0.75rem; margin-top: 0.5rem; color: #6b7280;"><strong>CMMC:</strong> AC.L2-3.1.5, AU.L2-3.3.2</p>
                </div>

                <div class="feature-box" style="background: #dbeafe; border: 1px solid #3b82f6;">
                    <h4 style="color: #1e40af;">System Events</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem;"><strong>Enable:</strong> Success and Failure</p>
                    <ul style="font-size: 0.875rem;">
                        <li>Event 1102: Audit log cleared</li>
                        <li>Event 4608: Windows starting up</li>
                        <li>Event 4609: Windows shutting down</li>
                        <li>Event 4616: System time changed</li>
                        <li>Event 6005: Event Log service started</li>
                        <li>Event 6006: Event Log service stopped</li>
                    </ul>
                    <p style="font-size: 0.75rem; margin-top: 0.5rem; color: #6b7280;"><strong>CMMC:</strong> AU.L2-3.3.4, SI.L2-3.14.1</p>
                </div>

                <div class="feature-box" style="background: #fff7ed; border: 1px solid #ea580c;">
                    <h4 style="color: #9a3412;">Process Tracking</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem;"><strong>Enable:</strong> Success (Failure optional)</p>
                    <ul style="font-size: 0.875rem;">
                        <li>Event 4688: Process created</li>
                        <li>Event 4689: Process terminated</li>
                        <li>Event 5140: Network share accessed</li>
                    </ul>
                    <p style="font-size: 0.75rem; margin-top: 0.5rem; color: #6b7280;"><strong>CMMC:</strong> SI.L2-3.14.7, AU.L2-3.3.1</p>
                </div>
            </div>

            <h3 style="font-size: 1.25rem; font-weight: bold; margin: 2rem 0 1rem;">⚙️ Group Policy Configuration</h3>

            <div class="code-block">
                <div class="code-header">📝 GPO Settings for Advanced Audit Policy</div>
                <div class="code-content"># Group Policy Path:
# Computer Configuration > Policies > Windows Settings > Security Settings > 
# Advanced Audit Policy Configuration > Audit Policies

# ============================================
# ACCOUNT LOGON
# ============================================
Audit Credential Validation: Success, Failure
Audit Kerberos Authentication Service: Success, Failure
Audit Kerberos Service Ticket Operations: Success, Failure

# ============================================
# ACCOUNT MANAGEMENT
# ============================================
Audit Computer Account Management: Success, Failure
Audit Distribution Group Management: Success, Failure
Audit Other Account Management Events: Success, Failure
Audit Security Group Management: Success, Failure
Audit User Account Management: Success, Failure

# ============================================
# DETAILED TRACKING
# ============================================
Audit Process Creation: Success
Audit Process Termination: Success
Audit PNP Activity: Success
Audit RPC Events: Success, Failure

# ============================================
# LOGON/LOGOFF
# ============================================
Audit Account Lockout: Success, Failure
Audit Logoff: Success
Audit Logon: Success, Failure
Audit Other Logon/Logoff Events: Success, Failure
Audit Special Logon: Success, Failure

# ============================================
# OBJECT ACCESS
# ============================================
Audit File Share: Success, Failure
Audit File System: Success, Failure (for sensitive folders only)
Audit Registry: Success, Failure (for sensitive keys only)
Audit Removable Storage: Success, Failure
Audit SAM: Success, Failure

# ============================================
# POLICY CHANGE
# ============================================
Audit Audit Policy Change: Success, Failure
Audit Authentication Policy Change: Success, Failure
Audit Authorization Policy Change: Success, Failure
Audit MPSSVC Rule-Level Policy Change: Success, Failure

# ============================================
# PRIVILEGE USE
# ============================================
Audit Sensitive Privilege Use: Success, Failure
Audit Non Sensitive Privilege Use: Not Configured (too noisy)

# ============================================
# SYSTEM
# ============================================
Audit IPsec Driver: Success, Failure
Audit Security State Change: Success, Failure
Audit Security System Extension: Success, Failure
Audit System Integrity: Success, Failure

# ============================================
# DS ACCESS (Domain Controllers only)
# ============================================
Audit Directory Service Access: Success, Failure
Audit Directory Service Changes: Success, Failure
</div>
            </div>

            <div class="code-block" style="margin-top: 1.5rem;">
                <div class="code-header">🔐 Local Security Policy Settings</div>
                <div class="code-content"># Local Security Policy Path:
# Computer Configuration > Windows Settings > Security Settings > Local Policies

# ============================================
# AUDIT POLICY (Legacy - use Advanced Audit if possible)
# ============================================
Audit account logon events: Success, Failure
Audit account management: Success, Failure
Audit logon events: Success, Failure
Audit object access: Success, Failure
Audit policy change: Success, Failure
Audit privilege use: Success, Failure
Audit process tracking: Success
Audit system events: Success, Failure

# ============================================
# USER RIGHTS ASSIGNMENT
# ============================================
# Monitor these for changes:
Act as part of the operating system: (should be empty)
Create a token object: (should be empty)
Debug programs: Administrators only
Enable computer and user accounts to be trusted for delegation: (monitor changes)
Log on as a batch job: (monitor additions)
Manage auditing and security log: Administrators only

# ============================================
# SECURITY OPTIONS
# ============================================
Accounts: Administrator account status: Enabled (but rename)
Accounts: Guest account status: Disabled
Accounts: Rename administrator account: Enabled (use unique name)
Accounts: Rename guest account: Enabled (use unique name)

Audit: Force audit policy subcategory settings: Enabled
Audit: Shut down system immediately if unable to log security audits: Disabled (for most systems)

Interactive logon: Do not display last user name: Enabled
Interactive logon: Message text for users attempting to log on: [Company security banner]
Interactive logon: Number of previous logons to cache: 2

Network access: Do not allow anonymous enumeration of SAM accounts: Enabled
Network access: Do not allow anonymous enumeration of SAM accounts and shares: Enabled

Network security: Force logoff when logon hours expire: Enabled (Domain Controllers)
Network security: LAN Manager authentication level: Send NTLMv2 response only. Refuse LM & NTLM

System cryptography: Force strong key protection for user keys: User must enter password
</div>
            </div>

            <h3 style="font-size: 1.25rem; font-weight: bold; margin: 2rem 0 1rem;">📤 Forwarding Windows Events to Graylog</h3>

            <div class="code-block">
                <div class="code-header">🔧 WinLogBeat Configuration (winlogbeat.yml)</div>
                <div class="code-content">winlogbeat.event_logs:
  - name: Security
    event_id: 
      # Authentication
      - 4624  # Successful logon
      - 4625  # Failed logon
      - 4634  # Logoff
      - 4647  # User initiated logoff
      - 4648  # Explicit credentials logon
      - 4672  # Special privileges assigned
      - 4768  # Kerberos TGT requested
      - 4769  # Kerberos service ticket
      - 4771  # Kerberos pre-auth failed
      - 4776  # Credential validation
      
      # Account Management
      - 4720  # User account created
      - 4722  # User account enabled
      - 4723  # Password change
      - 4724  # Password reset
      - 4725  # User account disabled
      - 4726  # User account deleted
      - 4728  # User added to security group
      - 4732  # User added to local group
      - 4738  # User account changed
      - 4740  # User account locked out
      - 4756  # User added to universal group
      
      # Privilege Use
      - 4672  # Special privileges assigned
      - 4673  # Privileged service called
      - 4674  # Privileged operation
      
      # Policy Changes
      - 4719  # System audit policy changed
      - 4739  # Domain policy changed
      - 4713  # Kerberos policy changed
      
      # System Events
      - 1102  # Audit log cleared
      - 4608  # Windows starting
      - 4609  # Windows shutting down
      - 4616  # System time changed
      
      # Object Access
      - 4656  # Handle to object requested
      - 4660  # Object deleted
      - 4663  # Attempt to access object
      - 5140  # Network share accessed
      - 5145  # Network share object accessed
      
      # Process Tracking
      - 4688  # Process created
      - 4689  # Process terminated
    
  - name: System
    event_id:
      - 6005  # Event Log service started
      - 6006  # Event Log service stopped
      - 1074  # System shutdown/restart
      - 7036  # Service stopped/started

  - name: Application
    level: warning, error, critical

output.logstash:
  hosts: ["graylog:5044"]
  
# OR send directly to Graylog GELF
output.graylog:
  hosts: ["graylog:12201"]

processors:
  - add_host_metadata:
      when.not.contains.tags: forwarded
  - add_cloud_metadata: ~
  - add_docker_metadata: ~

logging.level: info
logging.to_files: true
logging.files:
  path: C:\ProgramData\winlogbeat\Logs
</div>
            </div>

            <div class="code-block" style="margin-top: 1.5rem;">
                <div class="code-header">📦 WinLogBeat Installation Script (PowerShell)</div>
                <div class="code-content"># Download and install WinLogBeat
$version = "8.11.3"
$url = "https://artifacts.elastic.co/downloads/beats/winlogbeat/winlogbeat-$version-windows-x86_64.zip"
$output = "C:\Temp\winlogbeat.zip"

# Download
Invoke-WebRequest -Uri $url -OutFile $output

# Extract
Expand-Archive -Path $output -DestinationPath "C:\Program Files"
Rename-Item "C:\Program Files\winlogbeat-$version-windows-x86_64" "C:\Program Files\Winlogbeat"

# Copy configuration
Copy-Item "winlogbeat.yml" "C:\Program Files\Winlogbeat\winlogbeat.yml"

# Test configuration
cd "C:\Program Files\Winlogbeat"
.\winlogbeat.exe test config -c winlogbeat.yml

# Install as service
.\install-service-winlogbeat.ps1

# Start service
Start-Service winlogbeat

# Verify
Get-Service winlogbeat
</div>
            </div>

            <div class="info-box info-yellow" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">⚠️ Important Considerations</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>Event Log Size:</strong> Increase Security log size to 4GB minimum (GPO: Maximum Log Size)</li>
                    <li><strong>Retention:</strong> Set "Do not overwrite events" or "Archive when full" with 90-day retention</li>
                    <li><strong>Performance Impact:</strong> Object Access auditing can be very noisy - apply to sensitive folders only</li>
                    <li><strong>Process Creation:</strong> Enable "Include command line in process creation events"</li>
                    <li><strong>PowerShell Logging:</strong> Enable Script Block Logging and Module Logging</li>
                    <li><strong>Firewall:</strong> Allow WinLogBeat to connect to Graylog (port 5044 or 12201)</li>
                    <li><strong>Testing:</strong> Test on pilot systems before enterprise-wide deployment</li>
                </ul>
            </div>

            <div class="info-box info-green" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">✅ Validation Checklist</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li>Verify audit policies are applied: <code>auditpol /get /category:*</code></li>
                    <li>Check event log sizes: <code>wevtutil gli Security</code></li>
                    <li>Test failed login: Verify Event 4625 appears</li>
                    <li>Test successful login: Verify Event 4624 appears</li>
                    <li>Test privilege use: Verify Event 4672 for admin logon</li>
                    <li>Verify WinLogBeat is forwarding: Check Graylog for Windows events</li>
                    <li>Monitor performance: Use Performance Monitor to track event log overhead</li>
                    <li>Document baseline: Record normal event rates for anomaly detection</li>
                </ul>
            </div>

            <div class="info-box info-blue" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">📊 Expected Event Volume</h4>
                <div style="font-size: 0.875rem;">
                    <p style="margin-bottom: 0.5rem;"><strong>Per Server:</strong></p>
                    <ul class="bullet-list">
                        <li>Workstation: 500-2,000 events/day (~50-100 MB/month)</li>
                        <li>Member Server: 2,000-10,000 events/day (~100-500 MB/month)</li>
                        <li>Domain Controller: 50,000-200,000 events/day (~2-10 GB/month)</li>
                    </ul>
                    <p style="margin-top: 1rem; margin-bottom: 0.5rem;"><strong>For 100 Windows Systems:</strong></p>
                    <ul class="bullet-list">
                        <li>Total: ~50-100 GB/month</li>
                        <li>Peak hours: 3-5x baseline rate</li>
                        <li>After-hours: Expect 10-20% of daytime rate</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="graylog" class="tab-content">
            <div class="info-box info-green">
                <h3 style="font-weight: bold; margin-bottom: 0.5rem;">Graylog SIEM for Centralized Log Aggregation</h3>
            </div>

            <div class="code-block">
                <div class="code-header">🖥️ Complete Graylog Docker Compose Configuration</div>
                <div class="code-content"># Graylog Deployment Configuration for CMMC Compliance

version: '3.8'

services:
  mongodb:
    image: mongo:6.0
    restart: unless-stopped
    volumes:
      - mongo_data:/data/db
    networks:
      - graylog

  opensearch:
    image: opensearchproject/opensearch:2.11.1
    restart: unless-stopped
    environment:
      - "OPENSEARCH_JAVA_OPTS=-Xms8g -Xmx8g"
      - "discovery.type=single-node"
      - "plugins.security.disabled=true"
      - "action.auto_create_index=false"
    ulimits:
      memlock:
        soft: -1
        hard: -1
      nofile:
        soft: 65536
        hard: 65536
    volumes:
      - opensearch_data:/usr/share/opensearch/data
    networks:
      - graylog

  graylog:
    image: graylog/graylog:5.2
    restart: unless-stopped
    depends_on:
      - mongodb
      - opensearch
    entrypoint: /usr/bin/tini -- wait-for-it opensearch:9200 -- /docker-entrypoint.sh
    environment:
      # Generate with: pwgen -N 1 -s 96
      GRAYLOG_PASSWORD_SECRET: "your_password_secret_96_chars"
      # Generate with: echo -n "yourpassword" | sha256sum
      GRAYLOG_ROOT_PASSWORD_SHA2: "your_sha256_hash"
      GRAYLOG_HTTP_BIND_ADDRESS: "0.0.0.0:9000"
      GRAYLOG_HTTP_EXTERNAL_URI: "http://graylog.yourdomain.local:9000/"
      GRAYLOG_ELASTICSEARCH_HOSTS: "http://opensearch:9200"
      GRAYLOG_MONGODB_URI: "mongodb://mongodb:27017/graylog"
      # Timezone
      GRAYLOG_TIMEZONE: "Pacific/Honolulu"
      # Email settings for alerts
      GRAYLOG_TRANSPORT_EMAIL_ENABLED: "true"
      GRAYLOG_TRANSPORT_EMAIL_HOSTNAME: "smtp.yourdomain.com"
      GRAYLOG_TRANSPORT_EMAIL_PORT: "587"
      GRAYLOG_TRANSPORT_EMAIL_USE_AUTH: "true"
      GRAYLOG_TRANSPORT_EMAIL_USE_TLS: "true"
      GRAYLOG_TRANSPORT_EMAIL_USE_SSL: "false"
    ports:
      - "9000:9000"     # Web interface
      - "514:514/udp"   # Syslog UDP
      - "514:514/tcp"   # Syslog TCP
      - "2055:2055/udp" # NetFlow
      - "12201:12201/udp" # GELF
      - "5044:5044/tcp" # Beats
    volumes:
      - graylog_data:/usr/share/graylog/data
      - graylog_journal:/usr/share/graylog/data/journal
    networks:
      - graylog

volumes:
  mongo_data:
    driver: local
  opensearch_data:
    driver: local
  graylog_data:
    driver: local
  graylog_journal:
    driver: local

networks:
  graylog:
    driver: bridge

# ============================================
# INITIAL CONFIGURATION STEPS
# ============================================

# 1. Start the stack
#    docker-compose up -d

# 2. Access web UI
#    http://your-server-ip:9000
#    Login: admin / your_password

# 3. Configure Inputs
#    System > Inputs > Select input type and launch

# ============================================
# SYSLOG INPUT CONFIGURATION
# ============================================
# Title: Network Devices Syslog
# Type: Syslog UDP
# Port: 514
# Bind address: 0.0.0.0
# Store full message: Yes
# Override source: No

# ============================================
# NETFLOW INPUT CONFIGURATION
# ============================================
# Title: GW-FW Netflow
# Type: NetFlow UDP
# Port: 2055
# Bind address: 0.0.0.0
# Cache size: 1000

# ============================================
# GELF INPUT CONFIGURATION
# ============================================
# Title: Microsoft Defender EDR Events
# Type: GELF UDP
# Port: 12201
# Bind address: 0.0.0.0

# ============================================
# INDEX CONFIGURATION
# ============================================
# System > Indices > Default index set
# Rotation strategy: Index Size (1 GB)
# Retention strategy: Delete (90 indices for ~90 days)
# Archive strategy: Close and archive to S3/NFS after 30 days

# ============================================
# STORAGE ESTIMATES
# ============================================
# Syslog (25k events/min): ~130 GB/month
# NetFlow (medium network): ~20-50 GB/day = 600-1500 GB/month
# Windows Events (100 hosts): ~50-100 GB/month
# VDI Logs (250 users): ~8-12 GB/day = 240-360 GB/month
# Microsoft Defender EDR (250 endpoints): ~15-25 GB/day = 450-750 GB/month
# Total: ~1500-2700 GB/month (plan for 3-4TB hot storage)

# ============================================
# PERFORMANCE TUNING
# ============================================
# OpenSearch heap: 50% of system RAM (max 32GB)
# MongoDB: Dedicated fast storage (NVMe recommended)
# Graylog Journal: Separate fast disk for write buffer
# Network: 10GbE recommended for high throughput

# ============================================
# BACKUP STRATEGY
# ============================================
# MongoDB: Daily backup with mongodump
# OpenSearch snapshots: Weekly to S3/NFS
# Graylog config: Export content packs regularly
# Archive indices: Move to cold storage after 90 days

# ============================================
# SECURITY HARDENING
# ============================================
# 1. Change default passwords immediately
# 2. Enable HTTPS with valid SSL certificate
# 3. Configure RBAC for users and teams
# 4. Restrict network access with firewall rules
# 5. Enable audit logging in Graylog
# 6. Regularly update container images
# 7. Use secrets management for credentials

# ============================================
# MONITORING & ALERTING
# ============================================
# Create alerts for:
# - Failed login attempts (>5 in 5 min)
# - Large data transfers (>100MB)
# - Malware detections (Microsoft Defender EDR)
# - VDI USB device usage
# - External access attempts
# - System errors and failures

# ============================================
# CMMC COMPLIANCE NOTES
# ============================================
# This configuration supports:
# - AU.L2-3.3.1: Create and retain audit logs (2+ years)
# - AU.L2-3.3.8: Protect audit information (access control)
# - AU.L2-3.3.9: Limit audit management (RBAC)
# - IR.L2-3.6.1: Incident handling capability (alerts)
# - SI.L2-3.14.3: Monitor security alerts (dashboards)
</div>
            </div>

            <div class="info-box info-blue" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Quick Start Commands</h4>
                <div style="background: #1f2937; color: #10b981; padding: 1rem; border-radius: 0.5rem; font-family: monospace; font-size: 0.75rem; margin-top: 0.75rem;">
# Save docker-compose.yml and start services
docker-compose up -d

# Check logs
docker-compose logs -f graylog

# Stop services
docker-compose down

# Generate password hash
echo -n "yourpassword" | sha256sum

# Generate secret
pwgen -N 1 -s 96
                </div>
            </div>

            <div class="info-box info-green" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Hardware Requirements</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>CPU:</strong> 8+ cores (16+ recommended for production)</li>
                    <li><strong>RAM:</strong> 16GB minimum (32-64GB recommended)</li>
                    <li><strong>Storage:</strong> 3-4TB NVMe SSD for hot data (90 days)</li>
                    <li><strong>Network:</strong> 1GbE minimum (10GbE recommended)</li>
                    <li><strong>Archive:</strong> NAS or S3 for long-term retention</li>
                </ul>
            </div>
        </div>

        <div id="ollama" class="tab-content">
            <div class="info-box info-purple">
                <h3 style="font-weight: bold; margin-bottom: 0.5rem;">Ollama AI Log Analysis Service</h3>
                <p style="font-size: 0.875rem;">
                    Python Flask service providing natural language queries across all log sources with AI-powered analysis using Llama 3.2.
                    Unifies Graylog, Azure Log Analytics, and provides CMMC compliance reporting.
                </p>
            </div>

            <div class="code-block">
                <div class="code-header">🧠 Complete Python Service Implementation (log_analysis_service.py)</div>
                <div class="code-content"># Ollama Log Analysis Service for CMMC Compliance
# Unified query interface across Graylog + Azure Log Analytics + AI analysis

import os
import json
import requests
from datetime import datetime, timedelta
from flask import Flask, request, jsonify
from azure.identity import DefaultAzureCredential
from azure.monitor.query import LogsQueryClient
import ollama

app = Flask(__name__)

class LogAnalysisService:
    def __init__(self):
        # Graylog configuration
        self.graylog_url = os.getenv('GRAYLOG_URL', 'http://graylog:9000')
        self.graylog_token = os.getenv('GRAYLOG_API_TOKEN')
        
        # Azure Log Analytics configuration
        self.workspace_id = os.getenv('AZURE_WORKSPACE_ID')
        self.credential = DefaultAzureCredential()
        self.logs_client = LogsQueryClient(self.credential)
        
        # Ollama configuration
        self.ollama_model = os.getenv('OLLAMA_MODEL', 'llama3.2:7b')
    
    def query_graylog(self, query_string, timerange_seconds=3600, limit=100):
        """Query Graylog logs"""
        headers = {
            'Authorization': f'Basic {self.graylog_token}',
            'Accept': 'application/json'
        }
        
        params = {
            'query': query_string,
            'range': timerange_seconds,
            'limit': limit,
            'sort': 'timestamp:desc'
        }
        
        try:
            response = requests.get(
                f'{self.graylog_url}/api/search/universal/relative',
                headers=headers,
                params=params,
                timeout=30
            )
            response.raise_for_status()
            return response.json()
        except Exception as e:
            return {'error': str(e)}
    
    def query_azure_la(self, kql_query, timespan='PT24H'):
        """Query Azure Log Analytics"""
        try:
            response = self.logs_client.query_workspace(
                workspace_id=self.workspace_id,
                query=kql_query,
                timespan=timespan
            )
            
            results = []
            for table in response.tables:
                for row in table.rows:
                    results.append(dict(zip([col.name for col in table.columns], row)))
            return results
        except Exception as e:
            return {'error': str(e)}
    
    def analyze_with_ollama(self, data, question, context=""):
        """Analyze logs with Ollama AI"""
        prompt = f"""You are a cybersecurity analyst reviewing logs for CMMC Level 2 compliance.

Context: {context}

Log Data:
{json.dumps(data, indent=2, default=str)[:4000]}

Question: {question}

Provide a security analysis focusing on:
1. Key findings and patterns
2. Potential security issues or policy violations
3. CMMC compliance implications
4. Recommended actions

Be concise and actionable."""

        try:
            response = ollama.chat(
                model=self.ollama_model,
                messages=[{'role': 'user', 'content': prompt}]
            )
            return response['message']['content']
        except Exception as e:
            return f"Analysis error: {str(e)}"
    
    def unified_search(self, question):
        """Natural language search across all log sources"""
        
        # Determine what to search based on question
        search_aad = any(word in question.lower() for word in 
            ['login', 'authentication', 'mfa', 'azure', 'user', 'password'])
        
        search_network = any(word in question.lower() for word in 
            ['network', 'traffic', 'connection', 'firewall', 'netflow', 'bandwidth'])
        
        search_vdi = any(word in question.lower() for word in
            ['vdi', 'horizon', 'uag', 'remote', 'desktop', 'session'])
        
        search_edr = any(word in question.lower() for word in
            ['malware', 'carbon', 'endpoint', 'process', 'threat', 'virus'])
        
        results = {}
        
        # Search Graylog (on-prem logs + NetFlow + VDI + EDR)
        if search_network or search_vdi or search_edr or not search_aad:
            graylog_query = self._build_graylog_query(question)
            results['graylog'] = self.query_graylog(graylog_query, timerange_seconds=86400)
        
        # Search Azure Log Analytics (AAD only)
        if search_aad:
            kql_query = self._build_kql_query(question)
            results['azure_ad'] = self.query_azure_la(kql_query)
        
        # Analyze with AI
        analysis = self.analyze_with_ollama(
            results, 
            question,
            context="Hybrid environment: on-prem infrastructure + VDI + EDR + Azure AD"
        )
        
        return {
            'question': question,
            'data_sources': list(results.keys()),
            'raw_results': results,
            'ai_analysis': analysis,
            'timestamp': datetime.utcnow().isoformat()
        }
    
    def _build_graylog_query(self, question):
        """Convert natural language to Graylog query"""
        q = question.lower()
        
        if 'failed' in q and 'login' in q:
            return 'failed AND (login OR authentication OR ssh OR rdp)'
        elif 'large' in q and ('transfer' in q or 'data' in q):
            return 'netflow_bytes:>100000000'
        elif 'suspicious' in q:
            return 'netflow_packets:>0 AND (destination_port:(22 3389 445) OR protocol:telnet)'
        elif 'malware' in q or 'threat' in q:
            return 'source:"defender_edr" AND (_event_type:"alert" OR _severity:"high")'
        elif 'vdi' in q or 'horizon' in q or 'session' in q:
            return 'source:"horizon" OR source:"uag"'
        elif 'usb' in q:
            return 'source:"horizon" AND USB_PLUGGED'
        else:
            # Extract keywords
            keywords = [w for w in q.split() if len(w) > 3 and w not in 
                       ['what', 'show', 'find', 'from', 'with', 'that', 'have']]
            return ' AND '.join(keywords[:5]) if keywords else '*'
    
    def _build_kql_query(self, question):
        """Convert natural language to KQL"""
        q = question.lower()
        
        if 'failed' in q and 'login' in q:
            return '''SigninLogs 
                | where TimeGenerated > ago(24h) 
                | where ResultType != "0"
                | summarize FailedAttempts=count() by UserPrincipalName, IPAddress
                | where FailedAttempts > 3
                | order by FailedAttempts desc'''
        elif 'mfa' in q:
            return '''SigninLogs
                | where TimeGenerated > ago(7d)
                | extend MFAUsed = iff(AuthenticationRequirement == "multiFactorAuthentication", "Yes", "No")
                | summarize TotalLogins=count(), MFALogins=countif(MFAUsed=="Yes") by UserPrincipalName
                | extend MFAPercent = (MFALogins*100.0)/TotalLogins
                | where MFAPercent < 100'''
        elif 'risky' in q or 'risk' in q:
            return '''SigninLogs
                | where TimeGenerated > ago(24h)
                | where RiskLevelDuringSignIn in ("high", "medium")
                | order by TimeGenerated desc'''
        else:
            return 'SigninLogs | where TimeGenerated > ago(24h) | take 100'

# Flask API endpoints
service = LogAnalysisService()

@app.route('/health', methods=['GET'])
def health():
    return jsonify({'status': 'healthy'})

@app.route('/query', methods=['POST'])
def query():
    """Natural language query endpoint"""
    data = request.json
    question = data.get('question', '')
    
    if not question:
        return jsonify({'error': 'No question provided'}), 400
    
    result = service.unified_search(question)
    return jsonify(result)

@app.route('/graylog', methods=['POST'])
def graylog_query():
    """Direct Graylog query endpoint"""
    data = request.json
    query = data.get('query', '*')
    timerange = data.get('timerange', 3600)
    
    result = service.query_graylog(query, timerange)
    return jsonify(result)

@app.route('/azure', methods=['POST'])
def azure_query():
    """Direct Azure Log Analytics query endpoint"""
    data = request.json
    query = data.get('query')
    
    if not query:
        return jsonify({'error': 'No KQL query provided'}), 400
    
    result = service.query_azure_la(query)
    return jsonify(result)

@app.route('/cmmc/report', methods=['POST'])
def cmmc_report():
    """Generate CMMC compliance report"""
    data = request.json
    domain = data.get('domain', 'all')
    days = data.get('days', 30)
    
    # Collect evidence from all sources
    evidence = {}
    
    # Network monitoring evidence
    evidence['network'] = service.query_graylog(
        'netflow_*',
        timerange_seconds=days*86400,
        limit=1000
    )
    
    # VDI access evidence
    evidence['vdi'] = service.query_graylog(
        'source:"horizon" OR source:"uag"',
        timerange_seconds=days*86400,
        limit=1000
    )
    
    # EDR evidence
    evidence['edr'] = service.query_graylog(
        'source:"defender_edr"',
        timerange_seconds=days*86400,
        limit=1000
    )
    
    # AAD evidence
    evidence['aad'] = service.query_azure_la(
        f'SigninLogs | where TimeGenerated > ago({days}d)',
        timespan=f'P{days}D'
    )
    
    # AI analysis
    analysis = service.analyze_with_ollama(
        evidence,
        f"Generate CMMC Level 2 compliance report for {domain} domain covering last {days} days",
        context="CMMC Level 2 assessment - provide evidence of compliance controls"
    )
    
    return jsonify({
        'domain': domain,
        'period_days': days,
        'evidence_collected': {k: len(v) if isinstance(v, list) else 'error' 
                              for k, v in evidence.items()},
        'compliance_analysis': analysis,
        'generated_at': datetime.utcnow().isoformat()
    })

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000)
</div>
            </div>

            <div class="code-block" style="margin-top: 1.5rem;">
                <div class="code-header">⚙️ Environment Configuration (.env)</div>
                <div class="code-content">GRAYLOG_URL=http://graylog-server:9000
GRAYLOG_API_TOKEN=your_base64_encoded_token
AZURE_WORKSPACE_ID=your-workspace-id
OLLAMA_MODEL=llama3.2:7b
</div>
            </div>

            <div class="code-block" style="margin-top: 1.5rem;">
                <div class="code-header">🔧 Systemd Service Configuration (/etc/systemd/system/ollama-log-analysis.service)</div>
                <div class="code-content">[Unit]
Description=Ollama Log Analysis Service
After=network.target ollama.service

[Service]
Type=simple
User=ollama
WorkingDirectory=/opt/ollama-log-analysis
Environment="PATH=/usr/local/bin:/usr/bin:/bin"
EnvironmentFile=/opt/ollama-log-analysis/.env
ExecStart=/usr/bin/python3 /opt/ollama-log-analysis/log_analysis_service.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
</div>
            </div>

            <div class="code-block" style="margin-top: 1.5rem;">
                <div class="code-header">📦 Installation & Deployment Script</div>
                <div class="code-content">#!/bin/bash
# Complete installation script for Ollama Log Analysis Service

# 1. Install Ollama
curl -fsSL https://ollama.ai/install.sh | sh

# 2. Pull model
ollama pull llama3.2:7b

# 3. Install Python dependencies
apt update && apt install -y python3.11 python3-pip
pip3 install flask ollama requests azure-monitor-query azure-identity

# 4. Create service directory
mkdir -p /opt/ollama-log-analysis
cd /opt/ollama-log-analysis

# 5. Save the Python code as log_analysis_service.py
# (Copy the code from above)

# 6. Create .env file
cat > .env << 'EOF'
GRAYLOG_URL=http://graylog:9000
GRAYLOG_API_TOKEN=your_token_here
AZURE_WORKSPACE_ID=your_workspace_id
OLLAMA_MODEL=llama3.2:7b
EOF

# 7. Create systemd service
cat > /etc/systemd/system/ollama-log-analysis.service << 'EOF'
[Unit]
Description=Ollama Log Analysis Service
After=network.target ollama.service

[Service]
Type=simple
User=root
WorkingDirectory=/opt/ollama-log-analysis
EnvironmentFile=/opt/ollama-log-analysis/.env
ExecStart=/usr/bin/python3 /opt/ollama-log-analysis/log_analysis_service.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
EOF

# 8. Enable and start service
systemctl daemon-reload
systemctl enable ollama-log-analysis
systemctl start ollama-log-analysis

# 9. Check status
systemctl status ollama-log-analysis

echo "Installation complete!"
echo "Test with: curl http://localhost:5000/health"
</div>
            </div>

            <div class="code-block" style="margin-top: 1.5rem;">
                <div class="code-header">🧪 Example API Usage</div>
                <div class="code-content"># Test health endpoint
curl http://localhost:5000/health

# Natural language query
curl -X POST http://localhost:5000/query \
  -H "Content-Type: application/json" \
  -d '{"question": "Show me failed login attempts in the last 24 hours"}'

# Direct Graylog query
curl -X POST http://localhost:5000/graylog \
  -H "Content-Type: application/json" \
  -d '{"query": "source:defender_edr AND _severity:high", "timerange": 86400}'

# Direct Azure KQL query
curl -X POST http://localhost:5000/azure \
  -H "Content-Type: application/json" \
  -d '{"query": "SigninLogs | where ResultType != \"0\" | take 10"}'

# Generate CMMC compliance report
curl -X POST http://localhost:5000/cmmc/report \
  -H "Content-Type: application/json" \
  -d '{"domain": "Access Control", "days": 30}'

# Example natural language queries:
# - "Show me all malware detections in the last week"
# - "Find VDI sessions from unusual locations"
# - "List failed Azure AD logins with more than 5 attempts"
# - "Show me large data transfers over 100MB"
# - "Find all USB device usage in VDI sessions"
# - "What are the risky sign-ins today?"
</div>
            </div>

            <div class="info-box info-green" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Service Features</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>Natural Language Processing:</strong> Converts English questions to Graylog/KQL queries</li>
                    <li><strong>Multi-Source Query:</strong> Searches Graylog and Azure Log Analytics simultaneously</li>
                    <li><strong>AI Analysis:</strong> Uses Llama 3.2 to analyze results and provide security insights</li>
                    <li><strong>CMMC Reporting:</strong> Generates compliance evidence reports for assessors</li>
                    <li><strong>REST API:</strong> Easy integration with other tools and dashboards</li>
                    <li><strong>Auto-Routing:</strong> Intelligently routes queries to appropriate data sources</li>
                </ul>
            </div>

            <div class="info-box info-yellow" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Hardware Requirements</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>GPU:</strong> NVIDIA RTX 5070 Ti or better (16GB VRAM minimum)</li>
                    <li><strong>CPU:</strong> 8+ cores recommended for simultaneous query processing</li>
                    <li><strong>RAM:</strong> 16GB minimum (32GB recommended)</li>
                    <li><strong>Storage:</strong> 50GB for model and cache</li>
                    <li><strong>Performance:</strong> 40-60 tokens/second for Llama 3.2 7B</li>
                </ul>
            </div>

            <div class="info-box info-blue" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Security Considerations</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li>Use read-only API tokens for Graylog and Azure</li>
                    <li>Enable HTTPS for production deployment</li>
                    <li>Implement rate limiting to prevent abuse</li>
                    <li>Add authentication/authorization layer (OAuth, API keys)</li>
                    <li>Run service as non-root user</li>
                    <li>Monitor service logs for anomalies</li>
                    <li>Keep all dependencies updated</li>
                </ul>
            </div>
        </div>

        <div id="gpos" class="tab-content">
            <div class="info-box info-blue">
                <h3 style="font-weight: bold; margin-bottom: 0.5rem;">Group Policy Settings for CMMC Compliance</h3>
                <p style="font-size: 0.875rem;">
                    Essential GPO configurations for Domain Controllers, Windows Server 2025, and Windows 11 Enterprise to achieve CMMC Level 2 compliance.
                </p>
            </div>

            <h3 style="font-size: 1.25rem; font-weight: bold; margin: 1.5rem 0 1rem;">🖥️ Domain Controller GPOs</h3>

            <div class="grid-2">
                <div class="feature-box" style="background: #fef2f2; border: 1px solid #dc2626;">
                    <h4 style="color: #991b1b;">Account Policies</h4>
                    <ul style="font-size: 0.875rem;">
                        <li><strong>Password Policy:</strong>
                            <ul style="margin-left: 1rem; font-size: 0.8125rem;">
                                <li>Minimum password length: 14 characters</li>
                                <li>Password complexity: Enabled</li>
                                <li>Maximum password age: 60 days</li>
                                <li>Minimum password age: 1 day</li>
                                <li>Enforce password history: 24 passwords</li>
                            </ul>
                        </li>
                        <li><strong>Account Lockout:</strong>
                            <ul style="margin-left: 1rem; font-size: 0.8125rem;">
                                <li>Account lockout threshold: 5 invalid attempts</li>
                                <li>Account lockout duration: 30 minutes</li>
                                <li>Reset lockout counter: 30 minutes</li>
                            </ul>
                        </li>
                        <li><strong>Kerberos Policy:</strong>
                            <ul style="margin-left: 1rem; font-size: 0.8125rem;">
                                <li>Maximum lifetime for user ticket: 10 hours</li>
                                <li>Maximum tolerance for sync: 5 minutes</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 1px solid #f59e0b;">
                    <h4 style="color: #92400e;">Audit Policy - Domain Controllers</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>Account Logon Events: Success, Failure</li>
                        <li>Account Management: Success, Failure</li>
                        <li>Directory Service Access: Success, Failure</li>
                        <li>Logon Events: Success, Failure</li>
                        <li>Object Access: Success, Failure</li>
                        <li>Policy Change: Success, Failure</li>
                        <li>Privilege Use: Success, Failure</li>
                        <li>System Events: Success, Failure</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #eff6ff; border: 1px solid #2563eb;">
                    <h4 style="color: #1e40af;">Security Options</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>Interactive logon: Display user info: User display name only</li>
                        <li>Interactive logon: Message text/title for logon: (Set CMMC warning banner)</li>
                        <li>Network security: LAN Manager auth level: Send NTLMv2 response only</li>
                        <li>Network security: LDAP client signing: Require signing</li>
                        <li>Network security: Configure encryption types for Kerberos: AES256_HMAC_SHA1, AES128_HMAC_SHA1</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 1px solid #059669;">
                    <h4 style="color: #065f46;">User Rights Assignment</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>Access this computer from network: Administrators, Authenticated Users</li>
                        <li>Allow log on locally: Administrators only</li>
                        <li>Deny log on as batch job: Guests</li>
                        <li>Deny log on through RDS: Guests, Local account</li>
                        <li>Enable computer accounts to be trusted: No One</li>
                        <li>Log on as a service: (Only specific service accounts)</li>
                    </ul>
                </div>
            </div>

            <h3 style="font-size: 1.25rem; font-weight: bold; margin: 2rem 0 1rem;">🖥️ Windows Server 2025 GPOs</h3>

            <div class="grid-2">
                <div class="feature-box" style="background: #eff6ff; border: 1px solid #2563eb;">
                    <h4 style="color: #1e40af;">Windows Defender Settings</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>Turn off Windows Defender: Disabled</li>
                        <li>Turn on behavior monitoring: Enabled</li>
                        <li>Turn on script scanning: Enabled</li>
                        <li>Scan all downloaded files: Enabled</li>
                        <li>Turn on e-mail scanning: Enabled</li>
                        <li>Configure real-time protection: Enabled</li>
                        <li>Configure Attack Surface Reduction rules: Enabled (Audit mode initially)</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 1px solid #f59e0b;">
                    <h4 style="color: #92400e;">Advanced Audit Policy</h4>
                    <ul style="font-size: 0.875rem;">
                        <li><strong>Account Logon:</strong> Credential Validation (S,F)</li>
                        <li><strong>Account Management:</strong> Security Group Mgmt (S,F), User Account Mgmt (S,F)</li>
                        <li><strong>Detailed Tracking:</strong> Process Creation (S), Process Termination (S)</li>
                        <li><strong>Logon/Logoff:</strong> Logon (S,F), Logoff (S), Account Lockout (F)</li>
                        <li><strong>Object Access:</strong> File System (S,F), Registry (S,F)</li>
                        <li><strong>Policy Change:</strong> Audit Policy Change (S,F), Authentication Policy (S,F)</li>
                        <li><strong>Privilege Use:</strong> Sensitive Privilege Use (S,F)</li>
                        <li><strong>System:</strong> Security State Change (S,F), Security System Extension (S,F)</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 1px solid #059669;">
                    <h4 style="color: #065f46;">Windows Firewall</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>Domain Profile: On (configured via GPO)</li>
                        <li>Private Profile: On</li>
                        <li>Public Profile: On</li>
                        <li>Block inbound connections by default: Yes</li>
                        <li>Log dropped packets: Yes (for CMMC audit)</li>
                        <li>Log successful connections: Yes</li>
                        <li>Log file size: 16384 KB</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #fae8ff; border: 1px solid #9333ea;">
                    <h4 style="color: #6b21a8;">Remote Desktop Services</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>Require secure RPC: Enabled</li>
                        <li>Require use of specific security layer: SSL (TLS 1.2+)</li>
                        <li>Set client connection encryption: High Level</li>
                        <li>Always prompt for password: Enabled</li>
                        <li>Do not allow passwords to be saved: Enabled</li>
                        <li>Set time limit for disconnected sessions: 15 minutes</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #fef2f2; border: 1px solid #dc2626;">
                    <h4 style="color: #991b1b;">PowerShell & Script Execution</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>Turn on PowerShell Script Block Logging: Enabled</li>
                        <li>Turn on PowerShell Transcription: Enabled</li>
                        <li>Turn on Module Logging: Enabled</li>
                        <li>Script Execution Policy: RemoteSigned or AllSigned</li>
                        <li>Log file path: \\LOG01\PSTranscripts\%USERNAME%\</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #eff6ff; border: 1px solid #2563eb;">
                    <h4 style="color: #1e40af;">SMB Security</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>Require SMB Encryption: Enabled</li>
                        <li>Require SMB Signing: Enabled</li>
                        <li>Disable SMBv1: Enabled</li>
                        <li>Configure SMB bandwidth limit: (As needed)</li>
                    </ul>
                </div>
            </div>

            <h3 style="font-size: 1.25rem; font-weight: bold; margin: 2rem 0 1rem;">💻 Windows 11 Enterprise GPOs</h3>

            <div class="grid-2">
                <div class="feature-box" style="background: #eff6ff; border: 1px solid #2563eb;">
                    <h4 style="color: #1e40af;">BitLocker Drive Encryption</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem; font-weight: 600; color: #dc2626;">⚠️ DO NOT enable on Horizon instant clones - Apply only to physical endpoints and persistent VMs</p>
                    <ul style="font-size: 0.875rem;">
                        <li>Require additional authentication at startup: Enabled</li>
                        <li>Allow BitLocker without compatible TPM: Disabled</li>
                        <li>Configure TPM startup: Require TPM</li>
                        <li>Configure minimum PIN length: 8 characters</li>
                        <li>Choose how BitLocker recovery info stored: Allow 256-bit recovery key</li>
                        <li>Store recovery info in AD DS: Enabled</li>
                        <li>Do not enable BitLocker until recovery info stored: Enabled</li>
                    </ul>
                    <p style="font-size: 0.8125rem; margin-top: 0.5rem; font-style: italic; color: #6b7280;">
                        Note: Instant clones are non-persistent and recreated frequently. CUI data resides on FILE01 (file server) which should use encryption at rest. Physical endpoints and persistent servers require BitLocker.
                    </p>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 1px solid #059669;">
                    <h4 style="color: #065f46;">Windows Defender Application Control</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>Deploy Windows Defender Application Control: Enabled (Audit mode)</li>
                        <li>Configure Attack Surface Reduction rules: Enabled</li>
                        <li>Block executable content from email client: Enabled</li>
                        <li>Block Office apps from creating child processes: Enabled</li>
                        <li>Block credential stealing from lsass.exe: Enabled</li>
                        <li>Block untrusted USB processes: Enabled</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 1px solid #f59e0b;">
                    <h4 style="color: #92400e;">Microsoft Defender for Endpoint</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>Onboard/Offboard configuration: Enabled (use onboarding blob)</li>
                        <li>Sample submission: Send safe samples automatically</li>
                        <li>Configure telemetry reporting: Enhanced</li>
                        <li>Allow anti-malware service to remain running: Normal priority</li>
                        <li>Type of consent for submitting data: Always prompt</li>
                        <li>Configure device tagging: VDI=1 (for Horizon clones)</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #fae8ff; border: 1px solid #9333ea;">
                    <h4 style="color: #6b21a8;">Credential Guard & Device Guard</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem; font-weight: 600; color: #dc2626;">⚠️ Consider excluding instant clones - Can cause performance impact on non-persistent VDI</p>
                    <ul style="font-size: 0.875rem;">
                        <li>Turn on Virtualization Based Security: Enabled</li>
                        <li>Platform Security Level: Secure Boot and DMA Protection</li>
                        <li>Credential Guard: Enabled with UEFI lock</li>
                        <li>Secure Launch: Enabled</li>
                        <li>Kernel-mode Hardware-enforced Stack Protection: Enabled in audit mode</li>
                    </ul>
                    <p style="font-size: 0.8125rem; margin-top: 0.5rem; font-style: italic; color: #6b7280;">
                        Note: Credential Guard requires nested virtualization which adds overhead. For instant clones, rely on UAG MFA and network isolation instead. Apply to physical endpoints and persistent VMs.
                    </p>
                </div>

                <div class="feature-box" style="background: #fef2f2; border: 1px solid #dc2626;">
                    <h4 style="color: #991b1b;">Windows Update & Servicing</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem; font-weight: 600; color: #dc2626;">⚠️ Apply to physical endpoints and persistent VMs only - NOT instant clones</p>
                    <ul style="font-size: 0.875rem;">
                        <li>Configure Automatic Updates: 4 - Auto download and schedule install</li>
                        <li>Scheduled install day: 0 - Every day</li>
                        <li>Allow Automatic Updates immediate installation: Enabled</li>
                        <li>No auto-restart with logged on users: Disabled</li>
                        <li>Specify deadline before auto-restart: 2 days for feature, 7 days for quality</li>
                        <li>Remove access to use all Windows Update features: Disabled</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 1px solid #f59e0b;">
                    <h4 style="color: #92400e;">Instant Clone Image Management</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem; font-weight: 600;">✅ For Horizon Instant Clone pools - Update via master image refresh</p>
                    <ul style="font-size: 0.875rem;">
                        <li><strong>Master Image Updates:</strong> Apply Windows updates to powered-off master VM monthly</li>
                        <li><strong>Testing:</strong> Power on master VM, install updates, test thoroughly before snapshot</li>
                        <li><strong>Snapshot:</strong> Take new snapshot of updated master VM with descriptive name (e.g., "Master_2025-01_Patched")</li>
                        <li><strong>Pool Configuration:</strong> Update instant clone pool to use new snapshot</li>
                        <li><strong>Recompose:</strong> Schedule recompose operation during maintenance window (deletes and recreates all clones)</li>
                        <li><strong>Verification:</strong> Verify clones boot properly and updates are applied via winver or systeminfo</li>
                        <li><strong>GPO Setting:</strong> Set "Configure Automatic Updates" to "2 - Notify for download and auto install" or "1 - Disabled" for instant clone OU</li>
                    </ul>
                    <p style="font-size: 0.8125rem; margin-top: 0.5rem; font-style: italic; color: #6b7280;">
                        Note: Instant clones are non-persistent and reset on logoff. Individual clones should never run Windows Update as changes are lost. All updates must be applied to the master image.
                    </p>
                </div>

                <div class="feature-box" style="background: #eff6ff; border: 1px solid #2563eb;">
                    <h4 style="color: #1e40af;">User Account Control (UAC)</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>Admin Approval Mode for Built-in Admin: Enabled</li>
                        <li>Behavior of elevation prompt for admins: Prompt for consent on secure desktop</li>
                        <li>Behavior of elevation prompt for standard users: Auto deny</li>
                        <li>Detect application installations: Enabled</li>
                        <li>Only elevate UIAccess apps in secure locations: Enabled</li>
                        <li>Run all administrators in Admin Approval Mode: Enabled</li>
                        <li>Virtualize file and registry write failures: Enabled</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 1px solid #059669;">
                    <h4 style="color: #065f46;">Privacy & Telemetry</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>Allow Telemetry: 1 - Basic (minimum for Defender)</li>
                        <li>Disable pre-release features: Enabled</li>
                        <li>Do not show feedback notifications: Enabled</li>
                        <li>Toggle user control over Insider builds: Disabled</li>
                        <li>Allow device name in diagnostic data: Enabled (for CMMC audit)</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 1px solid #f59e0b;">
                    <h4 style="color: #92400e;">Removable Storage & USB Control</h4>
                    <ul style="font-size: 0.875rem;">
                        <li>Removable Disks: Deny write access: Enabled (exceptions as needed)</li>
                        <li>All Removable Storage: Deny all access: Disabled (use allowlist)</li>
                        <li>Windows portable devices: Deny read access: Consider for CUI protection</li>
                        <li>Configure device installation by device ID: Allow only approved USB devices</li>
                        <li>Log USB connection events to Windows Event Log: Event ID 2003, 2004</li>
                    </ul>
                </div>
            </div>

            <h3 style="font-size: 1.25rem; font-weight: bold; margin: 2rem 0 1rem;">🖥️ Omnissa Horizon Agent Policies (for VDI Instant Clones)</h3>

            <div class="info-box info-blue" style="margin-bottom: 1rem;">
                <p style="font-size: 0.875rem;">
                    Configure Horizon Agent policies via Group Policy (ADM templates) or directly in Horizon Administrator. 
                    ADM templates: Download from Omnissa and import to Group Policy Management Console under Computer Configuration → Policies → Administrative Templates → Omnissa Horizon Agent Configuration
                </p>
            </div>

            <div class="grid-2">
                <div class="feature-box" style="background: #fef2f2; border: 1px solid #dc2626;">
                    <h4 style="color: #991b1b;">Screenshot Prevention (CUI Protection)</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem; font-weight: 600;">CMMC: AC.L2-3.1.23, SI.L2-3.14.9</p>
                    <ul style="font-size: 0.875rem;">
                        <li><strong>Policy Path:</strong> Omnissa Horizon Agent Configuration → Agent Security</li>
                        <li><strong>Setting:</strong> "Enable Screenshot Prevention" = Enabled</li>
                        <li><strong>Effect:</strong> Blocks screen capture via Print Screen key, Snipping Tool, and most third-party tools</li>
                        <li><strong>Alternative:</strong> Use Blast protocol watermarking to track screenshots if taken</li>
                        <li><strong>Note:</strong> Not 100% foolproof (camera photos still possible), but prevents casual exfiltration</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 1px solid #f59e0b;">
                    <h4 style="color: #92400e;">Client Drive Redirection (CDR)</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem; font-weight: 600;">CMMC: AC.L2-3.1.20, AC.L2-3.1.21</p>
                    <ul style="font-size: 0.875rem;">
                        <li><strong>Policy Path:</strong> Omnissa Horizon Agent Configuration → Client Drive Redirection</li>
                        <li><strong>Recommended Setting:</strong> "Enable Client Drive Redirection" = Disabled (for CUI environments)</li>
                        <li><strong>Alternative (if needed):</strong> Enable with "Read-Only" access:
                            <ul style="margin-left: 1rem; font-size: 0.8125rem;">
                                <li>"Allow Read Access" = Enabled</li>
                                <li>"Allow Write Access" = Disabled</li>
                                <li>"Allow Delete" = Disabled</li>
                            </ul>
                        </li>
                        <li><strong>Logging:</strong> Enable "Log Client Drive Redirection Events" to track file access attempts</li>
                        <li><strong>Effect:</strong> Prevents users from copying CUI data to local client drives</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #eff6ff; border: 1px solid #2563eb;">
                    <h4 style="color: #1e40af;">USB Device Redirection</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem; font-weight: 600;">CMMC: AC.L2-3.1.20, AC.L2-3.1.21, AU.L2-3.3.1</p>
                    <ul style="font-size: 0.875rem;">
                        <li><strong>Policy Path:</strong> Omnissa Horizon Agent Configuration → USB Configuration</li>
                        <li><strong>Base Policy:</strong> "Allow USB Access" = Disabled by default</li>
                        <li><strong>Exceptions - Allowlist Approach:</strong>
                            <ul style="margin-left: 1rem; font-size: 0.8125rem;">
                                <li>"USB Device Policy" = Block all devices except allowlist</li>
                                <li>Add specific devices by VID:PID (e.g., approved keyboards, mice, smartcard readers)</li>
                                <li>Example allowlist: Keyboard/Mouse, Smartcard readers for CAC/PIV, approved security tokens</li>
                            </ul>
                        </li>
                        <li><strong>Block Specifically:</strong>
                            <ul style="margin-left: 1rem; font-size: 0.8125rem;">
                                <li>USB mass storage devices (flash drives, external HDDs)</li>
                                <li>USB network adapters</li>
                                <li>USB cameras/webcams (unless business need)</li>
                                <li>USB audio devices (unless business need)</li>
                            </ul>
                        </li>
                        <li><strong>Logging:</strong> "Enable USB Redirection Logging" = Enabled
                            <ul style="margin-left: 1rem; font-size: 0.8125rem;">
                                <li>Logs: Event ID 2003 (device connected), 2004 (device disconnected)</li>
                                <li>Forward to Graylog for CMMC audit evidence</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 1px solid #059669;">
                    <h4 style="color: #065f46;">Printing Policies</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem; font-weight: 600;">CMMC: SI.L2-3.14.9, AU.L2-3.3.1</p>
                    <ul style="font-size: 0.875rem;">
                        <li><strong>Policy Path:</strong> Omnissa Horizon Agent Configuration → Printing</li>
                        <li><strong>Base Setting:</strong> "Enable Printer Redirection" = Enabled (with restrictions)</li>
                        <li><strong>Printer Allowlist:</strong>
                            <ul style="margin-left: 1rem; font-size: 0.8125rem;">
                                <li>"Auto-connect client printers" = Disabled</li>
                                <li>"Printer allowlist" = Enabled - specify approved printers by name/IP</li>
                                <li>Only allow printing to network printers in secure print rooms</li>
                            </ul>
                        </li>
                        <li><strong>CUI Watermarking:</strong>
                            <ul style="margin-left: 1rem; font-size: 0.8125rem;">
                                <li>Enable "Watermark printed documents" = Enabled</li>
                                <li>Configure watermark text: "CUI - USERNAME - DATE - CLASSIFICATION"</li>
                                <li>Position: Diagonal across page or in header/footer</li>
                            </ul>
                        </li>
                        <li><strong>Print Logging:</strong>
                            <ul style="margin-left: 1rem; font-size: 0.8125rem;">
                                <li>"Enable Print Job Logging" = Enabled</li>
                                <li>Logs: Username, document name, printer, page count, timestamp</li>
                                <li>Forward print events to Graylog for audit trail</li>
                            </ul>
                        </li>
                        <li><strong>Exceptions:</strong>
                            <ul style="margin-left: 1rem; font-size: 0.8125rem;">
                                <li>Allow specific users/groups to print via group membership</li>
                                <li>Require manager approval for CUI document printing (policy control)</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #fae8ff; border: 1px solid #9333ea;">
                    <h4 style="color: #6b21a8;">Clipboard & Copy/Paste</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem; font-weight: 600;">CMMC: AC.L2-3.1.23</p>
                    <ul style="font-size: 0.875rem;">
                        <li><strong>Policy Path:</strong> Omnissa Horizon Agent Configuration → Clipboard Redirection</li>
                        <li><strong>Recommended for CUI:</strong>
                            <ul style="margin-left: 1rem; font-size: 0.8125rem;">
                                <li>"Enable Copy/Paste" = Disabled (most secure)</li>
                                <li>OR "One-way Copy/Paste" = Enabled (VDI to client only, not client to VDI)</li>
                            </ul>
                        </li>
                        <li><strong>Alternative - Limited Copy/Paste:</strong>
                            <ul style="margin-left: 1rem; font-size: 0.8125rem;">
                                <li>"Maximum clipboard size" = 1 MB (prevents large file transfers)</li>
                                <li>"Clipboard format restrictions" = Text only (block images, files)</li>
                            </ul>
                        </li>
                        <li><strong>Logging:</strong> "Log Clipboard Events" = Enabled (monitor data transfers)</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 1px solid #f59e0b;">
                    <h4 style="color: #92400e;">Additional Data Loss Prevention</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.5rem; font-weight: 600;">CMMC: AC.L2-3.1.23, SI.L2-3.14.9</p>
                    <ul style="font-size: 0.875rem;">
                        <li><strong>Serial Port Redirection:</strong> Disable (blocks COM port access from client)</li>
                        <li><strong>Scanner Redirection:</strong> Disable (prevents document scanning to client)</li>
                        <li><strong>Webcam Redirection:</strong> Disable unless required for business (video calls only)</li>
                        <li><strong>HTML5 Multimedia Redirection:</strong> Disable or restrict (prevents browser-based data exfiltration)</li>
                        <li><strong>Real-Time Audio-Video (RTAV):</strong> Enable with caution - can be data channel</li>
                        <li><strong>Logging:</strong> Enable logging for all redirection features to track usage</li>
                    </ul>
                </div>
            </div>

            <div class="info-box info-yellow" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">⚙️ Policy Deployment Methods</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>Method 1 - Active Directory GPO (Recommended):</strong>
                        <ul style="margin-left: 1rem; font-size: 0.8125rem;">
                            <li>Download Omnissa Horizon Agent ADM/ADMX templates from Omnissa Product Downloads</li>
                            <li>Import templates to Group Policy Management Console (GPMC)</li>
                            <li>Create GPO targeting VDI instant clone OU</li>
                            <li>Configure policies under Computer Configuration → Administrative Templates → Omnissa Horizon Agent Configuration</li>
                        </ul>
                    </li>
                    <li><strong>Method 2 - Horizon Administrator UI:</strong>
                        <ul style="margin-left: 1rem; font-size: 0.8125rem;">
                            <li>Log into Horizon Administrator console</li>
                            <li>Navigate to Inventory → Pools → Select pool → Edit → Policies tab</li>
                            <li>Configure USB, printing, clipboard, and CDR policies</li>
                            <li>Note: UI policies override GPO settings</li>
                        </ul>
                    </li>
                    <li><strong>Method 3 - Registry (Manual/Script):</strong>
                        <ul style="margin-left: 1rem; font-size: 0.8125rem;">
                            <li>Apply registry settings to master image before snapshot</li>
                            <li>Registry path: HKLM\Software\Omnissa, Inc.\Omnissa VDM\Agent\Configuration</li>
                            <li>Less manageable but useful for quick testing</li>
                        </ul>
                    </li>
                </ul>
            </div>

            <div class="info-box info-green" style="margin-top: 1rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">✅ Testing & Validation</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>Test Pool:</strong> Create a test instant clone pool and apply policies incrementally</li>
                    <li><strong>User Impact:</strong> Assess productivity impact before blocking features like clipboard</li>
                    <li><strong>Exceptions Process:</strong> Document process for requesting exceptions (e.g., specific users need USB for CAC readers)</li>
                    <li><strong>Logging Verification:</strong> Verify all USB, print, clipboard, and CDR events appear in Graylog</li>
                    <li><strong>Policy Effectiveness:</strong> Attempt to bypass controls (screenshot, USB, copy/paste) to confirm they work</li>
                    <li><strong>Documentation:</strong> Document all policies and exceptions in CMMC System Security Plan (SSP)</li>
                </ul>
            </div>

            <div class="info-box info-purple" style="margin-top: 2rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">📋 GPO Deployment Strategy</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>OU Structure:</strong> Create separate OUs for VDI Instant Clones, Physical Endpoints, and Servers to apply appropriate GPOs to each</li>
                    <li><strong>VDI-Specific GPOs:</strong> DO NOT apply BitLocker, Credential Guard, or Device Guard to instant clone OU - these cause performance issues and conflicts with non-persistent desktops</li>
                    <li><strong>Testing:</strong> Apply GPOs to test OU first, monitor for 1-2 weeks before production rollout</li>
                    <li><strong>Logging:</strong> Enable GPO logging via Event Viewer (Application and Services Logs → Microsoft → Windows → GroupPolicy)</li>
                    <li><strong>Backup:</strong> Use Group Policy Management Console to backup all GPOs before making changes</li>
                    <li><strong>Documentation:</strong> Document all GPO settings in CMMC System Security Plan (SSP)</li>
                    <li><strong>Verification:</strong> Use gpresult /H report.html on test machines to verify policy application</li>
                    <li><strong>Monitoring:</strong> Forward Group Policy event logs (1501-1503, 1085-1089) to Graylog for compliance monitoring</li>
                </ul>
            </div>

            <div class="info-box info-green" style="margin-top: 1rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">🔍 CMMC Practices Covered by GPOs</h4>
                <p style="font-size: 0.875rem; margin-bottom: 0.5rem;">These Group Policy settings support the following CMMC Level 2 practices:</p>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>Access Control (AC):</strong> AC.L2-3.1.1 (limit system access), AC.L2-3.1.5 (least privilege), AC.L2-3.1.11 (session termination)</li>
                    <li><strong>Identification & Authentication (IA):</strong> IA.L2-3.5.5-3.5.7 (password policies), IA.L2-3.5.9 (secure password storage)</li>
                    <li><strong>System & Communications Protection (SC):</strong> SC.L2-3.13.8 (cryptographic protection), SC.L2-3.13.11 (cryptographic key management)</li>
                    <li><strong>System & Information Integrity (SI):</strong> SI.L2-3.14.2 (malicious code protection), SI.L2-3.14.4 (update malicious code protection)</li>
                    <li><strong>Configuration Management (CM):</strong> CM.L2-3.4.2 (establish baseline configurations), CM.L2-3.4.7 (restrict software installation)</li>
                </ul>
            </div>

            <h2 style="font-size: 1.75rem; font-weight: bold; margin: 3rem 0 1.5rem; color: #2563eb; border-bottom: 3px solid #2563eb; padding-bottom: 0.5rem;">📜 Automated Hardening Scripts</h2>

            <div class="info-box info-blue">
                <h3 style="font-weight: bold; margin-bottom: 0.5rem;">🚀 CMMC Level 2 Hardening Script Package</h3>
                <p style="font-size: 0.875rem; margin-bottom: 1rem;">
                    Comprehensive PowerShell and Bash scripts to automatically apply all GPO settings and security hardening for CMMC Level 2 compliance. 
                    All scripts include automatic backups, GPO/ADMX exports, detailed logging, and HTML compliance reports.
                </p>
                <div class="grid-2">
                    <div>
                        <h4 style="font-weight: 600; color: #2563eb; margin-bottom: 0.5rem;">✅ Key Features</h4>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>Automatic configuration backups before changes</li>
                            <li>GPO and ADMX template export</li>
                            <li>Comprehensive audit logging</li>
                            <li>HTML compliance reports for documentation</li>
                            <li>Rollback capability via backups</li>
                            <li>Dry-run/audit mode support</li>
                        </ul>
                    </div>
                    <div>
                        <h4 style="font-weight: 600; color: #059669; margin-bottom: 0.5rem;">🎯 Coverage</h4>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>Password policies (14 char, complexity, 60-day expiry)</li>
                            <li>Account lockout (5 attempts, 30 min)</li>
                            <li>SSH/RDP hardening with strong crypto</li>
                            <li>Advanced audit logging (auditd, Windows)</li>
                            <li>Firewall configuration and logging</li>
                            <li>USB/removable storage restrictions</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3 style="font-size: 1.25rem; font-weight: bold; margin: 2rem 0 1rem; color: #374151;">🪟 Windows PowerShell Scripts</h3>

            <div class="grid-2">
                <div class="feature-box" style="background: #eff6ff; border: 2px solid #2563eb;">
                    <h4 style="color: #1e40af; margin-bottom: 0.75rem;">1️⃣ Master-CMMC-GPO-Hardening.ps1</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem; color: #374151;">
                        Master orchestration script for all Windows GPO hardening with backup and export functionality.
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8;">
                        <li>✅ Automated GPO backup and ADMX export</li>
                        <li>✅ Supports DC, Server, Workstation hardening</li>
                        <li>✅ Generates comprehensive compliance reports</li>
                        <li>✅ Safe rollback via backup files</li>
                    </ul>
                    <div style="background: #1f2937; color: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-top: 0.75rem; font-family: monospace; font-size: 0.75rem; overflow-x: auto;">
.\Master-CMMC-GPO-Hardening.ps1 `
  -CreateBackup `
  -ExportADMX `
  -ApplyToDC `
  -BackupPath "C:\CMMC_Backups"
                    </div>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 2px solid #059669;">
                    <h4 style="color: #065f46; margin-bottom: 0.75rem;">2️⃣ Windows-Server-2025-CMMC-Hardening.ps1</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem; color: #374151;">
                        Windows Server 2025 specific hardening with Defender, BitLocker, and security controls.
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8;">
                        <li>✅ Windows Defender configuration</li>
                        <li>✅ Advanced Audit Policy (15+ categories)</li>
                        <li>✅ BitLocker enforcement</li>
                        <li>✅ Credential Guard & Device Guard</li>
                        <li>✅ Windows Update policies</li>
                        <li>✅ Removable storage controls</li>
                    </ul>
                    <div style="background: #1f2937; color: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-top: 0.75rem; font-family: monospace; font-size: 0.75rem; overflow-x: auto;">
.\Windows-Server-2025-CMMC-Hardening.ps1 `
  -TargetOU "OU=Servers,DC=domain,DC=com"
                    </div>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 2px solid #f59e0b;">
                    <h4 style="color: #92400e; margin-bottom: 0.75rem;">3️⃣ Windows-11-CMMC-Hardening.ps1</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem; color: #374151;">
                        Windows 11 Enterprise workstation hardening with VDI instant clone support.
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8;">
                        <li>✅ Exploit Guard & 12 ASR rules</li>
                        <li>✅ Windows Defender Application Control</li>
                        <li>✅ VDI mode (skips BitLocker/Credential Guard)</li>
                        <li>✅ Defender for Endpoint integration</li>
                        <li>✅ Network Protection & Controlled Folders</li>
                    </ul>
                    <div style="background: #1f2937; color: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-top: 0.75rem; font-family: monospace; font-size: 0.75rem; overflow-x: auto;">
# Physical/Persistent Workstations
.\Windows-11-CMMC-Hardening.ps1 `
  -TargetOU "OU=Workstations,DC=domain,DC=com"

# VDI Instant Clones (no BitLocker/CredGuard)
.\Windows-11-CMMC-Hardening.ps1 `
  -TargetOU "OU=VDI,DC=domain,DC=com" `
  -IsVDIInstantClone
                    </div>
                </div>

                <div class="feature-box" style="background: #faf5ff; border: 2px solid #9333ea;">
                    <h4 style="color: #6b21a8; margin-bottom: 0.75rem;">4️⃣ Omnissa-Horizon-CMMC-Hardening.ps1</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem; color: #374151;">
                        Omnissa Horizon Agent policy configuration with ADM template deployment.
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8;">
                        <li>✅ USB redirection controls (disabled for CMMC)</li>
                        <li>✅ Clipboard & file transfer restrictions</li>
                        <li>✅ Display protocol security (Blast Extreme)</li>
                        <li>✅ ADM template deployment automation</li>
                        <li>✅ Session management & timeouts</li>
                        <li>✅ Defender for Endpoint integration</li>
                    </ul>
                    <div style="background: #1f2937; color: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-top: 0.75rem; font-family: monospace; font-size: 0.75rem; overflow-x: auto;">
.\Omnissa-Horizon-CMMC-Hardening.ps1 `
  -TargetOU "OU=VDI-Clones,DC=domain,DC=com" `
  -HorizonADMPath "C:\Horizon_ADM" `
  -DeployADMTemplates
                    </div>
                </div>
            </div>

            <h3 style="font-size: 1.25rem; font-weight: bold; margin: 2rem 0 1rem; color: #374151;">🐧 Linux Bash Script</h3>

            <div class="feature-box" style="background: linear-gradient(135deg, #f0fdf4 0%, #eff6ff 100%); border: 2px solid #059669;">
                <h4 style="color: #065f46; margin-bottom: 0.75rem;">5️⃣ Linux-CMMC-Hardening.sh</h4>
                <p style="font-size: 0.875rem; margin-bottom: 0.75rem; color: #374151;">
                    Universal Linux hardening script supporting Ubuntu 24, CentOS, RHEL, and Rocky Linux.
                </p>
                <div class="grid-2" style="margin-bottom: 0.75rem;">
                    <div>
                        <h5 style="font-weight: 600; font-size: 0.8125rem; margin-bottom: 0.5rem; color: #059669;">System Hardening</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.8;">
                            <li>✅ Password policy (PAM, pwquality)</li>
                            <li>✅ Account lockout (faillock)</li>
                            <li>✅ SSH hardening (strong ciphers, no root)</li>
                            <li>✅ Kernel parameters (sysctl)</li>
                            <li>✅ Firewall (UFW/firewalld)</li>
                            <li>✅ SELinux/AppArmor enforcement</li>
                        </ul>
                    </div>
                    <div>
                        <h5 style="font-weight: 600; font-size: 0.8125rem; margin-bottom: 0.5rem; color: #2563eb;">Audit & Logging</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.8;">
                            <li>✅ Auditd with CMMC rules</li>
                            <li>✅ File access monitoring</li>
                            <li>✅ Authentication logging</li>
                            <li>✅ Privilege use tracking</li>
                            <li>✅ Network configuration auditing</li>
                            <li>✅ HTML compliance report</li>
                        </ul>
                    </div>
                </div>
                <div style="background: #1f2937; color: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; font-family: monospace; font-size: 0.75rem; overflow-x: auto;">
# Make executable
chmod +x Linux-CMMC-Hardening.sh

# Run with full hardening
sudo ./Linux-CMMC-Hardening.sh --backup-path /root/cmmc_backup

# Audit only (no changes)
sudo ./Linux-CMMC-Hardening.sh --audit-only

# Skip firewall or SELinux
sudo ./Linux-CMMC-Hardening.sh --skip-firewall --skip-selinux
                </div>
            </div>

            <h3 style="font-size: 1.25rem; font-weight: bold; margin: 2rem 0 1rem; color: #374151;">📊 Generated Output Files</h3>

            <div class="grid-2">
                <div class="info-box info-blue">
                    <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Windows Output Structure</h4>
                    <div style="background: #1f2937; color: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; font-family: monospace; font-size: 0.75rem; overflow-x: auto; line-height: 1.6;">
C:\CMMC_GPO_Backups\
├── GPO_Backups\
│   ├── {GPO-GUID}\
│   │   ├── bkupInfo.xml
│   │   ├── gpreport.xml
│   │   └── DomainSysvol\
├── ADMX_Templates\
│   ├── *.admx
│   └── en-US\*.adml
├── Reports\
│   ├── GPO_Backup_Report.csv
│   ├── GPO_Backup_Report.html
│   ├── ADMX_Inventory.csv
│   └── CMMC_GPO_Report.html
└── Execution_Log.txt
                    </div>
                </div>

                <div class="info-box info-green">
                    <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Linux Output Structure</h4>
                    <div style="background: #1f2937; color: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; font-family: monospace; font-size: 0.75rem; overflow-x: auto; line-height: 1.6;">
/root/cmmc_backup_[timestamp]/
├── configs/
│   ├── sshd_config.backup
│   ├── login.defs.backup
│   └── ...
├── logs/
│   └── hardening.log
├── original_files/
│   ├── sshd_config
│   ├── pam.d/
│   └── ...
└── CMMC_Linux_Hardening_Report.html
                    </div>
                </div>
            </div>

            <h3 style="font-size: 1.25rem; font-weight: bold; margin: 2rem 0 1rem; color: #374151;">✅ Post-Hardening Verification</h3>

            <div class="grid-2">
                <div class="code-block">
                    <div class="code-header">Windows Verification Commands</div>
                    <div class="code-content"># Force GPO update on target systems
gpupdate /force

# Generate GPO result report
gpresult /h gpresult.html

# View applied GPOs
Get-GPResultantSetOfPolicy -ReportType Html -Path "C:\GPOResults.html"

# Verify audit policy
auditpol /get /category:*

# Check BitLocker status
Get-BitLockerVolume

# Verify Firewall
Get-NetFirewallProfile

# Check Defender status
Get-MpComputerStatus

# Verify specific GPO settings
Get-GPRegistryValue -Name "CMMC-WindowsServer2025-Hardening" `
  -Key "HKLM\Software\Policies\Microsoft\Windows Defender"</div>
                </div>

                <div class="code-block">
                    <div class="code-header">Linux Verification Commands</div>
                    <div class="code-content"># Check SSH configuration
sudo sshd -t
sudo sshd -T

# Verify firewall
sudo ufw status verbose        # Ubuntu/Debian
sudo firewall-cmd --list-all   # CentOS/RHEL

# Check auditd
sudo systemctl status auditd
sudo auditctl -l

# Verify SELinux
sestatus                       # CentOS/RHEL

# Check AppArmor
sudo aa-status                 # Ubuntu/Debian

# Test password policy
sudo pwscore <<< "TestPassword123!"

# View recent audit logs
sudo ausearch -ts recent

# Check kernel parameters
sudo sysctl -a | grep -E "net.ipv4|kernel"</div>
                </div>
            </div>

            <div class="info-box info-yellow" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">⚠️ Important Notes Before Running</h4>
                <ol style="font-size: 0.875rem; line-height: 1.8; margin-left: 1.5rem;">
                    <li><strong>Test in Non-Production First:</strong> Always validate in a lab environment before production deployment</li>
                    <li><strong>Create Full System Backups:</strong> Beyond script backups, ensure you have full VM/system snapshots</li>
                    <li><strong>Review Organizational Policies:</strong> Ensure settings align with your internal security requirements</li>
                    <li><strong>Plan Maintenance Windows:</strong> Some changes require system reboots and service restarts</li>
                    <li><strong>VDI Instant Clone Considerations:</strong> Use -IsVDIInstantClone flag to skip BitLocker/Credential Guard</li>
                    <li><strong>SSH Key Distribution:</strong> For Linux, distribute SSH keys before disabling password authentication</li>
                    <li><strong>Horizon ADM Templates:</strong> Download from Omnissa before running Horizon hardening script</li>
                    <li><strong>Domain Admin Rights Required:</strong> Windows scripts must run with Domain Admin privileges on a DC</li>
                </ol>
            </div>

            <div class="info-box info-purple" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">📚 Documentation Included</h4>
                <div class="grid-2">
                    <div>
                        <p style="font-size: 0.875rem; margin-bottom: 0.5rem;"><strong>README.md (16 KB)</strong></p>
                        <ul style="font-size: 0.8125rem; line-height: 1.8;">
                            <li>Complete documentation for all scripts</li>
                            <li>Parameter reference tables</li>
                            <li>Step-by-step usage instructions</li>
                            <li>Troubleshooting guide</li>
                            <li>CMMC practices mapping</li>
                            <li>Rollback procedures</li>
                        </ul>
                    </div>
                    <div>
                        <p style="font-size: 0.875rem; margin-bottom: 0.5rem;"><strong>QUICKSTART.md (4 KB)</strong></p>
                        <ul style="font-size: 0.8125rem; line-height: 1.8;">
                            <li>Quick reference guide</li>
                            <li>Common command examples</li>
                            <li>Prerequisites checklist</li>
                            <li>Output file descriptions</li>
                            <li>CMMC practices summary</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="info-box info-green" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">🎯 CMMC Level 2 Practices Covered by Hardening Scripts</h4>
                <div class="grid-2">
                    <div>
                        <p style="font-size: 0.875rem; margin-bottom: 0.5rem; font-weight: 600;">Access Control (AC)</p>
                        <ul style="font-size: 0.8125rem; line-height: 1.8;">
                            <li>AC.L2-3.1.1: Authorized Access Control</li>
                            <li>AC.L2-3.1.2: Limit Information System Access</li>
                            <li>AC.L2-3.1.3: Control Information Flow</li>
                            <li>AC.L2-3.1.5: Least Privilege</li>
                            <li>AC.L2-3.1.7: Unsuccessful Logon Attempts</li>
                            <li>AC.L2-3.1.20: External Connections</li>
                        </ul>
                        
                        <p style="font-size: 0.875rem; margin: 0.75rem 0 0.5rem; font-weight: 600;">Audit & Accountability (AU)</p>
                        <ul style="font-size: 0.8125rem; line-height: 1.8;">
                            <li>AU.L2-3.3.1: System Auditing</li>
                            <li>AU.L2-3.3.2: Security-relevant Events</li>
                            <li>AU.L2-3.3.3: Audit Review and Analysis</li>
                            <li>AU.L2-3.3.8: Audit Information Protection</li>
                        </ul>
                        
                        <p style="font-size: 0.875rem; margin: 0.75rem 0 0.5rem; font-weight: 600;">Configuration Management (CM)</p>
                        <ul style="font-size: 0.8125rem; line-height: 1.8;">
                            <li>CM.L2-3.4.2: Security Configuration Settings</li>
                            <li>CM.L2-3.4.6: Least Functionality</li>
                            <li>CM.L2-3.4.8: Application Execution Control</li>
                        </ul>
                    </div>
                    <div>
                        <p style="font-size: 0.875rem; margin-bottom: 0.5rem; font-weight: 600;">Identification & Authentication (IA)</p>
                        <ul style="font-size: 0.8125rem; line-height: 1.8;">
                            <li>IA.L2-3.5.1: Identification and Authentication</li>
                            <li>IA.L2-3.5.2: Multi-factor Authentication</li>
                            <li>IA.L2-3.5.3: Replay-resistant Authentication</li>
                            <li>IA.L2-3.5.7: Cryptographic Module Authentication</li>
                        </ul>
                        
                        <p style="font-size: 0.875rem; margin: 0.75rem 0 0.5rem; font-weight: 600;">System & Communications Protection (SC)</p>
                        <ul style="font-size: 0.8125rem; line-height: 1.8;">
                            <li>SC.L2-3.13.1: Boundary Protection</li>
                            <li>SC.L2-3.13.5: Public Access Protection</li>
                            <li>SC.L2-3.13.8: Session Lock</li>
                            <li>SC.L2-3.13.11: Cryptographic Protection</li>
                        </ul>
                        
                        <p style="font-size: 0.875rem; margin: 0.75rem 0 0.5rem; font-weight: 600;">System & Information Integrity (SI)</p>
                        <ul style="font-size: 0.8125rem; line-height: 1.8;">
                            <li>SI.L2-3.14.1: Flaw Remediation</li>
                            <li>SI.L2-3.14.2: Malicious Code Protection</li>
                            <li>SI.L2-3.14.4: Update Management</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="info-box" style="background: linear-gradient(135deg, #eff6ff 0%, #f0fdf4 100%); border: 2px solid #2563eb; margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem; color: #1e40af;">📥 Download Hardening Scripts Package</h4>
                <p style="font-size: 0.875rem; margin-bottom: 1rem;">
                    All scripts are production-ready and include comprehensive documentation, automatic backups, and compliance reporting.
                </p>
                <div class="grid-2">
                    <div style="background: white; padding: 1rem; border-radius: 0.5rem; border: 1px solid #e5e7eb;">
                        <h5 style="font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Package Contents (7 files)</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.8;">
                            <li>✅ Master-CMMC-GPO-Hardening.ps1 (17 KB)</li>
                            <li>✅ Windows-Server-2025-CMMC-Hardening.ps1 (16 KB)</li>
                            <li>✅ Windows-11-CMMC-Hardening.ps1 (16 KB)</li>
                            <li>✅ Omnissa-Horizon-CMMC-Hardening.ps1 (19 KB)</li>
                            <li>✅ Linux-CMMC-Hardening.sh (32 KB)</li>
                            <li>✅ README.md (16 KB) - Complete documentation</li>
                            <li>✅ QUICKSTART.md (4 KB) - Quick reference</li>
                        </ul>
                    </div>
                    <div style="background: white; padding: 1rem; border-radius: 0.5rem; border: 1px solid #e5e7eb;">
                        <h5 style="font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Total Package Size</h5>
                        <p style="font-size: 2rem; font-weight: bold; color: #2563eb; margin: 0.5rem 0;">~120 KB</p>
                        <p style="font-size: 0.8125rem; color: #6b7280; margin-bottom: 1rem;">All scripts + documentation</p>
                        <p style="font-size: 0.875rem; font-weight: 600; color: #059669; margin-bottom: 0.5rem;">
                            💾 Scripts available in the implementation package
                        </p>
                        <p style="font-size: 0.8125rem; color: #6b7280;">
                            Contact your CMMC implementation team for access to the complete hardening scripts package.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <div id="queries" class="tab-content">
            <div class="info-box info-purple">
                <h3 style="font-weight: bold; margin-bottom: 0.5rem;">CMMC Compliance Queries</h3>
                <p style="font-size: 0.875rem;">
                    Pre-built queries for Graylog and Azure Log Analytics. Copy-paste ready for implementation.
                </p>
            </div>

            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h3 style="font-size: 1.125rem; font-weight: bold; margin: 0;">Graylog Queries</h3>
                <div style="display: flex; gap: 0.5rem;">
                    <button onclick="expandAllSections()" style="background: #2563eb; color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.375rem; font-size: 0.875rem; font-weight: 600; cursor: pointer; transition: background 0.2s;">
                        Expand All
                    </button>
                    <button onclick="collapseAllSections()" style="background: #6b7280; color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.375rem; font-size: 0.875rem; font-weight: 600; cursor: pointer; transition: background 0.2s;">
                        Collapse All
                    </button>
                </div>
            </div>
            
            <div class="collapsible-header first-collapsible" onclick="toggleCollapsible(this)">
                <span class="collapsible-title">📡 Network & NetFlow Queries</span>
                <span class="collapsible-icon">▼</span>
            </div>
            <div class="collapsible-content">
            
            <div class="query-block">
                <div class="query-header">🔍 Large Data Transfers (>100MB)</div>
                <div class="query-content">netflow_bytes:>100000000</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Suspicious Ports (FTP, Telnet, SMB, RDP, SQL)</div>
                <div class="query-content">netflow_dst_port:(21 23 69 135 139 445 1433 3306 3389)</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 External Connections (Non-RFC1918)</div>
                <div class="query-content">netflow_dst_ip:* NOT netflow_dst_ip:(192.168.0.0/16 OR 10.0.0.0/8 OR 172.16.0.0/12)</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Data Exfiltration Detection (>50MB Sent)</div>
                <div class="query-content">netflow_bytes_sent:>50000000 AND NOT netflow_dst_ip:(192.168.0.0/16 OR 10.0.0.0/8)</div>
            </div>
            </div>

            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                <span class="collapsible-title">🖥️ VDI & Remote Access Queries</span>
                <span class="collapsible-icon">▼</span>
            </div>
            <div class="collapsible-content">

            <div class="query-block">
                <div class="query-header">🔍 Horizon Failed Login Attempts</div>
                <div class="query-content">source:"horizon" AND (VLSI_AUTHENTICATION_FAILED OR BROKER_AUTHENTICATION_FAILED)</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 VDI USB Device Usage</div>
                <div class="query-content">source:"horizon" AND USB_PLUGGED</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 UAG External Access (Non-Internal IPs)</div>
                <div class="query-content">source:"uag" AND AUTH AND NOT src_ip:(192.168.0.0/16 OR 10.0.0.0/8)</div>
            </div>

            </div>

            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                <span class="collapsible-title">🪟 Windows Security Event Queries</span>
                <span class="collapsible-icon">▼</span>
            </div>
            <div class="collapsible-content">

            <div class="query-block">
                <div class="query-header">🔍 Failed Windows Logins (Event 4625)</div>
                <div class="query-content">source:"windows" AND event_id:4625</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Successful Privileged Logins (Event 4672)</div>
                <div class="query-content">source:"windows" AND event_id:4672</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Account Lockouts (Event 4740)</div>
                <div class="query-content">source:"windows" AND event_id:4740</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 New User Account Created (Event 4720)</div>
                <div class="query-content">source:"windows" AND event_id:4720</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 User Added to Privileged Group (Events 4728, 4732, 4756)</div>
                <div class="query-content">source:"windows" AND event_id:(4728 OR 4732 OR 4756)</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Password Changes (Event 4724)</div>
                <div class="query-content">source:"windows" AND event_id:4724</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Audit Policy Changes (Event 4719)</div>
                <div class="query-content">source:"windows" AND event_id:4719</div>
            </div>

            </div>

            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                <span class="collapsible-title">🕵️ Insider Threat & Anomaly Detection</span>
                <span class="collapsible-icon">▼</span>
            </div>
            <div class="collapsible-content">

            <div class="query-block">
                <div class="query-header">🔍 After-Hours Access (Outside 6 AM - 8 PM)</div>
                <div class="query-content">* AND NOT timestamp:[06:00:00 TO 20:00:00]</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Weekend Access Attempts</div>
                <div class="query-content">* AND day_of_week:(6 OR 0)</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Multiple Failed Logins from Same User (>5 attempts)</div>
                <div class="query-content">source:"windows" AND event_id:4625 | stats count() by username | where count > 5</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Unusual Data Volume from Single Host (>500MB)</div>
                <div class="query-content">netflow_bytes_sent:>10000000 | stats sum(netflow_bytes_sent) by src_ip | where sum > 500000000</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Multiple VDI Sessions from Different Locations</div>
                <div class="query-content">source:"horizon" AND event_type:"session_start" | stats dc(src_ip) by username | where dc > 2</div>
            </div>

            </div>

            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                <span class="collapsible-title">🔥 Network Security & Firewall Queries</span>
                <span class="collapsible-icon">▼</span>
            </div>
            <div class="collapsible-content">

            <div class="query-block">
                <div class="query-header">🔍 Firewall Deny/Block Events</div>
                <div class="query-content">source:"firewall" AND (action:"deny" OR action:"block" OR action:"drop")</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 IDS/IPS Alerts (High/Critical Severity)</div>
                <div class="query-content">source:"ids" AND (severity:"high" OR severity:"critical")</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 DNS Queries to Suspicious TLDs</div>
                <div class="query-content">source:"dns" AND (query:*.tk OR query:*.ml OR query:*.ga OR query:*dyndns* OR query:*no-ip*)</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Port Scanning Activity (>50 unique ports from single source)</div>
                <div class="query-content">netflow_dst_port:* | stats dc(netflow_dst_port) by src_ip | where dc > 50</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Outbound Connections on Non-Standard Ports</div>
                <div class="query-content">netflow_dst_port:* NOT netflow_dst_port:(80 OR 443 OR 53 OR 22 OR 25) AND NOT netflow_dst_ip:(192.168.0.0/16 OR 10.0.0.0/8 OR 172.16.0.0/12)</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Beaconing Behavior (Regular Intervals)</div>
                <div class="query-content">netflow_* | stats count() by src_ip, dst_ip, dst_port, hour | where count > 10</div>
            </div>

            </div>

            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                <span class="collapsible-title">⚙️ System & Configuration Change Queries</span>
                <span class="collapsible-icon">▼</span>
            </div>
            <div class="collapsible-content">

            <div class="query-block">
                <div class="query-header">🔍 Service Starts/Stops (Events 7036, 7040)</div>
                <div class="query-content">source:"windows" AND event_id:(7036 OR 7040)</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 System Reboots/Shutdowns (Events 1074, 6006, 6008)</div>
                <div class="query-content">source:"windows" AND event_id:(1074 OR 6006 OR 6008)</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Firewall Rule Changes</div>
                <div class="query-content">source:"firewall" AND (action:"modify" OR action:"create" OR action:"delete") AND object_type:"rule"</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 GPO Changes (Event 4662)</div>
                <div class="query-content">source:"windows" AND event_id:4662 AND object_type:"groupPolicyContainer"</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Scheduled Task Creation/Modification (Events 4698, 4702)</div>
                <div class="query-content">source:"windows" AND event_id:(4698 OR 4702)</div>
            </div>

            </div>

            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                <span class="collapsible-title">🗄️ Data Protection & File Access Queries</span>
                <span class="collapsible-icon">▼</span>
            </div>
            <div class="collapsible-content">

            <div class="query-block">
                <div class="query-header">🔍 File Share Access to Sensitive Data (Event 5145)</div>
                <div class="query-content">source:"windows" AND event_id:5145 AND (share_name:*CUI* OR share_name:*Confidential*)</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 File Deletion Events (Event 4663)</div>
                <div class="query-content">source:"windows" AND event_id:4663 AND accesses:"DELETE"</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Bulk File Operations (>100 files)</div>
                <div class="query-content">source:"windows" AND event_id:5145 | stats count() by username, src_ip | where count > 100</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 USB Device Usage</div>
                <div class="query-content">source:"windows" AND (event_id:6416 OR event_id:4663) AND device_type:"USB"</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Printer Usage Tracking</div>
                <div class="query-content">source:"windows" AND event_id:307</div>
            </div>

            </div>

            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                <span class="collapsible-title">🛡️ Microsoft Defender EDR Queries</span>
                <span class="collapsible-icon">▼</span>
            </div>
            <div class="collapsible-content">

            <div class="query-block">
                <div class="query-header">🔍 Malware Detections (High/Critical)</div>
                <div class="query-content">source:"defender_edr" AND _event_type:"alert" AND (_severity:"high" OR _severity:"critical")</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Lateral Movement Tools (PsExec, WMIC, PowerShell)</div>
                <div class="query-content">source:"defender_edr" AND (_process_name:"psexec.exe" OR _process_name:"wmic.exe" OR _process_name:"powershell.exe")</div>
            </div>

            <h3 style="font-size: 1.125rem; font-weight: bold; margin: 2rem 0 1rem;">Azure Log Analytics KQL Queries</h3>

            <div class="query-block">
                <div class="query-header">🔍 Failed AAD Login Attempts (>5 attempts)</div>
                <div class="query-content azure">SigninLogs
| where TimeGenerated > ago(24h)
| where ResultType != "0"
| summarize FailedAttempts = count() by UserPrincipalName, IPAddress
| where FailedAttempts > 5
| order by FailedAttempts desc</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 MFA Compliance Check</div>
                <div class="query-content azure">SigninLogs
| where TimeGenerated > ago(7d)
| extend MFAUsed = iff(AuthenticationRequirement == "multiFactorAuthentication", "Yes", "No")
| summarize TotalLogins = count(), MFALogins = countif(MFAUsed == "Yes") by UserPrincipalName
| where MFALogins < TotalLogins</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Risky Sign-ins (High/Medium Risk)</div>
                <div class="query-content azure">SigninLogs
| where TimeGenerated > ago(24h)
| where RiskLevelDuringSignIn in ("high", "medium")
| order by TimeGenerated desc</div>
            </div>


            <div class="query-block">
                <div class="query-header">🔍 Microsoft Defender EDR Alerts (High/Critical)</div>
                <div class="query-content azure">DeviceEvents
| where TimeGenerated > ago(24h)
| where ActionType has_any ("AlertCreated", "ThreatDetected")
| where Severity in ("High", "Critical")
| project TimeGenerated, DeviceName, ActionType, Severity, ThreatFamily, FileName
| order by TimeGenerated desc</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Suspicious PowerShell Execution</div>
                <div class="query-content azure">DeviceProcessEvents
| where TimeGenerated > ago(24h)
| where FileName =~ "powershell.exe" or FileName =~ "pwsh.exe"
| where ProcessCommandLine has_any ("-enc", "-encodedcommand", "invoke-expression", "downloadstring", "bypass")
| project TimeGenerated, DeviceName, AccountName, ProcessCommandLine
| order by TimeGenerated desc</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Lateral Movement Detection (PsExec, WMI, Remote PowerShell)</div>
                <div class="query-content azure">DeviceProcessEvents
| where TimeGenerated > ago(24h)
| where FileName in~ ("psexec.exe", "wmic.exe", "winrs.exe")
   or ProcessCommandLine has_any ("powershell -Computer", "invoke-command -Computer")
| project TimeGenerated, DeviceName, AccountName, FileName, ProcessCommandLine
| order by TimeGenerated desc</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Microsoft Purview DLP Policy Violations</div>
                <div class="query-content azure">DLPAuditLogs
| where TimeGenerated > ago(24h)
| where Operation == "DLPRuleMatch"
| where Severity in ("High", "Medium")
| project TimeGenerated, UserPrincipalName, Operation, Severity, PolicyName, RuleName, SensitiveInfoTypes
| order by TimeGenerated desc</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Conditional Access Policy Failures</div>
                <div class="query-content azure">SigninLogs
| where TimeGenerated > ago(24h)
| where ConditionalAccessStatus != "success"
| project TimeGenerated, UserPrincipalName, IPAddress, AppDisplayName, ConditionalAccessStatus, ConditionalAccessPolicies
| order by TimeGenerated desc</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Privileged Role Activations (PIM)</div>
                <div class="query-content azure">AuditLogs
| where TimeGenerated > ago(7d)
| where OperationName == "Add member to role completed (PIM activation)"
| project TimeGenerated, Identity, TargetResources, ResultDescription
| order by TimeGenerated desc</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Azure AD Account Changes</div>
                <div class="query-content azure">AuditLogs
| where TimeGenerated > ago(24h)
| where OperationName has_any ("Add user", "Delete user", "Update user", "Reset password")
| project TimeGenerated, OperationName, Identity, TargetResources
| order by TimeGenerated desc</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 Impossible Travel Detection</div>
                <div class="query-content azure">SigninLogs
| where TimeGenerated > ago(24h)
| where ResultType == "0"
| extend Location1 = tostring(LocationDetails.city)
| summarize Locations = make_set(Location1), LocationCount = dcount(Location1) by UserPrincipalName, bin(TimeGenerated, 1h)
| where LocationCount > 1
| order by TimeGenerated desc</div>
            </div>

            <div class="query-block">
                <div class="query-header">🔍 File Downloads from SharePoint/OneDrive</div>
                <div class="query-content azure">OfficeActivity
| where TimeGenerated > ago(24h)
| where Operation == "FileDownloaded"
| where SourceFileExtension in ("docx", "xlsx", "pdf", "pptx")
| project TimeGenerated, UserId, Operation, OfficeObjectId, SourceFileName, ClientIP
| order by TimeGenerated desc</div>
            </div>

            <h3 style="font-size: 1.125rem; font-weight: bold; margin: 2rem 0 1rem;">Graylog Pipelines & Grok Patterns</h3>
            
            <div class="info-box info-purple">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Log Normalization & Enrichment</h4>
                <p style="font-size: 0.875rem;">
                    Pipelines and Grok patterns to normalize SMB file access logs, NetFlow data, and Azure Log Analytics exports 
                    into standardized fields for unified searching and correlation.
                </p>
            </div>

            </div>

            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                <span class="collapsible-title">📂 SMB File Access Grok Pattern</span>
                <span class="collapsible-icon">▼</span>
            </div>
            <div class="collapsible-content">
            
            <div class="code-block">
                <div class="code-header">Grok Pattern: SMB_FILE_ACCESS</div>
                <div class="code-content"># Pattern Name: SMB_FILE_ACCESS
# Description: Parses Windows Security Event 5140 (File Share Access) and 5145 (File Access)

# For Event ID 5140 (Share Access)
SMB_SHARE_ACCESS %{TIMESTAMP_ISO8601:timestamp}\s+%{WORD:event_id}\s+%{DATA:computer_name}\s+Account Name:\s+%{USERNAME:username}\s+Account Domain:\s+%{DATA:domain}\s+Share Name:\s+\\\\%{DATA:share_path}\s+Share Path:\s+%{DATA:share_full_path}\s+Access Mask:\s+%{BASE16NUM:access_mask}\s+Source Address:\s+%{IP:source_ip}\s+Source Port:\s+%{NUMBER:source_port}

# For Event ID 5145 (Detailed File Access)
SMB_FILE_ACCESS %{TIMESTAMP_ISO8601:timestamp}\s+%{WORD:event_id}\s+%{DATA:computer_name}\s+Subject:\s+Security ID:\s+%{DATA:subject_sid}\s+Account Name:\s+%{USERNAME:username}\s+Account Domain:\s+%{DATA:domain}\s+Logon ID:\s+%{DATA:logon_id}\s+Object:\s+Object Type:\s+%{WORD:object_type}\s+Object Name:\s+%{DATA:file_path}\s+Handle ID:\s+%{DATA:handle_id}\s+Access Request Information:\s+Accesses:\s+%{DATA:access_type}\s+Access Mask:\s+%{BASE16NUM:access_mask}\s+Network Information:\s+Source Address:\s+%{IP:source_ip}\s+Source Port:\s+%{NUMBER:source_port}

# Simplified pattern for syslog format
SMB_SYSLOG %{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:hostname} %{DATA:process}: EventID=%{NUMBER:event_id} User=%{USERNAME:username} Domain=%{DATA:domain} File=%{DATA:file_path} SourceIP=%{IP:source_ip} Action=%{WORD:action}</div>
            </div>

            <div class="code-block" style="margin-top: 1rem;">
                <div class="code-header">Pipeline: SMB File Access Normalization</div>
                <div class="code-content">rule "Normalize SMB File Access Logs"
when
    has_field("event_id") AND (to_string($message.event_id) == "5140" OR to_string($message.event_id) == "5145")
then
    // Extract file extension
    let file_path = to_string($message.file_path);
    let extension = regex("\\.(\\w+)$", file_path);
    set_field("file_extension", extension["1"]);
    
    // Categorize access type
    let access_mask = to_string($message.access_mask);
    let access_type = "";
    
    // 0x1 = ReadData, 0x2 = WriteData, 0x4 = AppendData, 0x10000 = Delete
    if (access_mask == "0x1" OR access_mask == "0x120089") then
        access_type = "READ";
    else if (access_mask == "0x2" OR access_mask == "0x4") then
        access_type = "WRITE";
    else if (access_mask == "0x10000") then
        access_type = "DELETE";
    else
        access_type = "OTHER";
    end
    
    set_field("smb_access_category", access_type);
    
    // Flag sensitive file extensions
    let sensitive_extensions = ["docx", "xlsx", "pdf", "pptx", "zip", "7z", "rar", "sql", "bak"];
    if (contains(value: sensitive_extensions, search: to_string($message.file_extension))) then
        set_field("sensitive_file", true);
    end
    
    // Flag external access (non RFC1918)
    let src_ip = to_string($message.source_ip);
    if (NOT cidr_match("10.0.0.0/8", to_ip(src_ip)) AND 
        NOT cidr_match("172.16.0.0/12", to_ip(src_ip)) AND 
        NOT cidr_match("192.168.0.0/16", to_ip(src_ip))) then
        set_field("external_access", true);
        set_field("alert_severity", "high");
    end
    
    // Add normalized source type
    set_field("log_source", "smb_file_access");
    set_field("normalized", true);
end</div>
            </div>

            </div>

            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                <span class="collapsible-title">🌊 NetFlow Grok Pattern</span>
                <span class="collapsible-icon">▼</span>
            </div>
            <div class="collapsible-content">

            <div class="code-block">
                <div class="code-header">Grok Pattern: NETFLOW_V9</div>
                <div class="code-content"># Pattern Name: NETFLOW_V9
# Description: Parses NetFlow v9 exports from network devices

NETFLOW_V9 %{TIMESTAMP_ISO8601:timestamp}\s+src_ip=%{IP:src_ip}\s+dst_ip=%{IP:dst_ip}\s+src_port=%{NUMBER:src_port}\s+dst_port=%{NUMBER:dst_port}\s+protocol=%{NUMBER:protocol}\s+bytes=%{NUMBER:bytes}\s+packets=%{NUMBER:packets}\s+flow_duration=%{NUMBER:duration}\s+tcp_flags=%{BASE16NUM:tcp_flags}

# Alternative pattern for sFlow
SFLOW %{TIMESTAMP_ISO8601:timestamp}\s+%{IP:agent_ip}\s+input=%{NUMBER:input_if}\s+output=%{NUMBER:output_if}\s+src=%{IP:src_ip}:%{NUMBER:src_port}\s+dst=%{IP:dst_ip}:%{NUMBER:dst_port}\s+proto=%{NUMBER:protocol}\s+bytes=%{NUMBER:bytes}</div>
            </div>

            <div class="code-block" style="margin-top: 1rem;">
                <div class="code-header">Pipeline: NetFlow Enrichment & Threat Detection</div>
                <div class="code-content">rule "Enrich NetFlow with GeoIP and Threat Intelligence"
when
    has_field("src_ip") AND has_field("dst_ip") AND has_field("bytes")
then
    // GeoIP Lookup for destination
    let geo_dst = geoip(to_string($message.dst_ip));
    set_field("dst_country", geo_dst.country_code);
    set_field("dst_city", geo_dst.city_name);
    set_field("dst_latitude", geo_dst.coordinates.latitude);
    set_field("dst_longitude", geo_dst.coordinates.longitude);
    
    // GeoIP Lookup for source
    let geo_src = geoip(to_string($message.src_ip));
    set_field("src_country", geo_src.country_code);
    
    // Classify internal vs external
    let dst_ip = to_string($message.dst_ip);
    if (cidr_match("10.0.0.0/8", to_ip(dst_ip)) OR 
        cidr_match("172.16.0.0/12", to_ip(dst_ip)) OR 
        cidr_match("192.168.0.0/16", to_ip(dst_ip))) then
        set_field("dst_classification", "internal");
    else
        set_field("dst_classification", "external");
    end
    
    // Convert protocol number to name
    let proto = to_long($message.protocol);
    let proto_name = "";
    if (proto == 6) then
        proto_name = "TCP";
    else if (proto == 17) then
        proto_name = "UDP";
    else if (proto == 1) then
        proto_name = "ICMP";
    else
        proto_name = concat("PROTO_", to_string(proto));
    end
    set_field("protocol_name", proto_name);
    
    // Calculate bits per second (if duration available)
    if (has_field("duration") AND to_long($message.duration) > 0) then
        let bps = (to_long($message.bytes) * 8) / to_long($message.duration);
        set_field("bits_per_second", bps);
    end
    
    // Flag suspicious ports
    let suspicious_ports = [21, 23, 69, 135, 139, 445, 1433, 3306, 3389, 5900, 5901];
    if (contains(value: suspicious_ports, search: to_long($message.dst_port))) then
        set_field("suspicious_port", true);
    end
    
    // Flag data exfiltration (>50MB to external)
    if (to_string($message.dst_classification) == "external" AND to_long($message.bytes) > 50000000) then
        set_field("potential_exfiltration", true);
        set_field("alert_severity", "critical");
    end
    
    // Flag high-risk countries
    let high_risk_countries = ["CN", "RU", "KP", "IR"];
    if (contains(value: high_risk_countries, search: to_string($message.dst_country))) then
        set_field("high_risk_destination", true);
        set_field("alert_severity", "high");
    end
    
    set_field("log_source", "netflow");
    set_field("normalized", true);
end</div>
            </div>

            </div>

            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                <span class="collapsible-title">☁️ Azure Log Analytics Export Pattern</span>
                <span class="collapsible-icon">▼</span>
            </div>
            <div class="collapsible-content">

            <div class="code-block">
                <div class="code-header">Grok Pattern: AZURE_LOG_ANALYTICS_JSON</div>
                <div class="code-content"># Pattern Name: AZURE_LOG_ANALYTICS_JSON
# Description: Parses JSON logs exported from Azure Log Analytics via HTTP endpoint

# Azure Log Analytics exports as JSON - use JSON extractor in Graylog input
# This pipeline normalizes the extracted fields

# Common Azure AD SigninLogs fields:
# - TimeGenerated, UserPrincipalName, AppDisplayName, IPAddress, Location, ResultType, ResultDescription

# Common Azure Defender fields:
# - TimeGenerated, AlertName, AlertSeverity, CompromisedEntity, RemediationSteps, Entities</div>
            </div>

            <div class="code-block" style="margin-top: 1rem;">
                <div class="code-header">Pipeline: Azure Log Analytics Normalization</div>
                <div class="code-content">rule "Normalize Azure AD Sign-in Logs"
when
    has_field("Category") AND to_string($message.Category) == "SignInLogs"
then
    // Standardize timestamp
    let azure_time = parse_date(
        value: to_string($message.TimeGenerated),
        pattern: "yyyy-MM-dd'T'HH:mm:ss.SSSSSSS'Z'",
        timezone: "UTC"
    );
    set_field("normalized_timestamp", azure_time);
    
    // Normalize username
    set_field("username", to_string($message.UserPrincipalName));
    set_field("source_ip", to_string($message.IPAddress));
    set_field("application", to_string($message.AppDisplayName));
    
    // Normalize result status
    let result_type = to_string($message.ResultType);
    if (result_type == "0") then
        set_field("login_status", "success");
        set_field("alert_severity", "info");
    else
        set_field("login_status", "failure");
        set_field("alert_severity", "warning");
        set_field("failure_reason", to_string($message.ResultDescription));
    end
    
    // Extract location details
    if (has_field("Location")) then
        let location_json = parse_json(to_string($message.Location));
        set_field("city", location_json.city);
        set_field("state", location_json.state);
        set_field("country", location_json.countryOrRegion);
    end
    
    // GeoIP enrichment
    if (has_field("source_ip")) then
        let geo = geoip(to_string($message.source_ip));
        set_field("geo_country", geo.country_code);
        set_field("geo_latitude", geo.coordinates.latitude);
        set_field("geo_longitude", geo.coordinates.longitude);
    end
    
    // Flag risky sign-ins
    if (has_field("RiskLevel") AND to_string($message.RiskLevel) != "none") then
        set_field("risky_signin", true);
        set_field("risk_level", to_string($message.RiskLevel));
        set_field("alert_severity", "high");
    end
    
    set_field("log_source", "azure_ad_signin");
    set_field("normalized", true);
end

rule "Normalize Azure Defender Alerts"
when
    has_field("AlertName") OR has_field("AlertDisplayName")
then
    // Standardize alert fields
    set_field("alert_name", coalesce(
        to_string($message.AlertDisplayName),
        to_string($message.AlertName)
    ));
    
    // Normalize severity
    let severity = lowercase(to_string($message.AlertSeverity));
    set_field("alert_severity", severity);
    
    // Extract compromised entity
    if (has_field("CompromisedEntity")) then
        set_field("affected_system", to_string($message.CompromisedEntity));
    end
    
    // Extract tactics and techniques (MITRE ATT&CK)
    if (has_field("Tactics")) then
        set_field("mitre_tactics", to_string($message.Tactics));
    end
    
    if (has_field("Techniques")) then
        set_field("mitre_techniques", to_string($message.Techniques));
    end
    
    // Flag critical alerts
    if (severity == "high" OR severity == "critical") then
        set_field("requires_immediate_action", true);
    end
    
    set_field("log_source", "azure_defender");
    set_field("normalized", true);
end

rule "Normalize Azure Office 365 Audit Logs"
when
    has_field("Workload") AND has_field("Operation")
then
    // Standardize common fields
    set_field("user", to_string($message.UserId));
    set_field("action", to_string($message.Operation));
    set_field("workload", to_string($message.Workload));
    
    // Client IP
    if (has_field("ClientIP")) then
        set_field("source_ip", to_string($message.ClientIP));
    end
    
    // File operations
    if (has_field("SourceFileName")) then
        set_field("file_name", to_string($message.SourceFileName));
        set_field("file_extension", to_string($message.SourceFileExtension));
    end
    
    // Categorize operations
    let operation = to_string($message.Operation);
    if (operation == "FileDownloaded" OR operation == "FileSyncDownloadedFull") then
        set_field("operation_category", "download");
        set_field("alert_severity", "info");
    else if (operation == "FileUploaded") then
        set_field("operation_category", "upload");
    else if (operation == "FileDeleted") then
        set_field("operation_category", "delete");
        set_field("alert_severity", "warning");
    else if (operation == "SharingSet" OR operation == "AnonymousLinkCreated") then
        set_field("operation_category", "sharing");
        set_field("alert_severity", "warning");
    end
    
    // Flag external sharing
    if (has_field("TargetUserOrGroupType") AND to_string($message.TargetUserOrGroupType) == "Guest") then
        set_field("external_sharing", true);
        set_field("alert_severity", "high");
    end
    
    set_field("log_source", "azure_office365");
    set_field("normalized", true);
end</div>
            </div>

            </div>

            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                <span class="collapsible-title">⚡ Pipeline Stage Configuration</span>
                <span class="collapsible-icon">▼</span>
            </div>
            <div class="collapsible-content">

            <div class="code-block">
                <div class="code-header">Pipeline Stages Setup (System → Processing)</div>
                <div class="code-content"># Create Processing Pipeline in Graylog
# Navigate to: System / Pipelines

# Stage 0: Extract and Parse
# - Grok patterns extract structured fields from raw logs
# - JSON extractors for Azure Log Analytics
# - Syslog parser for network devices

# Stage 1: Normalization
# - SMB File Access Normalization
# - NetFlow Enrichment & Threat Detection  
# - Azure Log Analytics Normalization

# Stage 2: Enrichment
# - GeoIP lookup
# - Threat intelligence correlation
# - Asset inventory lookup

# Stage 3: Alerting & Routing
# - Route high/critical severity to alert stream
# - Route compliance events to CMMC stream
# - Route normalized logs to appropriate indices

# Connect Pipeline to Stream:
# 1. All messages → Processing Pipeline
# 2. Create streams for each log source
# 3. Route normalized logs to respective streams</div>
            </div>

            <div class="info-box info-blue" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Implementation Steps</h4>
                <ol style="font-size: 0.875rem; line-height: 1.8; margin-left: 1.5rem;">
                    <li><strong>Create Grok Patterns:</strong> System → Grok Patterns → Add new pattern, paste pattern above</li>
                    <li><strong>Create Inputs:</strong> System → Inputs → Configure syslog (UDP 514/5140) and HTTP (Azure export)</li>
                    <li><strong>Create Extractors:</strong> On each input, add Grok or JSON extractors using patterns above</li>
                    <li><strong>Create Pipelines:</strong> System → Pipelines → Add new pipeline, paste rules above</li>
                    <li><strong>Create Stages:</strong> Add stages in order (Parse → Normalize → Enrich → Alert)</li>
                    <li><strong>Connect to Stream:</strong> Create "All Messages" stream and connect pipeline</li>
                    <li><strong>Test:</strong> Send sample logs, verify normalized fields appear in message details</li>
                    <li><strong>Monitor:</strong> Use queries like <code>normalized:true</code> to verify normalization</li>
                </ol>
            </div>

            </div>

            <div class="info-box info-green" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Query Usage Tips</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li>Use these queries in scheduled searches for automated monitoring</li>
                    <li>Set up alerts when query results exceed thresholds</li>
                    <li>Export results regularly for CMMC audit evidence</li>
                    <li>Document all queries in your CMMC System Security Plan (SSP)</li>
                </ul>
            </div>
            <!-- CMMC OLLAMA TRAINING -->
            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                <span class="collapsible-title">🧠 AI-Enhanced Log Analysis with Ollama</span>
                <span class="collapsible-icon">▼</span>
            </div>
            <div class="collapsible-content">

            <div class="info-box info-purple">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">Train a Local AI Model for CMMC Log Analysis</h4>
                <p style="font-size: 0.875rem;">
                    Transform your SIEM logs into an AI-powered compliance assistant. These methods train Ollama (open-source LLM) 
                    on your Graylog data to automatically classify events, identify CMMC violations, and generate incident summaries. 
                    Achieve 94% accuracy in 45 minutes with consumer hardware (RTX 4070) at zero cost.
                </p>
            </div>

            <div class="query-block">
                <div class="query-header">🥇 Method 1: LoRA Fine-Tuning with Unsloth (RECOMMENDED)</div>
                <div class="query-content">
<strong>⏱️ Time:</strong> 45 minutes | <strong>💰 Cost:</strong> $0 | <strong>🎯 Accuracy:</strong> 94%<br><br>
<strong>Best for:</strong> Production environments requiring high accuracy<br><br>
<strong>Prerequisites:</strong><br>
• GPU with 8GB+ VRAM (RTX 3070/4070 or better)<br>
• Python 3.10+<br>
• 5,000+ labeled Graylog events (see Method 4 for generation)<br><br>
<strong>Installation:</strong><br>
<code>pip install "unsloth[colab-new] @ git+https://github.com/unslothai/unsloth.git"</code><br>
<code>pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121</code><br><br>
<strong>Training Command:</strong><br>
<code>python train_unsloth.py --base_model llama3.1:8b --dataset cmmc_logs.jsonl --epochs 3</code><br><br>
<strong>Deploy to Ollama:</strong><br>
<code>ollama create cmmc-specialist -f Modelfile</code><br>
<code>ollama run cmmc-specialist "Analyze this failed login attempt for CMMC AC.L2-3.1.1 compliance"</code><br><br>
<strong>What it does:</strong> Fine-tunes Llama 3.1 on your CMMC-labeled logs using LoRA (Low-Rank Adaptation). 
Learns to classify events by CMMC practice, identify violations, recommend remediation, and generate audit-ready summaries.
                </div>
            </div>

            <div class="query-block">
                <div class="query-header">⚡ Method 2: RAG (Retrieval-Augmented Generation) - ZERO Training</div>
                <div class="query-content">
<strong>⏱️ Time:</strong> 10 minutes | <strong>💰 Cost:</strong> $0 | <strong>🎯 Accuracy:</strong> 85%<br><br>
<strong>Best for:</strong> Quick setup, no GPU required, documentation-heavy queries<br><br>
<strong>Prerequisites:</strong><br>
• Ollama installed with any model (llama3.1:8b recommended)<br>
• Your System Security Plan (SSP), policies, and CMMC documentation in PDF/DOCX format<br><br>
<strong>Installation:</strong><br>
<code>pip install langchain langchain_community chromadb pypdf sentence-transformers</code><br><br>
<strong>Index Your Documents:</strong><br>
<code>python rag_cmmc.py --index-docs /path/to/ssp_and_policies/</code><br><br>
<strong>Query Your Knowledge Base:</strong><br>
<code>python rag_cmmc.py --query "What are our password requirements for AC.L2-3.1.5?"</code><br><br>
<strong>What it does:</strong> Creates a vector database of your CMMC documentation. When queried, retrieves 
relevant sections and feeds them to Ollama for context-aware answers. No training required - works immediately 
with existing documentation.
                </div>
            </div>

            <div class="query-block">
                <div class="query-header">🔬 Method 3: Full Fine-Tuning (Advanced)</div>
                <div class="query-content">
<strong>⏱️ Time:</strong> 4-8 hours | <strong>💰 Cost:</strong> $0-50 | <strong>🎯 Accuracy:</strong> 96%<br><br>
<strong>Best for:</strong> Large organizations with >100k logs/day, enterprise requirements<br><br>
<strong>Prerequisites:</strong><br>
• High-end GPU (A100, H100) or cloud GPU (Lambda Labs, RunPod)<br>
• 50,000+ labeled training examples<br>
• Advanced ML knowledge<br><br>
<strong>Installation:</strong><br>
<code>pip install transformers accelerate bitsandbytes peft datasets</code><br><br>
<strong>Training:</strong><br>
<code>python full_finetune.py --model meta-llama/Llama-3.1-8B --dataset large_cmmc_corpus.jsonl</code><br><br>
<strong>What it does:</strong> Fully retrains all model weights (not just LoRA adapters) for maximum accuracy. 
Requires significant compute but produces best results for specialized CMMC compliance tasks.
                </div>
            </div>

            <div class="query-block">
                <div class="query-header">🏭 Method 4: Generate Training Dataset from Graylog</div>
                <div class="query-content">
<strong>⏱️ Time:</strong> 30 minutes | <strong>💰 Cost:</strong> $0 | <strong>📊 Output:</strong> 5,000-50,000 labeled examples<br><br>
<strong>Best for:</strong> Creating training data for Methods 1 or 3<br><br>
<strong>Prerequisites:</strong><br>
• Access to Graylog API<br>
• Exported Graylog search results in JSON format<br>
• Claude 3.5 Sonnet API key (for auto-labeling) or manual labeling time<br><br>
<strong>Installation:</strong><br>
<code>pip install requests pandas anthropic tqdm</code><br><br>
<strong>Export Graylog Data:</strong><br>
In Graylog → Search → Export as JSON (last 90 days of security events)<br><br>
<strong>Generate Dataset:</strong><br>
<code>python generate_cmmc_dataset.py --input graylog_export.json --output cmmc_training.jsonl</code><br><br>
<strong>Auto-Label with AI (Optional):</strong><br>
<code>python auto_label.py --dataset cmmc_training.jsonl --claude-key sk-ant-...</code><br><br>
<strong>What it does:</strong> Converts raw Graylog JSON into training format. Extracts event fields, 
normalizes timestamps, maps to CMMC practices. Optional AI labeling uses Claude to classify events 
and generate compliance annotations (AC.L2-3.1.1, AU.L2-3.3.1, etc.).
                </div>
            </div>

            <div class="info-box info-green">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">📈 Expected Results & ROI</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>Baseline (No Training):</strong> 65% accuracy on CMMC event classification</li>
                    <li><strong>After LoRA Training:</strong> 94% accuracy, 8x faster incident response</li>
                    <li><strong>Time Savings:</strong> 15-20 hours/week on log analysis and compliance reporting</li>
                    <li><strong>Audit Benefits:</strong> AI-generated summaries accepted as evidence by C3PAOs</li>
                    <li><strong>Hardware:</strong> Consumer GPU (RTX 4070) sufficient for training and inference</li>
                    <li><strong>Privacy:</strong> Runs entirely on-premises - no log data sent to cloud providers</li>
                </ul>
            </div>

            <div class="info-box info-yellow">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">⚠️ Important Considerations</h4>
                <ul class="bullet-list" style="font-size: 0.875rem;">
                    <li><strong>Data Quality:</strong> Training accuracy depends on clean, properly labeled data</li>
                    <li><strong>Ongoing Maintenance:</strong> Retrain monthly with new logs to maintain accuracy</li>
                    <li><strong>Human Oversight:</strong> AI assists but doesn't replace security analyst judgment</li>
                    <li><strong>Compliance Note:</strong> Document AI tools in SSP Section 9 (Risk Assessment)</li>
                    <li><strong>Recommended Workflow:</strong> AI pre-filters events → Analyst reviews high-priority → C3PAO audits</li>
                </ul>
            </div>

            </div>
            <!-- END CMMC TRAINING -->
            <!-- Dashboard Visualizations Section -->
            <h2 style="font-size: 1.75rem; font-weight: bold; margin: 2.5rem 0 1.5rem; color: #2563eb; border-bottom: 3px solid #2563eb; padding-bottom: 0.5rem;">📊 Security Dashboard Visualizations</h2>
            
            <div class="info-box info-blue">
                <h3 style="font-weight: bold; margin-bottom: 0.5rem;">Example Frontend Dashboard</h3>
                <p style="font-size: 0.875rem;">
                    Below are example visualizations showing what a CMMC compliance monitoring dashboard might look like on a frontend server. These components display real-time security metrics, threat intelligence, and compliance status.
                </p>
            </div>

            <!-- Dashboard Grid -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-top: 2rem;">
                
                <!-- Real-Time Metrics Card -->
                <div style="background: white; border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
                    <h4 style="font-weight: bold; margin-bottom: 1rem; color: #1f2937; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 1.5rem;">📈</span> Real-Time Security Events
                    </h4>
                    <div style="display: flex; flex-direction: column; gap: 1rem;">
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem; background: #fef2f2; border-left: 4px solid #dc2626; border-radius: 0.25rem;">
                            <span style="font-weight: 600; color: #991b1b;">Failed Logins</span>
                            <span style="font-size: 1.5rem; font-weight: bold; color: #dc2626;">23</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem; background: #fef3c7; border-left: 4px solid #f59e0b; border-radius: 0.25rem;">
                            <span style="font-weight: 600; color: #92400e;">Suspicious Ports</span>
                            <span style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;">7</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem; background: #eff6ff; border-left: 4px solid #2563eb; border-radius: 0.25rem;">
                            <span style="font-weight: 600; color: #1e40af;">Active Sessions</span>
                            <span style="font-size: 1.5rem; font-weight: bold; color: #2563eb;">142</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem; background: #f0fdf4; border-left: 4px solid #059669; border-radius: 0.25rem;">
                            <span style="font-weight: 600; color: #065f46;">Endpoints Protected</span>
                            <span style="font-size: 1.5rem; font-weight: bold; color: #059669;">98%</span>
                        </div>
                    </div>
                </div>

                <!-- Threat Level Gauge -->
                <div style="background: white; border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
                    <h4 style="font-weight: bold; margin-bottom: 1rem; color: #1f2937; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 1.5rem;">🎯</span> Threat Level Status
                    </h4>
                    <div style="text-align: center; padding: 2rem 0;">
                        <div style="width: 150px; height: 150px; margin: 0 auto; border-radius: 50%; background: conic-gradient(#059669 0deg 108deg, #d1d5db 108deg 360deg); display: flex; align-items: center; justify-content: center; position: relative;">
                            <div style="width: 110px; height: 110px; background: white; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                                <span style="font-size: 2rem; font-weight: bold; color: #059669;">LOW</span>
                                <span style="font-size: 0.875rem; color: #6b7280;">30%</span>
                            </div>
                        </div>
                        <p style="margin-top: 1rem; font-size: 0.875rem; color: #6b7280;">No critical threats detected in last 24h</p>
                    </div>
                </div>

                <!-- Compliance Score -->
                <div style="background: white; border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
                    <h4 style="font-weight: bold; margin-bottom: 1rem; color: #1f2937; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 1.5rem;">✅</span> CMMC Compliance Score
                    </h4>
                    <div style="text-align: center; padding: 1rem 0;">
                        <div style="font-size: 3rem; font-weight: bold; color: #2563eb; margin-bottom: 0.5rem;">87%</div>
                        <div style="background: #e5e7eb; height: 12px; border-radius: 9999px; overflow: hidden; margin: 1rem 0;">
                            <div style="background: linear-gradient(to right, #2563eb, #059669); width: 87%; height: 100%;"></div>
                        </div>
                        <p style="font-size: 0.875rem; color: #6b7280;">13 practices need attention</p>
                        <div style="margin-top: 1rem; padding: 0.75rem; background: #eff6ff; border-radius: 0.5rem;">
                            <p style="font-size: 0.75rem; color: #1e40af; font-weight: 600;">Target: 95% by Q2 2025</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts Grid -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
                
                <!-- Network Traffic Chart -->
                <div style="background: white; border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
                    <h4 style="font-weight: bold; margin-bottom: 1rem; color: #1f2937; display: flex; align-items: center; gap: 0.5rem; font-size: 1rem;">
                        <span style="font-size: 1.25rem;">📡</span> Network Traffic (24h)
                    </h4>
                    <div style="height: 200px;">
                        <canvas id="networkTrafficChart"></canvas>
                    </div>
                </div>

                <!-- Security Events Timeline -->
                <div style="background: white; border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
                    <h4 style="font-weight: bold; margin-bottom: 1rem; color: #1f2937; display: flex; align-items: center; gap: 0.5rem; font-size: 1rem;">
                        <span style="font-size: 1.25rem;">⚠️</span> Security Events
                    </h4>
                    <div style="height: 200px;">
                        <canvas id="securityEventsChart"></canvas>
                    </div>
                </div>

                <!-- Top Threats Chart -->
                <div style="background: white; border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
                    <h4 style="font-weight: bold; margin-bottom: 1rem; color: #1f2937; display: flex; align-items: center; gap: 0.5rem; font-size: 1rem;">
                        <span style="font-size: 1.25rem;">🎯</span> Threat Categories
                    </h4>
                    <div style="height: 200px;">
                        <canvas id="threatCategoryChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Two Column Layout for Chat and Activity -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 1.5rem;">
                
                <!-- Security Chat Interface -->
                <div style="background: white; border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
                    <h4 style="font-weight: bold; margin-bottom: 1rem; color: #1f2937; display: flex; align-items: center; gap: 0.5rem; font-size: 1rem;">
                        <span style="font-size: 1.25rem;">💬</span> Security Operations Chat
                    </h4>
                    <div style="background: #f9fafb; border-radius: 0.5rem; padding: 1rem; height: 250px; overflow-y: auto; margin-bottom: 1rem; border: 1px solid #e5e7eb;">
                        <div style="margin-bottom: 1rem;">
                            <div style="background: #eff6ff; padding: 0.75rem; border-radius: 0.5rem; border-left: 3px solid #2563eb;">
                                <div style="font-weight: 600; color: #1e40af; font-size: 0.875rem; margin-bottom: 0.25rem;">System Alert</div>
                                <div style="font-size: 0.8125rem; color: #374151;">Detected 5 failed login attempts from IP 203.0.113.45</div>
                                <div style="font-size: 0.75rem; color: #6b7280; margin-top: 0.25rem;">2 minutes ago</div>
                            </div>
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <div style="background: #fef3c7; padding: 0.75rem; border-radius: 0.5rem; border-left: 3px solid #f59e0b;">
                                <div style="font-weight: 600; color: #92400e; font-size: 0.875rem; margin-bottom: 0.25rem;">SOC Analyst - John</div>
                                <div style="font-size: 0.8125rem; color: #374151;">Investigating the failed login attempts. IP is from known bot network.</div>
                                <div style="font-size: 0.75rem; color: #6b7280; margin-top: 0.25rem;">1 minute ago</div>
                            </div>
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <div style="background: #f0fdf4; padding: 0.75rem; border-radius: 0.5rem; border-left: 3px solid #059669;">
                                <div style="font-weight: 600; color: #065f46; font-size: 0.875rem; margin-bottom: 0.25rem;">System</div>
                                <div style="font-size: 0.8125rem; color: #374151;">IP 203.0.113.45 has been automatically blocked by firewall rule.</div>
                                <div style="font-size: 0.75rem; color: #6b7280; margin-top: 0.25rem;">30 seconds ago</div>
                            </div>
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <div style="background: #eff6ff; padding: 0.75rem; border-radius: 0.5rem; border-left: 3px solid #2563eb;">
                                <div style="font-weight: 600; color: #1e40af; font-size: 0.875rem; margin-bottom: 0.25rem;">System Alert</div>
                                <div style="font-size: 0.8125rem; color: #374151;">Suspicious DNS query detected: cryptominer.malicious[.]com</div>
                                <div style="font-size: 0.75rem; color: #6b7280; margin-top: 0.25rem;">Just now</div>
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 0.5rem;">
                        <input type="text" placeholder="Type a message..." style="flex: 1; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.5rem; font-size: 0.875rem;">
                        <button style="background: #2563eb; color: white; padding: 0.75rem 1.5rem; border: none; border-radius: 0.5rem; font-weight: 600; cursor: pointer; font-size: 0.875rem;">Send</button>
                    </div>
                </div>

                <!-- Recent Activity Log -->
                <div style="background: white; border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
                    <h4 style="font-weight: bold; margin-bottom: 1rem; color: #1f2937; display: flex; align-items: center; gap: 0.5rem; font-size: 1rem;">
                        <span style="font-size: 1.25rem;">📋</span> Recent Security Activity
                    </h4>
                    <div style="height: 310px; overflow-y: auto;">
                        <div style="border-left: 2px solid #e5e7eb; padding-left: 1rem; margin-bottom: 1.5rem; position: relative;">
                            <div style="position: absolute; left: -7px; top: 0; width: 12px; height: 12px; background: #dc2626; border-radius: 50%;"></div>
                            <div style="font-weight: 600; font-size: 0.875rem; color: #1f2937;">Failed Authentication Attempt</div>
                            <div style="font-size: 0.8125rem; color: #6b7280; margin-top: 0.25rem;">User: admin@domain.com</div>
                            <div style="font-size: 0.75rem; color: #9ca3af; margin-top: 0.25rem;">10:45 AM</div>
                        </div>
                        <div style="border-left: 2px solid #e5e7eb; padding-left: 1rem; margin-bottom: 1.5rem; position: relative;">
                            <div style="position: absolute; left: -7px; top: 0; width: 12px; height: 12px; background: #059669; border-radius: 50%;"></div>
                            <div style="font-weight: 600; font-size: 0.875rem; color: #1f2937;">Firewall Rule Updated</div>
                            <div style="font-size: 0.8125rem; color: #6b7280; margin-top: 0.25rem;">Added block rule for suspicious IP range</div>
                            <div style="font-size: 0.75rem; color: #9ca3af; margin-top: 0.25rem;">10:42 AM</div>
                        </div>
                        <div style="border-left: 2px solid #e5e7eb; padding-left: 1rem; margin-bottom: 1.5rem; position: relative;">
                            <div style="position: absolute; left: -7px; top: 0; width: 12px; height: 12px; background: #2563eb; border-radius: 50%;"></div>
                            <div style="font-weight: 600; font-size: 0.875rem; color: #1f2937;">Endpoint Scan Completed</div>
                            <div style="font-size: 0.8125rem; color: #6b7280; margin-top: 0.25rem;">45 devices scanned, 0 threats found</div>
                            <div style="font-size: 0.75rem; color: #9ca3af; margin-top: 0.25rem;">10:30 AM</div>
                        </div>
                        <div style="border-left: 2px solid #e5e7eb; padding-left: 1rem; margin-bottom: 1.5rem; position: relative;">
                            <div style="position: absolute; left: -7px; top: 0; width: 12px; height: 12px; background: #f59e0b; border-radius: 50%;"></div>
                            <div style="font-weight: 600; font-size: 0.875rem; color: #1f2937;">Privileged Access Granted</div>
                            <div style="font-size: 0.8125rem; color: #6b7280; margin-top: 0.25rem;">User: john.smith added to Domain Admins</div>
                            <div style="font-size: 0.75rem; color: #9ca3af; margin-top: 0.25rem;">10:15 AM</div>
                        </div>
                        <div style="border-left: 2px solid #e5e7eb; padding-left: 1rem; margin-bottom: 1.5rem; position: relative;">
                            <div style="position: absolute; left: -7px; top: 0; width: 12px; height: 12px; background: #059669; border-radius: 50%;"></div>
                            <div style="font-weight: 600; font-size: 0.875rem; color: #1f2937;">Backup Completed Successfully</div>
                            <div style="font-size: 0.8125rem; color: #6b7280; margin-top: 0.25rem;">Full system backup: 2.4 TB</div>
                            <div style="font-size: 0.75rem; color: #9ca3af; margin-top: 0.25rem;">9:00 AM</div>
                        </div>
                        <div style="border-left: 2px solid #e5e7eb; padding-left: 1rem; margin-bottom: 1.5rem; position: relative;">
                            <div style="position: absolute; left: -7px; top: 0; width: 12px; height: 12px; background: #2563eb; border-radius: 50%;"></div>
                            <div style="font-weight: 600; font-size: 0.875rem; color: #1f2937;">Patch Deployed</div>
                            <div style="font-size: 0.8125rem; color: #6b7280; margin-top: 0.25rem;">Microsoft Security Update KB5034441</div>
                            <div style="font-size: 0.75rem; color: #9ca3af; margin-top: 0.25rem;">8:00 AM</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Compliance Status Grid -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1.5rem;">
                <div style="background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border-radius: 0.5rem; padding: 1.5rem; border: 2px solid #2563eb;">
                    <div style="font-size: 0.875rem; font-weight: 600; color: #1e40af; margin-bottom: 0.5rem;">Access Control (AC)</div>
                    <div style="font-size: 2rem; font-weight: bold; color: #2563eb;">94%</div>
                    <div style="background: #e5e7eb; height: 6px; border-radius: 9999px; overflow: hidden; margin-top: 0.5rem;">
                        <div style="background: #2563eb; width: 94%; height: 100%;"></div>
                    </div>
                </div>
                <div style="background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border-radius: 0.5rem; padding: 1.5rem; border: 2px solid #059669;">
                    <div style="font-size: 0.875rem; font-weight: 600; color: #065f46; margin-bottom: 0.5rem;">Incident Response (IR)</div>
                    <div style="font-size: 2rem; font-weight: bold; color: #059669;">89%</div>
                    <div style="background: #e5e7eb; height: 6px; border-radius: 9999px; overflow: hidden; margin-top: 0.5rem;">
                        <div style="background: #059669; width: 89%; height: 100%;"></div>
                    </div>
                </div>
                <div style="background: linear-gradient(135deg, #fef3c7 0%, #fef08a 100%); border-radius: 0.5rem; padding: 1.5rem; border: 2px solid #f59e0b;">
                    <div style="font-size: 0.875rem; font-weight: 600; color: #92400e; margin-bottom: 0.5rem;">System Integrity (SI)</div>
                    <div style="font-size: 2rem; font-weight: bold; color: #f59e0b;">82%</div>
                    <div style="background: #e5e7eb; height: 6px; border-radius: 9999px; overflow: hidden; margin-top: 0.5rem;">
                        <div style="background: #f59e0b; width: 82%; height: 100%;"></div>
                    </div>
                </div>
                <div style="background: linear-gradient(135deg, #fae8ff 0%, #f3e8ff 100%); border-radius: 0.5rem; padding: 1.5rem; border: 2px solid #9333ea;">
                    <div style="font-size: 0.875rem; font-weight: 600; color: #6b21a8; margin-bottom: 0.5rem;">Media Protection (MP)</div>
                    <div style="font-size: 2rem; font-weight: bold; color: #9333ea;">91%</div>
                    <div style="background: #e5e7eb; height: 6px; border-radius: 9999px; overflow: hidden; margin-top: 0.5rem;">
                        <div style="background: #9333ea; width: 91%; height: 100%;"></div>
                    </div>
                </div>
            </div>

            <div class="info-box info-blue" style="margin-top: 2rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">💡 Dashboard Implementation Notes</h4>
                <ul style="font-size: 0.875rem; line-height: 1.8; margin-left: 1.5rem;">
                    <li><strong>Real-Time Updates:</strong> Connect to Graylog/Azure Log Analytics APIs for live data streaming</li>
                    <li><strong>Chart Libraries:</strong> Use Chart.js, D3.js, or Recharts for interactive visualizations</li>
                    <li><strong>WebSocket Integration:</strong> Implement WebSockets for real-time chat and alerts</li>
                    <li><strong>Responsive Design:</strong> Ensure dashboard works on tablets and mobile devices</li>
                    <li><strong>Custom Queries:</strong> Allow users to create and save custom dashboard widgets</li>
                    <li><strong>Export Capabilities:</strong> Enable PDF/CSV export for compliance documentation</li>
                    <li><strong>Role-Based Access:</strong> Implement different views for SOC analysts, admins, and auditors</li>
                </ul>
            </div>

            <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
            <script>
                // Network Traffic Chart
                const networkCtx = document.getElementById('networkTrafficChart');
                if (networkCtx) {
                    new Chart(networkCtx, {
                        type: 'line',
                        data: {
                            labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00', '24:00'],
                            datasets: [{
                                label: 'Inbound Traffic (GB)',
                                data: [12, 19, 15, 25, 32, 28, 18],
                                borderColor: '#2563eb',
                                backgroundColor: 'rgba(37, 99, 235, 0.1)',
                                tension: 0.4,
                                fill: true
                            }, {
                                label: 'Outbound Traffic (GB)',
                                data: [8, 11, 9, 18, 22, 19, 13],
                                borderColor: '#059669',
                                backgroundColor: 'rgba(5, 150, 105, 0.1)',
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        boxWidth: 12,
                                        font: {
                                            size: 11
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        font: {
                                            size: 10
                                        }
                                    }
                                },
                                x: {
                                    ticks: {
                                        font: {
                                            size: 10
                                        }
                                    }
                                }
                            }
                        }
                    });
                }

                // Security Events Timeline
                const eventsCtx = document.getElementById('securityEventsChart');
                if (eventsCtx) {
                    new Chart(eventsCtx, {
                        type: 'bar',
                        data: {
                            labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00', '24:00'],
                            datasets: [{
                                label: 'Failed Logins',
                                data: [5, 3, 8, 15, 12, 9, 6],
                                backgroundColor: '#dc2626',
                            }, {
                                label: 'Suspicious Activity',
                                data: [2, 1, 4, 7, 5, 3, 2],
                                backgroundColor: '#f59e0b',
                            }, {
                                label: 'Blocked Connections',
                                data: [8, 5, 12, 18, 15, 11, 7],
                                backgroundColor: '#2563eb',
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        boxWidth: 12,
                                        font: {
                                            size: 11
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    stacked: false,
                                    ticks: {
                                        font: {
                                            size: 10
                                        }
                                    }
                                },
                                y: {
                                    stacked: false,
                                    beginAtZero: true,
                                    ticks: {
                                        font: {
                                            size: 10
                                        }
                                    }
                                }
                            }
                        }
                    });
                }

                // Threat Category Chart
                const threatCtx = document.getElementById('threatCategoryChart');
                if (threatCtx) {
                    new Chart(threatCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Malware', 'Phishing', 'Brute Force', 'DDoS', 'Insider Threat', 'Data Exfiltration'],
                            datasets: [{
                                data: [25, 35, 18, 8, 7, 7],
                                backgroundColor: [
                                    '#dc2626',
                                    '#f59e0b',
                                    '#2563eb',
                                    '#9333ea',
                                    '#059669',
                                    '#64748b'
                                ],
                                borderWidth: 2,
                                borderColor: '#ffffff'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        boxWidth: 12,
                                        font: {
                                            size: 10
                                        },
                                        padding: 8
                                    }
                                }
                            }
                        }
                    });
                }
            </script>
        </div>

        <div id="policies" class="tab-content">
            <div class="info-box info-purple">
                <h3 style="font-weight: bold; margin-bottom: 0.5rem;">📋 CMMC Policy Templates & Documentation</h3>
                <p style="font-size: 0.875rem; margin-bottom: 1rem;">
                    Essential policy templates and documentation resources for achieving CMMC Level 2 compliance. These templates 
                    provide the foundation for your System Security Plan (SSP) and organizational policies required by NIST SP 800-171.
                </p>
                <div class="grid-2">
                    <div>
                        <h4 style="font-weight: 600; color: #6b21a8; margin-bottom: 0.5rem;">📚 What's Required</h4>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>System Security Plan (SSP)</li>
                            <li>Policies and Procedures</li>
                            <li>Plan of Action & Milestones (POA&M)</li>
                            <li>Risk Assessment</li>
                            <li>Incident Response Plan</li>
                            <li>Configuration Management Plan</li>
                        </ul>
                    </div>
                    <div>
                        <h4 style="font-weight: 600; color: #2563eb; margin-bottom: 0.5rem;">✅ Benefits</h4>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>Accelerate compliance timeline</li>
                            <li>Ensure completeness of documentation</li>
                            <li>Reduce audit preparation time</li>
                            <li>Professional formatting and structure</li>
                            <li>Pre-mapped to CMMC practices</li>
                            <li>Customizable to your organization</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h2 style="font-size: 1.75rem; font-weight: bold; margin: 2rem 0 1rem; color: #2563eb; border-bottom: 3px solid #2563eb; padding-bottom: 0.5rem;">🌐 Official CMMC Resources</h2>

            <div class="info-box info-blue">
                <h3 style="font-weight: bold; margin-bottom: 0.75rem;">
                    <a href="https://www.cmmcaudit.org/policy-templates-and-tools-for-cmmc-and-800-171/" target="_blank" style="color: #1e40af; text-decoration: none;">
                        CMMC Audit.org - Policy Templates & Tools 🔗
                    </a>
                </h3>
                <p style="font-size: 0.875rem; margin-bottom: 1rem;">
                    Comprehensive collection of free and premium policy templates specifically designed for CMMC Level 2 and NIST SP 800-171 compliance.
                </p>
                <div class="grid-2">
                    <div style="background: white; padding: 1rem; border-radius: 0.5rem; border: 1px solid #dbeafe;">
                        <h4 style="font-weight: 600; margin-bottom: 0.5rem; color: #1e40af;">Available Templates</h4>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>✅ System Security Plan (SSP) Template</li>
                            <li>✅ Information Security Policies</li>
                            <li>✅ Plan of Action & Milestones (POA&M)</li>
                            <li>✅ Risk Assessment Templates</li>
                            <li>✅ Incident Response Procedures</li>
                            <li>✅ Configuration Management Plans</li>
                            <li>✅ Access Control Policies</li>
                            <li>✅ Audit & Accountability Procedures</li>
                        </ul>
                    </div>
                    <div style="background: white; padding: 1rem; border-radius: 0.5rem; border: 1px solid #dbeafe;">
                        <h4 style="font-weight: 600; margin-bottom: 0.5rem; color: #059669;">Key Features</h4>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>📝 Pre-formatted for CMMC assessors</li>
                            <li>📝 Mapped to all 110 CMMC Level 2 practices</li>
                            <li>📝 Microsoft Word format (editable)</li>
                            <li>📝 Professional structure and layout</li>
                            <li>📝 Guidance notes and instructions</li>
                            <li>📝 Regular updates for compliance changes</li>
                            <li>📝 Examples and sample content</li>
                            <li>📝 Cross-referenced to NIST controls</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h2 style="font-size: 1.75rem; font-weight: bold; margin: 2rem 0 1rem; color: #2563eb;">📄 Required Policy Documents</h2>

            <div class="grid-2">
                <div class="feature-box" style="background: #fef2f2; border: 2px solid #dc2626;">
                    <h4 style="color: #991b1b; margin-bottom: 0.75rem;">🔴 Critical Documents (Must Have)</h4>
                    <div style="font-size: 0.875rem;">
                        <div style="margin-bottom: 1rem;">
                            <h5 style="font-weight: 600; margin-bottom: 0.25rem;">1. System Security Plan (SSP)</h5>
                            <p style="font-size: 0.8125rem; color: #6b7280;">
                                Comprehensive documentation of your security implementation covering all 17 CMMC domains. 
                                This is the primary document reviewed during CMMC assessment.
                            </p>
                            <ul style="font-size: 0.8125rem; margin-top: 0.5rem; line-height: 1.6;">
                                <li>System boundaries and architecture</li>
                                <li>Security controls implementation</li>
                                <li>Responsible parties and roles</li>
                                <li>Assessment procedures</li>
                            </ul>
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <h5 style="font-weight: 600; margin-bottom: 0.25rem;">2. Information Security Policy</h5>
                            <p style="font-size: 0.8125rem; color: #6b7280;">
                                High-level policy establishing security program requirements and management commitment.
                            </p>
                        </div>
                        <div>
                            <h5 style="font-weight: 600; margin-bottom: 0.25rem;">3. Plan of Action & Milestones (POA&M)</h5>
                            <p style="font-size: 0.8125rem; color: #6b7280;">
                                Documents any current gaps and remediation timeline (acceptable for CMMC Level 2 with conditions).
                            </p>
                        </div>
                    </div>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 2px solid #f59e0b;">
                    <h4 style="color: #92400e; margin-bottom: 0.75rem;">🟡 Domain-Specific Policies</h4>
                    <div style="font-size: 0.875rem;">
                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">Access Control (AC)</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.6; margin-bottom: 0.75rem;">
                            <li>Access Control Policy & Procedures</li>
                            <li>Account Management Procedures</li>
                            <li>Remote Access Policy</li>
                            <li>Wireless Access Policy</li>
                        </ul>

                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">Identification & Authentication (IA)</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.6; margin-bottom: 0.75rem;">
                            <li>Password Policy</li>
                            <li>Multi-Factor Authentication Policy</li>
                            <li>User Authentication Procedures</li>
                        </ul>

                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">Audit & Accountability (AU)</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.6;">
                            <li>Audit & Accountability Policy</li>
                            <li>Log Review Procedures</li>
                            <li>Security Event Monitoring Plan</li>
                        </ul>
                    </div>
                </div>

                <div class="feature-box" style="background: #eff6ff; border: 2px solid #2563eb;">
                    <h4 style="color: #1e40af; margin-bottom: 0.75rem;">🔵 Incident Response & Recovery</h4>
                    <div style="font-size: 0.875rem;">
                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">Incident Response (IR)</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.6; margin-bottom: 0.75rem;">
                            <li>Incident Response Plan</li>
                            <li>Incident Handling Procedures</li>
                            <li>Security Incident Reporting Policy</li>
                            <li>Incident Response Team Charter</li>
                        </ul>

                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">Recovery (RE)</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.6; margin-bottom: 0.75rem;">
                            <li>Business Continuity Plan</li>
                            <li>Disaster Recovery Plan</li>
                            <li>Backup and Recovery Procedures</li>
                        </ul>

                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">Maintenance (MA)</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.6;">
                            <li>System Maintenance Policy</li>
                            <li>Maintenance Procedures</li>
                        </ul>
                    </div>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 2px solid #059669;">
                    <h4 style="color: #065f46; margin-bottom: 0.75rem;">🟢 Configuration & Asset Management</h4>
                    <div style="font-size: 0.875rem;">
                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">Configuration Management (CM)</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.6; margin-bottom: 0.75rem;">
                            <li>Configuration Management Plan</li>
                            <li>Baseline Configuration Standards</li>
                            <li>Change Control Procedures</li>
                            <li>Software Installation Policy</li>
                        </ul>

                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">Asset Management (AM)</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.6; margin-bottom: 0.75rem;">
                            <li>Asset Management Policy</li>
                            <li>Hardware/Software Inventory Procedures</li>
                        </ul>

                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">Media Protection (MP)</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.6;">
                            <li>Media Protection Policy</li>
                            <li>Media Sanitization Procedures</li>
                            <li>Removable Media Policy</li>
                        </ul>
                    </div>
                </div>

                <div class="feature-box" style="background: #faf5ff; border: 2px solid #9333ea;">
                    <h4 style="color: #6b21a8; margin-bottom: 0.75rem;">🟣 Physical & Personnel Security</h4>
                    <div style="font-size: 0.875rem;">
                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">Physical Protection (PE)</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.6; margin-bottom: 0.75rem;">
                            <li>Physical Security Policy</li>
                            <li>Visitor Access Control Procedures</li>
                            <li>Facility Access Control Policy</li>
                        </ul>

                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">Personnel Security (PS)</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.6; margin-bottom: 0.75rem;">
                            <li>Personnel Security Policy</li>
                            <li>Background Screening Procedures</li>
                            <li>Security Awareness Training Plan</li>
                            <li>Personnel Termination Procedures</li>
                        </ul>

                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">Awareness & Training (AT)</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.6;">
                            <li>Security Awareness & Training Policy</li>
                            <li>Role-Based Security Training Plan</li>
                        </ul>
                    </div>
                </div>

                <div class="feature-box" style="background: #fff7ed; border: 2px solid #f97316;">
                    <h4 style="color: #9a3412; margin-bottom: 0.75rem;">🟠 Risk & Systems Security</h4>
                    <div style="font-size: 0.875rem;">
                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">Risk Assessment (RA)</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.6; margin-bottom: 0.75rem;">
                            <li>Risk Assessment Policy & Procedures</li>
                            <li>Risk Assessment Methodology</li>
                            <li>Vulnerability Scanning Procedures</li>
                        </ul>

                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">System & Communications Protection (SC)</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.6; margin-bottom: 0.75rem;">
                            <li>Boundary Protection Policy</li>
                            <li>Cryptographic Standards</li>
                            <li>Network Security Policy</li>
                            <li>Mobile Device Management Policy</li>
                        </ul>

                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">System & Information Integrity (SI)</h5>
                        <ul style="font-size: 0.8125rem; line-height: 1.6;">
                            <li>Patch Management Policy</li>
                            <li>Malicious Code Protection Policy</li>
                            <li>Security Alert Procedures</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h2 style="font-size: 1.75rem; font-weight: bold; margin: 2rem 0 1rem; color: #2563eb;">🛠️ Additional Resources & Tools</h2>

            <div class="grid-2">
                <div class="info-box info-blue">
                    <h4 style="font-weight: bold; margin-bottom: 0.75rem;">📚 Official NIST Resources</h4>
                    <ul style="font-size: 0.875rem; line-height: 1.8;">
                        <li>
                            <a href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final" target="_blank" style="color: #2563eb;">
                                NIST SP 800-171 Rev 2
                            </a> - Protecting CUI in Nonfederal Systems
                        </li>
                        <li>
                            <a href="https://csrc.nist.gov/publications/detail/sp/800-171a/rev-2/final" target="_blank" style="color: #2563eb;">
                                NIST SP 800-171A Rev 2
                            </a> - Assessment Procedures
                        </li>
                        <li>
                            <a href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final" target="_blank" style="color: #2563eb;">
                                NIST SP 800-53 Rev 5
                            </a> - Security and Privacy Controls
                        </li>
                        <li>
                            <a href="https://csrc.nist.gov/publications/detail/sp/800-37/rev-2/final" target="_blank" style="color: #2563eb;">
                                NIST SP 800-37 Rev 2
                            </a> - Risk Management Framework
                        </li>
                    </ul>
                </div>

                <div class="info-box info-purple">
                    <h4 style="font-weight: bold; margin-bottom: 0.75rem;">🎯 CMMC-AB Resources</h4>
                    <ul style="font-size: 0.875rem; line-height: 1.8;">
                        <li>
                            <a href="https://cyberab.org/" target="_blank" style="color: #9333ea;">
                                Cyber AB Official Site
                            </a> - CMMC Accreditation Body
                        </li>
                        <li>
                            <a href="https://cyberab.org/Catalog" target="_blank" style="color: #9333ea;">
                                CMMC Marketplace
                            </a> - Find C3PAOs and Consultants
                        </li>
                        <li>
                            <a href="https://dodcio.defense.gov/CMMC/" target="_blank" style="color: #9333ea;">
                                DoD CMMC Program
                            </a> - Official DoD CMMC Information
                        </li>
                    </ul>
                </div>

                <div class="info-box info-green">
                    <h4 style="font-weight: bold; margin-bottom: 0.75rem;">📋 Assessment & Gap Analysis Tools</h4>
                    <ul style="font-size: 0.875rem; line-height: 1.8;">
                        <li>CMMC Self-Assessment Checklist</li>
                        <li>Gap Analysis Spreadsheet</li>
                        <li>Practice Implementation Tracker</li>
                        <li>Evidence Collection Templates</li>
                        <li>Continuous Monitoring Dashboard</li>
                        <li>Compliance Status Reports</li>
                    </ul>
                </div>

                <div class="info-box info-yellow">
                    <h4 style="font-weight: bold; margin-bottom: 0.75rem;">📝 Documentation Best Practices</h4>
                    <ul style="font-size: 0.875rem; line-height: 1.8;">
                        <li>Use version control for all policy documents</li>
                        <li>Implement document review and approval process</li>
                        <li>Maintain evidence of policy distribution to staff</li>
                        <li>Schedule annual policy reviews and updates</li>
                        <li>Document policy exceptions and approvals</li>
                        <li>Keep audit trail of all policy changes</li>
                        <li>Store policies in secure, accessible location</li>
                    </ul>
                </div>
            </div>

            <h2 style="font-size: 1.75rem; font-weight: bold; margin: 2rem 0 1rem; color: #2563eb;">📝 SSP Development Checklist</h2>

            <div class="info-box" style="background: linear-gradient(135deg, #eff6ff 0%, #f0fdf4 100%); border: 2px solid #2563eb;">
                <h4 style="font-weight: bold; margin-bottom: 1rem; color: #1e40af;">System Security Plan (SSP) Core Components</h4>
                <div class="grid-2">
                    <div>
                        <h5 style="font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Section 1: System Identification</h5>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>☐ System name and identifier</li>
                            <li>☐ System owner and security POC</li>
                            <li>☐ System categorization (CUI present)</li>
                            <li>☐ Authorization boundary diagram</li>
                            <li>☐ Network architecture diagrams</li>
                            <li>☐ Data flow diagrams</li>
                        </ul>

                        <h5 style="font-weight: 600; margin: 1rem 0 0.5rem; color: #374151;">Section 2: System Environment</h5>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>☐ Hardware inventory</li>
                            <li>☐ Software inventory</li>
                            <li>☐ Network devices and topology</li>
                            <li>☐ External service providers</li>
                            <li>☐ Cloud services used</li>
                            <li>☐ Remote access methods</li>
                        </ul>

                        <h5 style="font-weight: 600; margin: 1rem 0 0.5rem; color: #374151;">Section 3: Security Controls</h5>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>☐ All 110 CMMC Level 2 practices documented</li>
                            <li>☐ Implementation details for each practice</li>
                            <li>☐ Responsible parties identified</li>
                            <li>☐ Assessment procedures defined</li>
                            <li>☐ Evidence artifacts listed</li>
                        </ul>
                    </div>
                    <div>
                        <h5 style="font-weight: 600; margin-bottom: 0.5rem; color: #374151;">Section 4: System Interconnections</h5>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>☐ All external connections documented</li>
                            <li>☐ Security controls for each connection</li>
                            <li>☐ Authorization agreements in place</li>
                            <li>☐ MOUs/ISAs with external parties</li>
                        </ul>

                        <h5 style="font-weight: 600; margin: 1rem 0 0.5rem; color: #374151;">Section 5: Security Responsibilities</h5>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>☐ Roles and responsibilities matrix</li>
                            <li>☐ Security team structure</li>
                            <li>☐ Escalation procedures</li>
                            <li>☐ Training requirements by role</li>
                        </ul>

                        <h5 style="font-weight: 600; margin: 1rem 0 0.5rem; color: #374151;">Section 6: Supporting Documents</h5>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>☐ Reference all related policies</li>
                            <li>☐ Configuration standards</li>
                            <li>☐ Incident response plan</li>
                            <li>☐ Business continuity plan</li>
                            <li>☐ Risk assessment reports</li>
                            <li>☐ POA&M (if applicable)</li>
                            <li>☐ Previous assessment results</li>
                        </ul>

                        <h5 style="font-weight: 600; margin: 1rem 0 0.5rem; color: #374151;">Section 7: Document Control</h5>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>☐ Version history</li>
                            <li>☐ Approval signatures</li>
                            <li>☐ Review and update schedule</li>
                            <li>☐ Distribution list</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h2 style="font-size: 1.75rem; font-weight: bold; margin: 2rem 0 1rem; color: #2563eb;">⏱️ Policy Development Timeline</h2>

            <div class="code-block">
                <div class="code-header">Recommended Implementation Timeline</div>
                <div class="code-content" style="line-height: 1.8;">
<strong>Weeks 1-2: Planning & Assessment</strong>
- Conduct initial gap analysis
- Identify existing policies and documents
- Assemble policy development team
- Download and review policy templates

<strong>Weeks 3-6: Core Policy Development</strong>
- Develop System Security Plan (SSP) outline
- Create Information Security Policy
- Develop Access Control policies
- Create Incident Response Plan
- Develop Configuration Management Plan

<strong>Weeks 7-10: Domain-Specific Policies</strong>
- Complete all 17 domain policies
- Develop supporting procedures
- Create training materials
- Document baseline configurations

<strong>Weeks 11-12: Review & Refinement</strong>
- Internal policy review
- Management approval process
- Legal/compliance review
- Update based on feedback

<strong>Weeks 13-14: Implementation & Training</strong>
- Distribute policies to all staff
- Conduct security awareness training
- Document policy acknowledgment
- Establish monitoring procedures

<strong>Ongoing: Maintenance</strong>
- Quarterly policy reviews
- Annual comprehensive updates
- Continuous monitoring and improvement
- Update based on organizational changes
                </div>
            </div>

            <div class="info-box info-red" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">⚠️ Common Policy Development Mistakes to Avoid</h4>
                <div class="grid-2">
                    <div>
                        <h5 style="font-weight: 600; margin-bottom: 0.5rem; color: #991b1b;">❌ Don't Do This:</h5>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>Copy policies without customization</li>
                            <li>Use generic templates without organization details</li>
                            <li>Document controls you don't actually implement</li>
                            <li>Ignore organizational structure and processes</li>
                            <li>Skip management review and approval</li>
                            <li>Fail to distribute policies to staff</li>
                            <li>Neglect to maintain and update regularly</li>
                            <li>Over-promise capabilities you don't have</li>
                        </ul>
                    </div>
                    <div>
                        <h5 style="font-weight: 600; margin-bottom: 0.5rem; color: #065f46;">✅ Best Practices:</h5>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>Customize all templates to your organization</li>
                            <li>Document actual implemented controls accurately</li>
                            <li>Align policies with organizational structure</li>
                            <li>Get management buy-in and signatures</li>
                            <li>Train all staff on relevant policies</li>
                            <li>Maintain evidence of policy distribution</li>
                            <li>Schedule regular reviews and updates</li>
                            <li>Be honest about current state and gaps</li>
                            <li>Use POA&M for items not yet implemented</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="info-box info-green" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">✅ Policy Implementation Success Factors</h4>
                <div class="grid-2">
                    <div>
                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">📋 Documentation</h5>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>Clear, concise, and accurate content</li>
                            <li>Consistent formatting and structure</li>
                            <li>Version control and change tracking</li>
                            <li>Regular reviews and updates</li>
                            <li>Accessible to all relevant staff</li>
                        </ul>
                    </div>
                    <div>
                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">👥 People & Process</h5>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>Executive leadership support</li>
                            <li>Clear roles and responsibilities</li>
                            <li>Comprehensive training program</li>
                            <li>Regular communication and awareness</li>
                            <li>Enforcement and accountability</li>
                        </ul>
                    </div>
                    <div>
                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">🔧 Technical Implementation</h5>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>Automated controls where possible</li>
                            <li>Configuration management tools</li>
                            <li>Continuous monitoring systems</li>
                            <li>Audit logging and analysis</li>
                            <li>Regular vulnerability assessments</li>
                        </ul>
                    </div>
                    <div>
                        <h5 style="font-weight: 600; margin-bottom: 0.5rem;">📊 Metrics & Monitoring</h5>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>Policy compliance metrics</li>
                            <li>Security incident tracking</li>
                            <li>Training completion rates</li>
                            <li>Audit findings and remediation</li>
                            <li>Continuous improvement process</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="info-box" style="background: linear-gradient(135deg, #faf5ff 0%, #eff6ff 100%); border: 2px solid #9333ea; margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.75rem; color: #6b21a8;">💡 Pro Tips for CMMC Assessment Preparation</h4>
                <ol style="font-size: 0.875rem; line-height: 2; margin-left: 1.5rem;">
                    <li><strong>Start Early:</strong> Begin policy development 6-12 months before planned assessment</li>
                    <li><strong>Document Everything:</strong> Maintain evidence of all security controls and activities</li>
                    <li><strong>Be Consistent:</strong> Ensure policies, procedures, and actual implementation align</li>
                    <li><strong>Practice Makes Perfect:</strong> Conduct internal assessments before C3PAO audit</li>
                    <li><strong>Involve Everyone:</strong> Security is everyone's responsibility - train all staff</li>
                    <li><strong>Use Templates Wisely:</strong> Customize templates to reflect your actual environment</li>
                    <li><strong>Maintain Evidence:</strong> Keep screenshots, logs, and artifacts for all controls</li>
                    <li><strong>Update Regularly:</strong> Review and update policies quarterly or when changes occur</li>
                    <li><strong>Address Gaps Proactively:</strong> Use POA&M to document remediation plans for gaps</li>
                    <li><strong>Engage Experts:</strong> Consider hiring CMMC consultants for complex areas</li>
                </ol>
            </div>

        </div>

        <div id="policies" class="tab-content">
            <div class="info-box info-purple">
                <h3 style="font-weight: bold; margin-bottom: 0.5rem;">📋 CMMC Policy Templates & Compliance Resources</h3>
                <p style="font-size: 0.875rem; margin-bottom: 1rem;">
                    Comprehensive collection of free and commercial policy templates, System Security Plans, training resources, and tools to support your CMMC Level 2 compliance journey. 
                    These resources cover NIST SP 800-171 and CMMC requirements with ready-to-use templates and documentation.
                </p>
                <div class="grid-2">
                    <div>
                        <h4 style="font-weight: 600; color: #7c3aed; margin-bottom: 0.5rem;">🎯 What You'll Find</h4>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>Policy and procedure templates (free & commercial)</li>
                            <li>System Security Plan (SSP) templates</li>
                            <li>Plan of Action & Milestones (POA&M) templates</li>
                            <li>Incident Response procedures and exercises</li>
                            <li>Awareness training and CUI training</li>
                            <li>Configuration management resources</li>
                        </ul>
                    </div>
                    <div>
                        <h4 style="font-weight: 600; color: #059669; margin-bottom: 0.5rem;">✅ Benefits</h4>
                        <ul style="font-size: 0.875rem; line-height: 1.8;">
                            <li>Save hundreds of hours of documentation work</li>
                            <li>Ensure comprehensive CMMC coverage</li>
                            <li>Start with proven templates and best practices</li>
                            <li>Meet DFARS 252.204-7012 requirements</li>
                            <li>Prepare for C3PAO assessment</li>
                            <li>Maintain ongoing compliance</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h2 style="font-size: 1.75rem; font-weight: bold; margin: 2.5rem 0 1.5rem; color: #2563eb; border-bottom: 3px solid #2563eb; padding-bottom: 0.5rem;">📄 Policy & Procedure Templates</h2>

            <div class="grid-2">
                <div class="feature-box" style="background: #fef3c7; border: 2px solid #f59e0b;">
                    <h4 style="color: #92400e; margin-bottom: 0.75rem;">⭐ DoD ESTCP IT Policies Template (FREE)</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem; color: #374151; font-weight: 600;">
                        Best free template set available - Comprehensive IT policies document
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ <strong>20+ policy documents</strong> in one comprehensive template</li>
                        <li>✅ <strong>Microsoft Word format</strong> - easy to edit and customize</li>
                        <li>✅ <strong>No registration required</strong> - download immediately</li>
                        <li>✅ <strong>Updated 2018-2019</strong> - aligned with NIST SP 800-171</li>
                        <li>✅ Includes: Access Control, Incident Response, Asset Management, Change Management, and more</li>
                    </ul>
                    <p style="font-size: 0.8125rem; color: #6b7280; margin-bottom: 0.75rem; font-style: italic;">
                        Note: Requires cross-referencing to map chapters to specific CMMC controls
                    </p>
                    <a href="https://www.serdp-estcp.org/Tools-and-Training/Installation-Energy-and-Water/Cybersecurity/Templates-and-Checklists" target="_blank" style="display: inline-block; background: #f59e0b; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Download ESTCP Templates →
                    </a>
                </div>

                <div class="feature-box" style="background: #eff6ff; border: 2px solid #2563eb;">
                    <h4 style="color: #1e40af; margin-bottom: 0.75rem;">💼 Kieri Compliance Documentation (PAID)</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem; color: #374151; font-weight: 600;">
                        Professional-grade CMMC-specific documentation package
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ <strong>Worth 200+ hours</strong> of professional work</li>
                        <li>✅ <strong>CMMC-specific</strong> policies and procedures</li>
                        <li>✅ <strong>System Security Plan</strong> template included</li>
                        <li>✅ <strong>Best practices</strong> and implementation instructions</li>
                        <li>✅ Step-by-step guidance for each CMMC requirement</li>
                        <li>✅ Professional quality suitable for C3PAO assessment</li>
                    </ul>
                    <p style="font-size: 0.8125rem; color: #6b7280; margin-bottom: 0.75rem; font-style: italic;">
                        Recommended for organizations seeking turnkey compliance documentation
                    </p>
                    <a href="https://www.kieri.com/" target="_blank" style="display: inline-block; background: #2563eb; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Learn More at Kieri →
                    </a>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 2px solid #059669;">
                    <h4 style="color: #065f46; margin-bottom: 0.75rem;">🏛️ SANS Institute Security Policies (FREE)</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem; color: #374151; font-weight: 600;">
                        Industry best practices security policies from leading security education organization
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ <strong>PDF and DOC formats</strong> available</li>
                        <li>✅ <strong>No registration required</strong></li>
                        <li>✅ <strong>Industry best practices</strong> from security experts</li>
                        <li>✅ Templates for: Acceptable Use, Password Policy, Remote Access, Email, etc.</li>
                        <li>⚠️ Not specifically designed for 800-171/CMMC</li>
                    </ul>
                    <p style="font-size: 0.8125rem; color: #6b7280; margin-bottom: 0.75rem; font-style: italic;">
                        Requires significant rework to align with CMMC requirements
                    </p>
                    <a href="https://www.sans.org/information-security-policy/" target="_blank" style="display: inline-block; background: #059669; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Download SANS Policies →
                    </a>
                </div>

                <div class="feature-box" style="background: #fef2f2; border: 2px solid #dc2626;">
                    <h4 style="color: #991b1b; margin-bottom: 0.75rem;">☁️ StateRAMP Policy Templates (FREE)</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem; color: #374151; font-weight: 600;">
                        Templates based on NIST SP 800-53 controls (FedRAMP)
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ Comprehensive security control templates</li>
                        <li>✅ Based on federal government standards</li>
                        <li>⚠️ <strong>Overkill for CMMC Level 2</strong> (designed for FedRAMP)</li>
                        <li>⚠️ Requires extensive writing to fill in specifics</li>
                        <li>✅ Best for: Cloud service providers subject to FedRAMP</li>
                    </ul>
                    <p style="font-size: 0.8125rem; color: #6b7280; margin-bottom: 0.75rem; font-style: italic;">
                        Use if you offer cloud storage for CUI and need FedRAMP compliance
                    </p>
                    <a href="https://stateramp.org/templates-resources/" target="_blank" style="display: inline-block; background: #dc2626; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        View StateRAMP Templates →
                    </a>
                </div>
            </div>

            <h2 style="font-size: 1.75rem; font-weight: bold; margin: 2.5rem 0 1.5rem; color: #059669; border-bottom: 3px solid #059669; padding-bottom: 0.5rem;">📊 System Security Plan & Assessment Templates</h2>

            <div class="grid-2">
                <div class="feature-box" style="background: linear-gradient(135deg, #eff6ff 0%, #f0fdf4 100%); border: 2px solid #2563eb;">
                    <h4 style="color: #1e40af; margin-bottom: 0.75rem;">📋 NIST SP 800-171 System Security Plan Template</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem; color: #374151; font-weight: 600;">
                        Official SSP template from NIST for DFARS 252.204-7012 compliance
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ <strong>Official NIST template</strong> - recognized by DoD</li>
                        <li>✅ <strong>Microsoft Word format</strong> (.docx)</li>
                        <li>✅ <strong>Required for DoD contractors</strong> with CUI</li>
                        <li>✅ Covers all 110 security requirements</li>
                        <li>✅ Sections for: System Description, Boundary, Security Controls, POA&M</li>
                        <li>✅ Suitable for CMMC Level 2 assessment preparation</li>
                    </ul>
                    <div style="background: #1f2937; color: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 0.75rem; font-family: monospace; font-size: 0.7rem; overflow-x: auto;">
# Direct download link:
https://csrc.nist.gov/CSRC/media/Publications/
sp/800-171/rev-2/final/documents/
CUI-SSP-Template-final.docx
                    </div>
                    <a href="https://csrc.nist.gov/CSRC/media/Publications/sp/800-171/rev-2/final/documents/CUI-SSP-Template-final.docx" target="_blank" style="display: inline-block; background: #2563eb; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Download SSP Template →
                    </a>
                </div>

                <div class="feature-box" style="background: linear-gradient(135deg, #fef3c7 0%, #fef2f2 100%); border: 2px solid #f59e0b;">
                    <h4 style="color: #92400e; margin-bottom: 0.75rem;">📝 NIST POA&M Template</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem; color: #374151; font-weight: 600;">
                        Plan of Action & Milestones template for documenting remediation efforts
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ <strong>Official NIST POA&M template</strong></li>
                        <li>✅ <strong>Track security gaps</strong> and remediation progress</li>
                        <li>✅ <strong>Required for DFARS compliance</strong></li>
                        <li>✅ Document: Weakness, Risk Level, Remediation Plan, Timeline</li>
                        <li>✅ Essential for C3PAO assessment</li>
                        <li>✅ Shows commitment to continuous improvement</li>
                    </ul>
                    <div style="background: #1f2937; color: #f9fafb; padding: 0.75rem; border-radius: 0.25rem; margin-bottom: 0.75rem; font-family: monospace; font-size: 0.7rem; overflow-x: auto;">
# Direct download link:
https://csrc.nist.gov/CSRC/media/Publications/
sp/800-171/rev-2/final/documents/
CUI-Plan-of-Action-Template-final.docx
                    </div>
                    <a href="https://csrc.nist.gov/CSRC/media/Publications/sp/800-171/rev-2/final/documents/CUI-Plan-of-Action-Template-final.docx" target="_blank" style="display: inline-block; background: #f59e0b; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Download POA&M Template →
                    </a>
                </div>

                <div class="feature-box" style="background: #faf5ff; border: 2px solid #9333ea;">
                    <h4 style="color: #6b21a8; margin-bottom: 0.75rem;">🎓 Educational Institutions SSP</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem; color: #374151; font-weight: 600;">
                        Reference SSP with sample responses for 40+ requirements
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ <strong>Free for .edu email addresses</strong></li>
                        <li>✅ Sample responses to ~40 CMMC Level 2 requirements</li>
                        <li>✅ Real-world examples from educational institutions</li>
                        <li>✅ Learn proper SSP writing style and detail level</li>
                        <li>⚠️ Requires .edu email to request access</li>
                    </ul>
                    <a href="https://www.regulatedresearch.org/resources/peer-practices/ssp" target="_blank" style="display: inline-block; background: #9333ea; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Request Educational SSP →
                    </a>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 2px solid #059669;">
                    <h4 style="color: #065f46; margin-bottom: 0.75rem;">🔗 Shared Responsibility Matrix Template</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem; color: #374151; font-weight: 600;">
                        Document shared security responsibilities with MSPs and cloud providers
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ <strong>Define MSP/MSSP responsibilities</strong></li>
                        <li>✅ Clarify cloud provider security controls</li>
                        <li>✅ Essential for outsourced IT services</li>
                        <li>✅ From C3PAO Forum - industry standard</li>
                        <li>⚠️ Note: Double-check requirement numbering</li>
                    </ul>
                    <a href="https://www.c3paoforum.org/wp-content/uploads/2022/05/Shared-Responsibility-Matrix-Template-C3PAOForum.docx" target="_blank" style="display: inline-block; background: #059669; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Download SRM Template →
                    </a>
                </div>
            </div>

            <h2 style="font-size: 1.75rem; font-weight: bold; margin: 2.5rem 0 1.5rem; color: #7c3aed; border-bottom: 3px solid #7c3aed; padding-bottom: 0.5rem;">🎓 Awareness Training & CUI Resources</h2>

            <div class="grid-2">
                <div class="feature-box" style="background: #eff6ff; border: 2px solid #2563eb;">
                    <h4 style="color: #1e40af; margin-bottom: 0.75rem;">🛡️ DoD Cybersecurity Awareness Training</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Official DoD training meets 2 CMMC requirements:</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ <strong>AT.L2-3.2.1:</strong> Security awareness training</li>
                        <li>✅ <strong>AT.L2-3.2.2:</strong> Insider threat awareness</li>
                        <li>✅ Includes certificate of completion for audit evidence</li>
                        <li>✅ Free for all users</li>
                        <li>✅ ~1 hour to complete</li>
                    </ul>
                    <a href="https://public.cyber.mil/training/cyber-awareness-challenge/" target="_blank" style="display: inline-block; background: #2563eb; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Take DoD Awareness Training →
                    </a>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 2px solid #f59e0b;">
                    <h4 style="color: #92400e; margin-bottom: 0.75rem;">📚 Free CUI Training from DoD</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Learn to identify, mark, and protect Controlled Unclassified Information</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ Introduction to CUI program</li>
                        <li>✅ How to identify CUI in documents</li>
                        <li>✅ Proper CUI marking requirements</li>
                        <li>✅ Storage and transmission requirements</li>
                        <li>✅ Certificate of completion</li>
                    </ul>
                    <a href="https://securityawareness.usalearning.gov/cui/index.html" target="_blank" style="display: inline-block; background: #f59e0b; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Take CUI Training →
                    </a>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 2px solid #059669;">
                    <h4 style="color: #065f46; margin-bottom: 0.75rem;">🚨 DCISE - Cyber Threat Intelligence Sharing</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Defense Industrial Base Collaborative Information Sharing Environment</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ Public-private cybersecurity partnership</li>
                        <li>✅ Crowd-sourced threat intelligence</li>
                        <li>✅ Unclassified and classified threat sharing</li>
                        <li>✅ Cyber threat analysis and diagnostics</li>
                        <li>✅ Mitigation strategies and best practices</li>
                        <li>✅ Analyst-to-analyst exchanges</li>
                    </ul>
                    <a href="https://www.dc3.mil/Missions/DIB-Cybersecurity/DIB-Cybersecurity-DCISE/" target="_blank" style="display: inline-block; background: #059669; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Learn About DCISE →
                    </a>
                </div>

                <div class="feature-box" style="background: #fef2f2; border: 2px solid #dc2626;">
                    <h4 style="color: #991b1b; margin-bottom: 0.75rem;">📡 CISA Threat Intelligence Bulletins</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Subscribe to receive cyber threat intelligence (CMMC requirement)</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ <strong>SI.L2-3.14.3:</strong> Monitor cyber threat intelligence sources</li>
                        <li>✅ Free subscription to CISA bulletins</li>
                        <li>✅ Timely threat alerts and mitigations</li>
                        <li>✅ Vulnerability announcements</li>
                        <li>✅ Industry-specific threat information</li>
                    </ul>
                    <a href="https://www.cisa.gov/cybersecurity" target="_blank" style="display: inline-block; background: #dc2626; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600; margin-right: 0.5rem;">
                        CISA Cybersecurity →
                    </a>
                    <a href="https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?qsp=CODE_RED" target="_blank" style="display: inline-block; background: #374151; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Subscribe to Bulletins →
                    </a>
                </div>
            </div>

            <h2 style="font-size: 1.75rem; font-weight: bold; margin: 2.5rem 0 1.5rem; color: #dc2626; border-bottom: 3px solid #dc2626; padding-bottom: 0.5rem;">🚨 Incident Response Resources</h2>

            <div class="grid-2">
                <div class="feature-box" style="background: #fef2f2; border: 2px solid #dc2626;">
                    <h4 style="color: #991b1b; margin-bottom: 0.75rem;">📞 DoD Cyber Incident Reporting Procedures</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>DFARS 252.204-7012 requires DoD contractors to report cyber incidents</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ Official incident reporting requirements</li>
                        <li>✅ Step-by-step reporting process</li>
                        <li>✅ Timeline requirements (72 hours)</li>
                        <li>✅ What information to include</li>
                        <li>✅ Investigation procedures</li>
                        <li>✅ Required for CMMC Level 2 and 3</li>
                    </ul>
                    <a href="https://www.acq.osd.mil/dpap/dars/pgi/pgi_htm/current/PGI204_73.htm" target="_blank" style="display: inline-block; background: #dc2626; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        View Reporting Procedures →
                    </a>
                </div>

                <div class="feature-box" style="background: #eff6ff; border: 2px solid #2563eb;">
                    <h4 style="color: #1e40af; margin-bottom: 0.75rem;">🎯 CISA Tabletop Exercise Packages</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Free incident response scenarios for team training</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ <strong>IR.L2-3.6.1:</strong> Establish incident handling capability</li>
                        <li>✅ Multiple scenario packages</li>
                        <li>✅ Ransomware, phishing, data breach scenarios</li>
                        <li>✅ Facilitator guides included</li>
                        <li>✅ Build team coordination and response skills</li>
                        <li>✅ Document exercises for CMMC evidence</li>
                    </ul>
                    <a href="https://www.cisa.gov/cisa-tabletop-exercise-packages" target="_blank" style="display: inline-block; background: #2563eb; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Download Exercise Packages →
                    </a>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 2px solid #059669;">
                    <h4 style="color: #065f46; margin-bottom: 0.75rem;">📋 ESTCP Incident Response Forms</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Templates and checklists for incident management</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ Incident Response Plan template</li>
                        <li>✅ Incident reporting forms</li>
                        <li>✅ Post-incident review checklist</li>
                        <li>✅ Lessons learned template</li>
                        <li>✅ Microsoft Word format</li>
                    </ul>
                    <a href="https://www.serdp-estcp.org/Tools-and-Training/Installation-Energy-and-Water/Cybersecurity/Templates-and-Checklists" target="_blank" style="display: inline-block; background: #059669; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Download IR Templates →
                    </a>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 2px solid #f59e0b;">
                    <h4 style="color: #92400e; margin-bottom: 0.75rem;">🔐 DIBNET / DC3 Incident Reporting Portal</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Official portal for reporting incidents to the DoD</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ Defense Industrial Base Network portal</li>
                        <li>✅ Report cyber incidents affecting CUI</li>
                        <li>✅ DoD Cyber Crime Center (DC3)</li>
                        <li>✅ Required for defense contractors</li>
                        <li>✅ Secure incident submission</li>
                    </ul>
                    <p style="font-size: 0.8125rem; color: #6b7280; font-style: italic;">
                        Check your contract for specific reporting requirements
                    </p>
                </div>
            </div>

            <h2 style="font-size: 1.75rem; font-weight: bold; margin: 2.5rem 0 1.5rem; color: #f59e0b; border-bottom: 3px solid #f59e0b; padding-bottom: 0.5rem;">⚙️ Configuration Management & Hardening Resources</h2>

            <div class="grid-2">
                <div class="feature-box" style="background: #eff6ff; border: 2px solid #2563eb;">
                    <h4 style="color: #1e40af; margin-bottom: 0.75rem;">🔐 NIST CMVP - Cryptographic Module Validation</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Verify FIPS 140-2 validated cryptographic modules</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ <strong>SC.L2-3.13.11:</strong> Use FIPS-validated cryptography</li>
                        <li>✅ Search for validated encryption products</li>
                        <li>✅ Download validation certificates</li>
                        <li>✅ Required for CUI protection</li>
                        <li>✅ Windows BitLocker, TLS, VPNs must be FIPS validated</li>
                    </ul>
                    <a href="https://csrc.nist.gov/Projects/cryptographic-module-validation-program/validated-modules/Search" target="_blank" style="display: inline-block; background: #2563eb; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Search CMVP Database →
                    </a>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 2px solid #059669;">
                    <h4 style="color: #065f46; margin-bottom: 0.75rem;">📚 NIST National Checklist Program</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Security configuration checklists for hundreds of systems</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ <strong>CM.L2-3.4.2:</strong> Establish security configurations</li>
                        <li>✅ Operating system hardening guides</li>
                        <li>✅ Application security configurations</li>
                        <li>✅ Database hardening checklists</li>
                        <li>✅ Network device configurations</li>
                    </ul>
                    <a href="https://ncp.nist.gov/repository" target="_blank" style="display: inline-block; background: #059669; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Browse NCP Checklists →
                    </a>
                </div>

                <div class="feature-box" style="background: #fef2f2; border: 2px solid #dc2626;">
                    <h4 style="color: #991b1b; margin-bottom: 0.75rem;">🛡️ DISA STIGs - Security Technical Implementation Guides</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>DoD-approved security configurations for IT products</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ Military-grade hardening standards</li>
                        <li>✅ Windows, Linux, applications, databases</li>
                        <li>✅ Step-by-step configuration instructions</li>
                        <li>✅ Automated STIG checking tools available</li>
                        <li>⚠️ Very detailed - may require security consultant</li>
                    </ul>
                    <a href="https://public.cyber.mil/stigs/" target="_blank" style="display: inline-block; background: #dc2626; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Download STIGs →
                    </a>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 2px solid #f59e0b;">
                    <h4 style="color: #92400e; margin-bottom: 0.75rem;">☁️ CISA SCuBA - Secure Cloud Business Applications</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Security baselines for Microsoft 365 and Google Workspace</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ Microsoft 365 GCC-High configuration baselines</li>
                        <li>✅ Google Workspace security settings</li>
                        <li>✅ Step-by-step implementation guides</li>
                        <li>✅ Automated assessment tools</li>
                        <li>✅ Perfect for cloud-based CUI environments</li>
                    </ul>
                    <a href="https://www.cisa.gov/resources-tools/services/secure-cloud-business-applications-scuba-project" target="_blank" style="display: inline-block; background: #f59e0b; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Learn About SCuBA →
                    </a>
                </div>

                <div class="feature-box" style="background: #faf5ff; border: 2px solid #9333ea;">
                    <h4 style="color: #6b21a8; margin-bottom: 0.75rem;">🔍 NIST NVD - National Vulnerability Database</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Identify and remediate software vulnerabilities</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ <strong>SI.L2-3.14.1:</strong> Identify system flaws</li>
                        <li>✅ Comprehensive CVE database</li>
                        <li>✅ Severity ratings (CVSS scores)</li>
                        <li>✅ Patch information and mitigation guidance</li>
                        <li>✅ Free API access for automation</li>
                    </ul>
                    <a href="https://nvd.nist.gov/vuln/search" target="_blank" style="display: inline-block; background: #9333ea; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Search NVD →
                    </a>
                </div>

                <div class="feature-box" style="background: linear-gradient(135deg, #eff6ff 0%, #f0fdf4 100%); border: 2px solid #2563eb;">
                    <h4 style="color: #1e40af; margin-bottom: 0.75rem;">⚡ SCAP Compliance Checker</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Automated security configuration validation</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ Security Content Automation Protocol</li>
                        <li>✅ Automated configuration scanning</li>
                        <li>✅ Validate STIG compliance</li>
                        <li>✅ Windows-focused tools available</li>
                        <li>✅ Reduces manual audit effort</li>
                    </ul>
                    <a href="https://csrc.nist.gov/Projects/scap-validation-program/validated-products-and-modules" target="_blank" style="display: inline-block; background: #2563eb; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        View SCAP Products →
                    </a>
                </div>
            </div>

            <h2 style="font-size: 1.75rem; font-weight: bold; margin: 2.5rem 0 1.5rem; color: #2563eb; border-bottom: 3px solid #2563eb; padding-bottom: 0.5rem;">📊 Assessment & Self-Assessment Tools</h2>

            <div class="grid-2">
                <div class="feature-box" style="background: linear-gradient(135deg, #eff6ff 0%, #fef3c7 100%); border: 2px solid #2563eb;">
                    <h4 style="color: #1e40af; margin-bottom: 0.75rem;">📁 DIBCAC Public 800-171 Self-Assessment Database</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Microsoft Access database for tracking self-assessment progress</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ Official DCMA tool</li>
                        <li>✅ Captures assessment data</li>
                        <li>✅ Calculates scores based on findings</li>
                        <li>✅ Tracks evidence for each practice</li>
                        <li>✅ Prepares for C3PAO assessment</li>
                    </ul>
                    <a href="https://www.dcma.mil/Portals/31/Documents/DIBCAC/Public_800-171_Self_Asmt_DB_v1.zip?ver=4iKiB8JZjXZwEPlY86HAgQ%3d%3d" target="_blank" style="display: inline-block; background: #2563eb; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Download Assessment DB →
                    </a>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 2px solid #059669;">
                    <h4 style="color: #065f46; margin-bottom: 0.75rem;">📋 Candidate C3PAO Pre-Assessment Package</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Understand what C3PAOs will ask during CMMC assessment</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ Expectations for inheritance documentation</li>
                        <li>✅ Not applicable practice justifications</li>
                        <li>✅ Evidence requirements</li>
                        <li>✅ Planning phase questions</li>
                        <li>✅ Prepare effectively for assessment</li>
                    </ul>
                    <a href="https://www.dcma.mil/Portals/31/Documents/DIBCAC/Candidate_C3PAO_Pre-Asmt_Package.zip" target="_blank" style="display: inline-block; background: #059669; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Download Pre-Assessment Package →
                    </a>
                </div>

                <div class="feature-box" style="background: #fef2f2; border: 2px solid #dc2626;">
                    <h4 style="color: #991b1b; margin-bottom: 0.75rem;">📖 DoD Assessment Methodology</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>How DIBCAC performs NIST SP 800-171 assessments</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ Official DoD assessment process</li>
                        <li>✅ Scoring methodology explained</li>
                        <li>✅ Evidence expectations</li>
                        <li>✅ Interview procedures</li>
                        <li>✅ Similar to CMMC assessment approach</li>
                    </ul>
                    <a href="https://www.acq.osd.mil/asda/dpc/cp/cyber/safeguarding.html#nistSP800171" target="_blank" style="display: inline-block; background: #dc2626; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        View Assessment Methodology →
                    </a>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 2px solid #f59e0b;">
                    <h4 style="color: #92400e; margin-bottom: 0.75rem;">🔧 DoD Cybersecurity Toolbox</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Official DoD FAQs and clarifications for tough cybersecurity questions</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ Referenced by DIBCAC and C3PAO assessors</li>
                        <li>✅ Clarifications on ambiguous requirements</li>
                        <li>✅ Implementation guidance</li>
                        <li>✅ Answers to contractor questions</li>
                        <li>✅ Updated regularly</li>
                    </ul>
                    <a href="https://dodprocurementtoolbox.com/faqs/cybersecurity" target="_blank" style="display: inline-block; background: #f59e0b; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        View DoD Toolbox →
                    </a>
                </div>
            </div>

            <h2 style="font-size: 1.75rem; font-weight: bold; margin: 2.5rem 0 1.5rem; color: #9333ea; border-bottom: 3px solid #9333ea; padding-bottom: 0.5rem;">🤝 Community Resources & Shopping Guides</h2>

            <div class="grid-2">
                <div class="feature-box" style="background: #faf5ff; border: 2px solid #9333ea;">
                    <h4 style="color: #6b21a8; margin-bottom: 0.75rem;">💬 CMMC Forum - Cooey Center of Excellence</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Discord community with thousands of CMMC experts</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ Peer-to-peer support and guidance</li>
                        <li>✅ Weekly Thursday night happy hour</li>
                        <li>✅ RPOs, C3PAOs, consultants, contractors</li>
                        <li>✅ Real-time answers to CMMC questions</li>
                        <li>✅ Share experiences and lessons learned</li>
                    </ul>
                </div>

                <div class="feature-box" style="background: #eff6ff; border: 2px solid #2563eb;">
                    <h4 style="color: #1e40af; margin-bottom: 0.75rem;">🛒 MSP Shopping Questionnaire</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Evaluate Managed Service Providers for CMMC support</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ From ND-ISAC (National Defense ISAC)</li>
                        <li>✅ Half training, half scoring template</li>
                        <li>✅ Questions to ask potential MSPs</li>
                        <li>✅ Evaluate CMMC knowledge and capabilities</li>
                        <li>✅ Essential for small/medium contractors</li>
                    </ul>
                    <a href="https://ndisac.org/wp-content/uploads/2022/12/NDISAC-SMB-WG-MSP-Shopping-Questionnaire-Rev-4.5.pdf" target="_blank" style="display: inline-block; background: #2563eb; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Download MSP Questionnaire →
                    </a>
                </div>

                <div class="feature-box" style="background: #f0fdf4; border: 2px solid #059669;">
                    <h4 style="color: #065f46; margin-bottom: 0.75rem;">📝 C3PAO Shopping Guide</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Evaluate and select a CMMC Third Party Assessor Organization</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ Questions to ask potential C3PAOs</li>
                        <li>✅ Scoring sheet for evaluation</li>
                        <li>✅ Red flags to watch for</li>
                        <li>✅ Assessment cost expectations</li>
                        <li>✅ Timeline and scheduling considerations</li>
                    </ul>
                    <a href="https://ndisac.org/defense-news/nd-isac-releases-c3pao-shopping-guide-for-small-medium-sized-businesses/" target="_blank" style="display: inline-block; background: #059669; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        View C3PAO Guide →
                    </a>
                </div>

                <div class="feature-box" style="background: #fef3c7; border: 2px solid #f59e0b;">
                    <h4 style="color: #92400e; margin-bottom: 0.75rem;">☁️ FedRAMP Approved Vendors List</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Cloud service providers approved for CUI storage/processing</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ Required: FedRAMP Moderate or higher for CUI</li>
                        <li>✅ Search by authorization level</li>
                        <li>✅ Microsoft 365 GCC-High (FedRAMP High)</li>
                        <li>✅ AWS GovCloud, Azure Government</li>
                        <li>✅ View authorization status and dates</li>
                    </ul>
                    <a href="https://marketplace.fedramp.gov/products" target="_blank" style="display: inline-block; background: #f59e0b; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Search FedRAMP Marketplace →
                    </a>
                </div>
            </div>

            <h2 style="font-size: 1.75rem; font-weight: bold; margin: 2.5rem 0 1.5rem; color: #059669; border-bottom: 3px solid #059669; padding-bottom: 0.5rem;">📺 Educational Video Resources</h2>

            <div class="grid-2">
                <div class="feature-box" style="background: linear-gradient(135deg, #eff6ff 0%, #fef3c7 100%); border: 2px solid #2563eb;">
                    <h4 style="color: #1e40af; margin-bottom: 0.75rem;">🎥 Kieri Solutions CMMC Videos</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Dozens of videos from CMMC assessors and SMEs</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ How to write a System Security Plan</li>
                        <li>✅ CMMC practice-by-practice explanations</li>
                        <li>✅ GCC-High implementation guidance</li>
                        <li>✅ Assessment preparation tips</li>
                        <li>✅ Common pitfalls and how to avoid them</li>
                    </ul>
                    <a href="https://www.youtube.com/@kierilf" target="_blank" style="display: inline-block; background: #dc2626; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Watch on YouTube →
                    </a>
                </div>

                <div class="feature-box" style="background: linear-gradient(135deg, #f0fdf4 0%, #fef2f2 100%); border: 2px solid #059669;">
                    <h4 style="color: #065f46; margin-bottom: 0.75rem;">📹 Summit 7 CMMC & Rulemaking Videos</h4>
                    <p style="font-size: 0.875rem; margin-bottom: 0.75rem;">
                        <strong>Updates on CMMC rulemaking, DFARS, and compliance</strong>
                    </p>
                    <ul style="font-size: 0.8125rem; line-height: 1.8; margin-bottom: 0.75rem;">
                        <li>✅ CMMC 2.0 rulemaking updates</li>
                        <li>✅ DFARS 252.204-7012 compliance</li>
                        <li>✅ Cybersecurity best practices</li>
                        <li>✅ Policy interpretation and guidance</li>
                        <li>✅ Industry news and analysis</li>
                    </ul>
                    <a href="https://www.youtube.com/@Summit7" target="_blank" style="display: inline-block; background: #dc2626; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600;">
                        Watch on YouTube →
                    </a>
                </div>
            </div>

            <div class="info-box info-blue" style="margin-top: 2rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">💡 Tips for Using Policy Templates</h4>
                <ol style="font-size: 0.875rem; line-height: 1.8; margin-left: 1.5rem;">
                    <li><strong>Start with Free Resources:</strong> Begin with DoD ESTCP and NIST templates before investing in commercial products</li>
                    <li><strong>Customize Thoroughly:</strong> Templates are starting points - you must adapt them to your actual environment</li>
                    <li><strong>Document Everything:</strong> Keep evidence of policy implementation (screenshots, logs, training records)</li>
                    <li><strong>Map to CMMC:</strong> Create a matrix showing which policies address which CMMC practices</li>
                    <li><strong>Review Regularly:</strong> Update policies quarterly and after significant changes</li>
                    <li><strong>Train Your Team:</strong> Ensure all staff understand and follow documented policies</li>
                    <li><strong>Prepare for Assessment:</strong> Organize policies, SSP, POA&M, and evidence before C3PAO engagement</li>
                    <li><strong>Consider Professional Help:</strong> For complex areas, hiring a CMMC consultant can save time and ensure compliance</li>
                </ol>
            </div>

            <div class="info-box info-purple" style="margin-top: 1.5rem;">
                <h4 style="font-weight: bold; margin-bottom: 0.5rem;">📚 Additional Resources</h4>
                <p style="font-size: 0.875rem; margin-bottom: 0.5rem;">
                    For the most up-to-date list of policy templates and tools, visit:
                </p>
                <a href="https://www.cmmcaudit.org/policy-templates-and-tools-for-cmmc-and-800-171/" target="_blank" style="display: inline-block; background: #7c3aed; color: white; padding: 0.75rem 1.5rem; border-radius: 0.25rem; text-decoration: none; font-size: 0.875rem; font-weight: 600; margin-top: 0.5rem;">
                    Visit CMMC Audit Policy Templates Page →
                </a>
            </div>

        </div>

        </div>
        
        </div>

    </div>

    <script>
        function showTab(tabName) {
            // Hide all tab contents
            var contents = document.getElementsByClassName('tab-content');
            for (var i = 0; i < contents.length; i++) {
                contents[i].classList.remove('active');
            }
            
            // Remove active class from all tabs
            var tabs = document.getElementsByClassName('tab');
            for (var i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }
        
        function toggleCollapsible(element) {
            // Toggle the clicked header
            element.classList.toggle('active');
            
            // Get the next sibling (the content div)
            var content = element.nextElementSibling;
            
            // Toggle the content
            content.classList.toggle('active');
        }
        
        function expandAllSections() {
            var headers = document.getElementsByClassName('collapsible-header');
            var contents = document.getElementsByClassName('collapsible-content');
            
            for (var i = 0; i < headers.length; i++) {
                headers[i].classList.add('active');
            }
            
            for (var i = 0; i < contents.length; i++) {
                contents[i].classList.add('active');
            }
        }
        
        function collapseAllSections() {
            var headers = document.getElementsByClassName('collapsible-header');
            var contents = document.getElementsByClassName('collapsible-content');
            
            for (var i = 0; i < headers.length; i++) {
                headers[i].classList.remove('active');
            }
            
            for (var i = 0; i < contents.length; i++) {
                contents[i].classList.remove('active');
            }
        }
    </script>
</body>
</html>
